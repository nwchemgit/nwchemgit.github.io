<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://nwchemgit.github.io/Bq.html">
  <link rel="shortcut icon" href="img/favicon.ico">
  <title>Bq - NWChem</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="css/theme.css" />
  <link rel="stylesheet" href="css/theme_extra.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Bq";
    var mkdocs_page_input_path = "Bq.md";
    var mkdocs_page_url = "/Bq.html";
  </script>
  
  <script src="js/jquery-2.1.1.min.js" defer></script>
  <script src="js/modernizr-2.8.3.min.js" defer></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="." class="icon icon-home"> NWChem</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Home.html">Documentation</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Download.html">Download</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Quantum-Mechanical-Methods.html">Quantum Mechanical Methods</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Quantum-Molecular-Dynamics.html">Quantum Molecular Dynamics</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Other-Capabilities.html">Other Capabilities</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Examples.html">Examples</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Supplementary-Information.html">Supplementary Information</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Compiling-NWChem.html">Compiling NWChem from source</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Benchmarks.html">Benchmarks performed with NWChem</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Known-Bugs.html">Known Bugs</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Tutorials.html">Tutorials</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Forum.html">Forum</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Archived-Forum.html">Archived Forum</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href=".">NWChem</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".">Docs</a> &raquo;</li>
    
      
    
    <li>Bq</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/nwchemgit/nwchem-wiki/blob/master/Bq.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>Bq module provides a way to perform QM calculations in the presence of point charges or Bq&rsquo;s,  (as typically referred to in quantum chemistry community). 
Using Bq module versus  geometry block is a recommended way to include point charges in your calculations, in particular if number of charges are big.</p>
<p>The format for including external point charges using the Bq module is shown below, supporting both explicit charge definition in the body of the block and/or loading from external files.</p>
<pre><code> bq [units au|nm|pm|ang...] [namespace]  
   [clear] 
   [force|noforce]  
   [load &lt;file&gt; [charges &lt;chargefile&gt;] [format ix iy iz iq] [units au|nm|pm|ang|...] [ scale &lt;factor&gt; ]]  
   x  y  z  q
   ...  
end  
</code></pre>

<ul>
<li><strong>units</strong> - specify the global units for the coordinates of point charges. Allowed values are au, bohr, nanometers, nm, pm, picometers, angstrom (note that only first 3 characters are important). The default units are angstrom</li>
<li><strong>namespace</strong> - an optional name that can be used to distinguish between potentially several point charge sets. The default value for namespace is &ldquo;default&rdquo;, and only the set that has this namespace value will be actually used in the calculation. If for example different namespace is used, this point charge set will be processed into the run time database but not actually used unless the following set directive is encountered</li>
</ul>
<pre><code>set bq &lt;namespace&gt;
</code></pre>

<p>Here is an example that illustrates this </p>
<pre><code> ...  
 #store point charge in namespace &quot;foo&quot;  
 bq &quot;foo&quot;
  ...  
 end  

 #perform calculation without actually loading charges in foo  
 task dft energy  

 #activate charges in foo  
 set bq foo  
 # now DFT calculation will performed in the presence of charges in foo  
 task dft energy
</code></pre>

<ul>
<li><strong>clear</strong> - this directive erases all the previously specified point charges in a given namespace, prior to new setup (if any).</li>
<li><strong>force</strong> <output_file> | <strong>noforce</strong> this directive triggers|disables calculation of forces on Bq charges. Default value is <strong>noforce</strong>, which disables force calculation. The forces will be written to <output_file> if provided or to <prefix>.bqforce.dat file. The format of the file is</li>
</ul>
<pre><code> #comment line
 fx fy fz
 ...
</code></pre>

<ul>
<li><strong>load</strong> <file> [charges <chargefile> ] [format ix iy iz iq] [units au|nm|pm|<strong>ang</strong>|&hellip;] [ scale <factor> ] - this directive allows to load point charges from external file(s). You can load charges and their coordinates from a single file, or from separate files. The files do not have to follow any specific format, but blank lines and comments (starting with #) will be ignored. The actual specification of how the coordinates/charges are laid out in in the file is given by format keyword. Multiple load directives are a supported.<br />
<strong> <file> - the name of the file where Bq coordinates and charges are stored. <br />
</strong> charges <chargefile> - this optional keyword allows to load charges (NOT the coordinates) from a separate <chargefile>. In this case, only coordinates would be loaded from <file>  </li>
</ul>
<p>** format ix iy iz iq - this optional keyword allows to set the fields (separated by blanks) where x,y,z coordinates and respective charge values are to be found. If a specified field doe nor exist or contains no numerical value, the processing will skip to the next line. The default value for format is &lsquo;&rsquo;&lsquo;2 3 4 5&rsquo;&lsquo;&rsquo;, which will work for the following example (note that the second line will not be processed here)  </p>
<pre><code> #this is a comment
 coordinates are in fields 2,3,4 and charge is field 5
 O  2.384   1.738   1.380  -0.9
 H  2.448   1.608   0.416   0.45
 H  1.560   1.268   1.608   0.45
</code></pre>

<p>** units au|nm|pm|ang|&hellip; - this optional keyword sets the local coordinate units valid only for this particular load directive. Otherwise global unit definition will apply (see above)</p>
<p>** scale <factor> - this optional keyword allows to scale loaded charge values by some factor</p>
<ul>
<li>x y z q  - explicit definition of coordinates and charge values of point charges. These can be mixed in with load directive at will. </li>
</ul>
<pre><code>  start w1  

  BASIS &quot;ao basis&quot; PRINT  
  * library &quot;3-21G&quot;  
  END  

  dft  
   mult 1  
   XC b3lyp  
   iterations 5000  
  end  

  geometry nocenter noautosym units angstrom noautoz print  
  O          2.045   1.011  -1.505  
  H1         1.912   0.062  -1.314  
  H2         1.119   1.318  -1.544  
  end  

  #example of explicit Bq input
  bq  
  2.384   1.738   1.380  -0.9  
  2.448   1.608   0.416   0.45  
  1.560   1.268   1.608   0.45  
  end  

  task dft energy  

  #example of implicit Bq input using load directive  
  bq  
  load bq.xyz format 1 2 3 4  
  end  
  task dft energy  

  #example of loading coordinates and charges separately  
  bq  
  load   bq.xyz charges bq.xyz format 1 2 3 4  
  end  
  task dft energy  

  #example of loading Bq's with default format (1 2 3 4) and scaling charges (to zero)  
  bq  
  load bq.xyz scale 0.0  
  end  
  task dft energy  

  #example of mixed Bq input  
  bq  
  load bqO.xyz format 2 3 4 6  
  2.448   1.608   0.416   0.45  
  1.560   1.268   1.608   0.45  
  end  
  task dft energy  

  #example of erasing Bq's  
  bq  
  clear  
  end  
  task dft energy  

  #example of storing Bq's in custom namespace (not activated)  
  bq marat  
  load bq.xyz format 1 2 3 4  
  end  
  task dft energy  

  #example of activating Bq's stored in custom namespace  
  set bq marat  

  task dft energy  
</code></pre>

<ul>
<li><strong>Increasing the limit on the number of bq  charges</strong>
  There is an internal limit of 25000 bq charges. To increase this use the following set directive in the input file
  set bq:max_nbq 30000</li>
</ul>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/nwchemgit/nwchem-wiki/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
      
    </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
