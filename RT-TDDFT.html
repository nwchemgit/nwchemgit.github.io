
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="NWChem Website">
      
      
      
        <link rel="canonical" href="https://nwchemgit.github.io/RT-TDDFT.html">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Real-time TDDFT - NWChem</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Lato";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#real-time-tddft" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="NWChem" class="md-header__button md-logo" aria-label="NWChem" data-md-component="logo">
      
  <img src="assets/MS3logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NWChem
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Real-time TDDFT
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/nwchemgit/nwchem-wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="NWChem" class="md-nav__button md-logo" aria-label="NWChem" data-md-component="logo">
      
  <img src="assets/MS3logo.png" alt="logo">

    </a>
    NWChem
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nwchemgit/nwchem-wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Home.html" class="md-nav__link">
        NWChem Manual
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          How to download and install NWChem
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="How to download and install NWChem" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          How to download and install NWChem
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Download.html" class="md-nav__link">
        How to download and install NWChem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Compiling-NWChem.html" class="md-nav__link">
        Compiling NWChem from source
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Introduction 
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Introduction " data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Introduction 
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Getting-Started.html" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="NWChem-Architecture.html" class="md-nav__link">
        NWChem Architecture
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Quantum-Mechanical-Methods
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Quantum-Mechanical-Methods" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Quantum-Mechanical-Methods
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Hartree-Fock-Theory-for-Molecules.html" class="md-nav__link">
        Hartree-Fock
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Density-Functional-Theory-for-Molecules.html" class="md-nav__link">
        Density Functional Theory (DFT)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Excited-State-Calculations.html" class="md-nav__link">
        CIS, TDHF, TDDFT
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Real-time TDDFT
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="RT-TDDFT.html" class="md-nav__link md-nav__link--active">
        Real-time TDDFT
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#units" class="md-nav__link">
    Units
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#syntax" class="md-nav__link">
    Syntax
  </a>
  
    <nav class="md-nav" aria-label="Syntax">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tmax-simulation-time" class="md-nav__link">
    TMAX: Simulation time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dt-time-step" class="md-nav__link">
    DT: Time step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tag-output-label" class="md-nav__link">
    TAG: Output label
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nchecks-number-of-run-time-check-points" class="md-nav__link">
    NCHECKS: Number of run-time check points
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nprints-number-of-print-points" class="md-nav__link">
    NPRINTS: Number of print points
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nrestarts-number-of-restart-checkpoints" class="md-nav__link">
    NRESTARTS: Number of restart checkpoints
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tolerances-controlling-numerical-tolerances" class="md-nav__link">
    TOLERANCES: Controlling numerical tolerances
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator-selecting-the-integrator-method" class="md-nav__link">
    PROPAGATOR: Selecting the integrator method
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exp-selecting-the-matrix-exponentiation-method" class="md-nav__link">
    EXP: Selecting the matrix exponentiation method
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prof-run-time-profiling" class="md-nav__link">
    PROF: Run-time profiling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#noprop-skipping-propagation" class="md-nav__link">
    NOPROP: Skipping propagation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-force-static-fock-matrix" class="md-nav__link">
    STATIC: Force static Fock matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#print-selecting-time-dependent-quantities-to-be-printed" class="md-nav__link">
    PRINT: Selecting time-dependent quantities to be printed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#field-sub-block-for-specifying-external-electric-fields" class="md-nav__link">
    FIELD: Sub-block for specifying external electric fields
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excite-excitation-rules" class="md-nav__link">
    EXCITE: Excitation rules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualization-sub-block-for-controlling-3d-visualization" class="md-nav__link">
    VISUALIZATION: Sub-block for controlling 3D visualization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-restart" class="md-nav__link">
    LOAD RESTART
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mocap-sub-block-for-molecular-orbital-complex-absorbing-potential" class="md-nav__link">
    MOCAP: Sub-block for molecular orbital complex absorbing potential
  </a>
  
    <nav class="md-nav" aria-label="MOCAP: Sub-block for molecular orbital complex absorbing potential">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#maxval-exponential-maximum-value" class="md-nav__link">
    MAXVAL: Exponential Maximum Value
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#emin-vacuum-energy-level" class="md-nav__link">
    EMIN: Vacuum Energy Level
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#onoff-turn-onoff-cap" class="md-nav__link">
    ON/OFF: Turn on/off CAP
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#worked-examples" class="md-nav__link">
    Worked Examples
  </a>
  
    <nav class="md-nav" aria-label="Worked Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#absorption-spectrum-of-water" class="md-nav__link">
    Absorption spectrum of water
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resonant-ultraviolet-excitation-of-water" class="md-nav__link">
    Resonant ultraviolet excitation of water
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#charge-transfer-between-a-tcne-dimer" class="md-nav__link">
    Charge transfer between a TCNE dimer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mo-cap-example" class="md-nav__link">
    MO CAP example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Plane-Wave-Density-Functional-Theory.html" class="md-nav__link">
        Plane-Wave Density Functional Theory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="TCE.html" class="md-nav__link">
        Tensor Contraction Engine Module: CI, MBPT, and CC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="MP2.html" class="md-nav__link">
        MP2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="CCSD.html" class="md-nav__link">
        Coupled Cluster Calculations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Multiconfiguration_SCF.html" class="md-nav__link">
        MCSCF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="GW.html" class="md-nav__link">
        Molecular GW
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Quantum Molecular Dynamics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Quantum Molecular Dynamics" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Quantum Molecular Dynamics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Plane-Wave-Density-Functional-Theory.html" class="md-nav__link">
        Plane Wave Density Functional Theory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Gaussian-Basis-AIMD.html" class="md-nav__link">
        Gaussian Basis AIMD
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Hybrid Approaches
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Hybrid Approaches" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Hybrid Approaches
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="COSMO-Solvation-Model.html" class="md-nav__link">
        COSMO Solvation Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="SMD-Model.html" class="md-nav__link">
        SMD (Solvation Model Based on Density) Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="VEM-Model.html" class="md-nav__link">
        VEM (Vertical Excitation or Emission) Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ONIOM.html" class="md-nav__link">
        Hybrid Calculations with ONIOM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM.html" class="md-nav__link">
        QMMM Simulations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Bq.html" class="md-nav__link">
        Bq
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="1D-RISM.html" class="md-nav__link">
        1D RISM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Potential Energy Surface Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Potential Energy Surface Analysis" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Potential Energy Surface Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Geometry-Optimization.html" class="md-nav__link">
        Geometry Optimization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Hessians-and-Vibrational-Frequencies.html" class="md-nav__link">
        Hessians
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Constraints.html" class="md-nav__link">
        Constraints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Nudged-Elastic-Band-and-Zero-Temperature-String-Methods.html" class="md-nav__link">
        Nudged Elastic Band (NEB) method
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Other-Capabilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Other-Capabilities" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Other-Capabilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Electron-Transfer.html" class="md-nav__link">
        Electron Transfer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Python.html" class="md-nav__link">
        Controlling NWChem with Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Quantum.html" class="md-nav__link">
        Quantum
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="VSCF.html" class="md-nav__link">
        Vibrational SCF (VSCF)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="CCCA_method.html" class="md-nav__link">
        Correlation consistent Composite Approach (ccCA)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Interface.html" class="md-nav__link">
        Interfaces to Other Programs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Examples.html" class="md-nav__link">
        NWChem Examples
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Benchmarks.html" class="md-nav__link">
        Benchmarks performed with NWChem
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Known-Bugs.html" class="md-nav__link">
        Known Bugs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="FAQ.html" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Tutorials.html" class="md-nav__link">
        NWChem Tutorials
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Forum.html" class="md-nav__link">
        Forum
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Archived-Forum.html" class="md-nav__link">
        Archived Forum
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="EMSL_Arrows.html" class="md-nav__link">
        EMSL Arrows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Software-supporting-NWChem.html" class="md-nav__link">
        Software supporting NWChem
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Supplementary-Information.html" class="md-nav__link">
        Supplementary Information
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Containers.html" class="md-nav__link">
        Containers
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#units" class="md-nav__link">
    Units
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#syntax" class="md-nav__link">
    Syntax
  </a>
  
    <nav class="md-nav" aria-label="Syntax">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tmax-simulation-time" class="md-nav__link">
    TMAX: Simulation time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dt-time-step" class="md-nav__link">
    DT: Time step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tag-output-label" class="md-nav__link">
    TAG: Output label
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nchecks-number-of-run-time-check-points" class="md-nav__link">
    NCHECKS: Number of run-time check points
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nprints-number-of-print-points" class="md-nav__link">
    NPRINTS: Number of print points
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nrestarts-number-of-restart-checkpoints" class="md-nav__link">
    NRESTARTS: Number of restart checkpoints
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tolerances-controlling-numerical-tolerances" class="md-nav__link">
    TOLERANCES: Controlling numerical tolerances
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagator-selecting-the-integrator-method" class="md-nav__link">
    PROPAGATOR: Selecting the integrator method
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exp-selecting-the-matrix-exponentiation-method" class="md-nav__link">
    EXP: Selecting the matrix exponentiation method
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prof-run-time-profiling" class="md-nav__link">
    PROF: Run-time profiling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#noprop-skipping-propagation" class="md-nav__link">
    NOPROP: Skipping propagation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-force-static-fock-matrix" class="md-nav__link">
    STATIC: Force static Fock matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#print-selecting-time-dependent-quantities-to-be-printed" class="md-nav__link">
    PRINT: Selecting time-dependent quantities to be printed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#field-sub-block-for-specifying-external-electric-fields" class="md-nav__link">
    FIELD: Sub-block for specifying external electric fields
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excite-excitation-rules" class="md-nav__link">
    EXCITE: Excitation rules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualization-sub-block-for-controlling-3d-visualization" class="md-nav__link">
    VISUALIZATION: Sub-block for controlling 3D visualization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-restart" class="md-nav__link">
    LOAD RESTART
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mocap-sub-block-for-molecular-orbital-complex-absorbing-potential" class="md-nav__link">
    MOCAP: Sub-block for molecular orbital complex absorbing potential
  </a>
  
    <nav class="md-nav" aria-label="MOCAP: Sub-block for molecular orbital complex absorbing potential">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#maxval-exponential-maximum-value" class="md-nav__link">
    MAXVAL: Exponential Maximum Value
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#emin-vacuum-energy-level" class="md-nav__link">
    EMIN: Vacuum Energy Level
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#onoff-turn-onoff-cap" class="md-nav__link">
    ON/OFF: Turn on/off CAP
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#worked-examples" class="md-nav__link">
    Worked Examples
  </a>
  
    <nav class="md-nav" aria-label="Worked Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#absorption-spectrum-of-water" class="md-nav__link">
    Absorption spectrum of water
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resonant-ultraviolet-excitation-of-water" class="md-nav__link">
    Resonant ultraviolet excitation of water
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#charge-transfer-between-a-tcne-dimer" class="md-nav__link">
    Charge transfer between a TCNE dimer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mo-cap-example" class="md-nav__link">
    MO CAP example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/nwchemgit/nwchem-wiki/blob/master/RT-TDDFT.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="real-time-tddft">Real-time TDDFT<a class="headerlink" href="#real-time-tddft" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>Real-time time-dependent density functional theory (RT-TDDFT) is a
DFT-based approach to electronic excited states based on integrating the
time-dependent Kohn-Sham (TDKS) equations in time. The theoretical
underpinnings, strengths, and limitations are similar to traditional
linear-response (LR) <a href="Excited-State-Calculations.html">TDDFT</a>
methods, but instead of a frequency domain solution to the TDKS
equations, RT-TDDFT yields a full time-resolved, potentially non-linear
solution. Real-time simulations can be used to compute not only
spectroscopic properties (e.g., absorption spectra, polarizabilites,
etc), but also the time and space-resolved electronic response to
arbitrary external stimuli (e.g., electron charge dynamics after laser
excitation). For theoretical and computational details, please refer to
the following paper:</p>
<ol>
<li>K. Lopata, N. Govind,&rdquo;Modeling Fast Electron Dynamics with Real-Time
    Time-Dependent Density Functional Theory: Application to Small
    Molecules and Chromophores&rdquo;, J. Chem. Theory Comput., 7, 1344 (2011)
    <a href="https://dx.doi.org/10.1021/ct200137z">DOI:10.1021/ct200137z</a></li>
</ol>
<p>This functionality is built on the <a href="Density-Functional-Theory-for-Molecules.html">Gaussian basis set
DFT</a> module, and
will work for closed-shell (spin-restricted) and open-shell (spin
unrestricted) calculations with essentially any combination of basis set
and exchange-correlation functional in NWChem. The current
implementation assumes frozen nuclei (Born-Oppenheimer approximation).</p>
<p>In a nutshell, running a RT-TDDFT calculation takes the following form:</p>
<ol>
<li>Compute ground state density matrix with DFT module</li>
<li>Propagate density matrix using RT-TDDFT</li>
<li>Post-process resulting time-dependent observables (e.g., dipole
    moment)</li>
</ol>
<h2 id="units">Units<a class="headerlink" href="#units" title="Permanent link">&para;</a></h2>
<p>Unless specified otherwise, all inputs and outputs are in <strong>atomic
units</strong>. Some useful conversions are:</p>
<table>
<thead>
<tr>
<th>Quantity</th>
<th>Conversion</th>
</tr>
</thead>
<tbody>
<tr>
<td>Time</td>
<td>1 au = 0.02419 fs</td>
</tr>
<tr>
<td>Length</td>
<td>1 au = 0.5292 A</td>
</tr>
<tr>
<td>Energy</td>
<td>1 au = 27.2114 eV</td>
</tr>
<tr>
<td>Electric field</td>
<td>1 au = 514.2 V/nm</td>
</tr>
<tr>
<td>Dipole moment</td>
<td>1 au = 2.542 D</td>
</tr>
</tbody>
</table>
<h2 id="syntax">Syntax<a class="headerlink" href="#syntax" title="Permanent link">&para;</a></h2>
<p>The <a href="Charge.html">charge</a>, <a href="Geometry.html">geometry</a>, <a href="Basis.html">basis
set</a>, and
<a href="Density-Functional-Theory-for-Molecules.html">DFT</a> options are
all specified as normal, using their respective syntax. Real-time TDDFT
parameters are supplied in the <code>RT_TDDFT</code> block (note, nothing is
case-sensitive), with all possible options summarized below, and each
discussed in detail
afterwards.</p>
<pre><code>RT_TDDFT 
  [TMAX &lt;double default 1000&gt;]  
  [DT &lt;double default 0.1&gt;]  
  [TAG &lt;string default &quot;&lt;rt_tddft&gt;: &quot;] 
  [LOAD (scf || vectors &lt;string&gt;)]  
  [NCHECKS &lt;integer default 10&gt;] 
  [NPRINTS (* || &lt;integer&gt;)]  
  [NRESTARTS (* || &lt;integer&gt;)]  
  [TOLERANCES (zero &lt;double default 1e-8&gt; || series &lt;double default 1e-10&gt; || interpol &lt;double default 1e-7&gt;)]  
  [PROPAGATOR (euler || rk4 || magnus) default magnus]  
  [EXP (diag || pseries)]  
  [PROF]  
  [NOPROP]  
  [STATIC]  
  [PRINT (*, dipole, quadrupole, field, moocc, field, energy, cputime, charge, convergence, s2)] 
  [EXCITE &lt;string geomname&gt;` with &lt;string fieldname&gt;]  
  [FIELD] 
    ...  
  [END]  
  [VISUALIZATION]  
    ...  
  [END] 
  [LOAD RESTART]
END
</code></pre>
<h3 id="tmax-simulation-time">TMAX: Simulation time<a class="headerlink" href="#tmax-simulation-time" title="Permanent link">&para;</a></h3>
<p>This option specifies the maximum time (in au) to run the simulation
before stopping, which must be a positive real number. In practice, you
can just stop the simulation early, so in most cases it is simplest to
just set this to a large value to ensure you capture all the important
dynamics (see the example of <a href="#resonant-ultraviolet-excitation-of-water">resonant ultraviolet excitation of water</a>). For most
valence excitations, for example, 1000 au is overkill so you might want
to automatically stop at 500 au:</p>
<pre><code>rt_tddft
  ...  
  tmax 500.0 
  ... 
end
</code></pre>
<h3 id="dt-time-step">DT: Time step<a class="headerlink" href="#dt-time-step" title="Permanent link">&para;</a></h3>
<p>This specifies the electronic time step for time integration. A larger
time step results in a faster simulation, but there are two issues which
limit the size of the time step. First, the integration algorithm can
become unstable and/or inaccurate for larger time steps, which depends
on the integrator used. Very roughly speaking, the second order Magnus
integrator should be reliable for time steps up to 0.2 au. Second, you
must choose a time step small enough to capture the oscillations of
interest, i.e., to resolve an excitation of energy &omega;, your time
step needs to be smaller than &pi;/&omega;, and typically a tenth of
that for accuracy. For example, to capture high energy oscillations such
as core-level excitations (e.g., &omega; = 50au) you might want a
relative small time step:</p>
<pre><code>rt_tddft
 ...
 dt 0.01
 ...
end
</code></pre>
<p>It is always good practice to check that your results are independent of
time step.</p>
<h3 id="tag-output-label">TAG: Output label<a class="headerlink" href="#tag-output-label" title="Permanent link">&para;</a></h3>
<p>This option sets a label for the output for convenient parsing (e.g.,
with &ldquo;grep&rdquo;). Every output line with time-dependent data will begin with
this string (set to <code>&lt;rt_tddft&gt;:</code> by default). For example setting:</p>
<pre><code>rt_tddft
 ...
 tag &quot;nameofrun&quot;
 ...
end
</code></pre>
<p>will result in outputs that look like:</p>
<pre><code>...
nameofrun      2.20000  -7.589146713114E+001     # Etot
...
</code></pre>
<h3 id="nchecks-number-of-run-time-check-points">NCHECKS: Number of run-time check points<a class="headerlink" href="#nchecks-number-of-run-time-check-points" title="Permanent link">&para;</a></h3>
<p>This option takes an integer number (default 10), or <code>*</code> which means
every step, which sets the total of number of run-time checkpoints,
where various sanity checks are made such as symmetries, idempotency,
traces, etc. These checks are not terribly efficient (e.g., involve
re-building the TD Fock matrix) so excessive checking will slow down
execution.</p>
<pre><code>rt_tddft
  ...
  nchecks 10
  ...
end
</code></pre>
<h3 id="nprints-number-of-print-points">NPRINTS: Number of print points<a class="headerlink" href="#nprints-number-of-print-points" title="Permanent link">&para;</a></h3>
<p>This sets the number of print points, i.e., the total number of
time-dependent observables (e.g., dipole, charge, energy) that are
computed and printed. It either takes an integer number or <code>*</code> which
means every time step (this is the default). Since there is no
appreciable cost to computing and printing these quantities, there is
usually no need to change this from <code>*</code>.</p>
<pre><code>rt_tddft
  ...
  nprints *
  ...
end
</code></pre>
<h3 id="nrestarts-number-of-restart-checkpoints">NRESTARTS: Number of restart checkpoints<a class="headerlink" href="#nrestarts-number-of-restart-checkpoints" title="Permanent link">&para;</a></h3>
<p>This sets the number of run-time check points where the time-dependent
complex density matrix is saved to file, allowing the simulation to be
<a href="#load-restart">restarted</a>) from that point. By
default this is set to 0. There is no significant computational cost to
restart checkpointing, but of course there is some disk I/O cost (which
may become somewhat significant for larger systems). For example, in the
following example there will be 100 restart points, which corresponds to
1 backup every 100 time steps.</p>
<pre><code>rt_tddft
  ...
  tmax 1000.0
  dt 0.1
  nrestarts 100
  ...
end
</code></pre>
<h3 id="tolerances-controlling-numerical-tolerances">TOLERANCES: Controlling numerical tolerances<a class="headerlink" href="#tolerances-controlling-numerical-tolerances" title="Permanent link">&para;</a></h3>
<p>This option controls various numerical tolerances:</p>
<ul>
<li><code>zero</code>: threshold for checks that quantities are zero, e.g., in
    symmetry checks (default 1e-8)</li>
<li><code>series</code>: numerical convergence for series, e.g., matrix
    exponentiation (default 1e-10)</li>
<li><code>interpol</code>: numerical convergence for interpolation, e.g., in Magnus
    propagator (default 1e-7)</li>
</ul>
<p>Occasionally it is useful to loosen the interpolation tolerances if the
Magnus interpolator requires an excessive amount of steps; usually this
will not impact accuracy. For example, this sets the tolerances to their
defaults with a looser interpolation tolerance:</p>
<pre><code>rt_tddft
  ...
  tolerances zero 1d-8 series 1d-10 interpol 1e-5
end
</code></pre>
<h3 id="propagator-selecting-the-integrator-method">PROPAGATOR: Selecting the integrator method<a class="headerlink" href="#propagator-selecting-the-integrator-method" title="Permanent link">&para;</a></h3>
<p>This selects the propagator (i.e., time integrator) method. Possible
choices include <code>euler</code> for Euler integration (terrible, you should
never use this), <code>rk4</code> for 4th order Runge-Kutta, and <code>magnus</code> for 2nd
order Magnus with self-consistent interpolation. In virtually all cases
Magnus is superior in terms of stability. Euler or rk4 are perhaps only
useful for debugging or simplicity (e.g., for code development).</p>
<pre><code>rt_tddft
  ...
  propagator magnus
  ...
end
</code></pre>
<h3 id="exp-selecting-the-matrix-exponentiation-method">EXP: Selecting the matrix exponentiation method<a class="headerlink" href="#exp-selecting-the-matrix-exponentiation-method" title="Permanent link">&para;</a></h3>
<p>This selects the method for exponentiation matrices. For now this can
either be <code>pseries</code> for a contractive power series or <code>diag</code> for
diagonalization. In general the power series (default) is faster.</p>
<pre><code>rt_tddft
  ...
  exp diag
  ...
end
</code></pre>
<h3 id="prof-run-time-profiling">PROF: Run-time profiling<a class="headerlink" href="#prof-run-time-profiling" title="Permanent link">&para;</a></h3>
<p>This turns on run-time profiling, which will display time spent in each
component of the code (e.g., building components of the TD Fock matrix,
properites, etc). This slows code down slightly and results in very
verbose output.</p>
<pre><code>rt_tddft
  ...
  prof
  ...
end
</code></pre>
<h3 id="noprop-skipping-propagation">NOPROP: Skipping propagation<a class="headerlink" href="#noprop-skipping-propagation" title="Permanent link">&para;</a></h3>
<p>This options causes the RT-TDDFT module skip propagation, i.e., to
initialize and finalize. For now this is largely useful for skipping to
visualization post-processing without having to re-run a simulation.</p>
<pre><code>rt_tddft
  ...
  noprop
  ...
end
</code></pre>
<h3 id="static-force-static-fock-matrix">STATIC: Force static Fock matrix<a class="headerlink" href="#static-force-static-fock-matrix" title="Permanent link">&para;</a></h3>
<p>This option sets the static Fock matrix flag, meaning the time-dependent
Fock matrix will not be recalculated at each time, but instead use the
<em>t=0</em> value. This will drastically increase the simulation speed since the
bulk of the work is spent rebuilding the TD Fock matrix, but will give
non-physical results. For example, using <code>static</code> to compute an
absorption spectrum will result in excitations corresponding to the raw
eigenvalue differences without electron-hole relaxation. This option has
few uses besides dry-runs and debugging.</p>
<pre><code>rt_tddft
  ...
  static
  ...
end
</code></pre>
<h3 id="print-selecting-time-dependent-quantities-to-be-printed">PRINT: Selecting time-dependent quantities to be printed<a class="headerlink" href="#print-selecting-time-dependent-quantities-to-be-printed" title="Permanent link">&para;</a></h3>
<p>This sets the various time-dependent properties that are to be computed
and printed at each print point. Note that for many of these options,
the values are computed and printed for each geometry specified in the
input deck, not only the active one (i.e., the one set using <code>set
geometry ...</code> in the input deck). Possible choices are:</p>
<ul>
<li><code>dipole</code>: Dipole moment</li>
<li><code>quadrupole</code>: Quadrupole moment</li>
<li><code>field</code>: External (applied) electric field</li>
<li><code>moocc</code>: Molecular orbital occupations</li>
<li><code>energy</code>: Components of system energy (e.g., core, XC, total, etc)</li>
<li><code>cputime</code>: CPU time taken in simulation so far (useful for checking
    scaling)</li>
<li><code>charge</code>: Electronic charge (computed from density matrix, not from
    the XC grid)</li>
<li><code>convergence</code>: Convergence information (e.g., from Magnus)</li>
<li><code>s2</code>: <S2> value (openshell only)</li>
<li><code>*</code>: Print all quantities</li>
</ul>
<p>The defaults correspond to:</p>
<pre><code>rt_tddft
  ...
  print dipole field energy convergence
  ...
end
</code></pre>
<h3 id="field-sub-block-for-specifying-external-electric-fields">FIELD: Sub-block for specifying external electric fields<a class="headerlink" href="#field-sub-block-for-specifying-external-electric-fields" title="Permanent link">&para;</a></h3>
<p>This sub-block is used to specify external electric fields, each of
which must be given a unique name. Numerous fields can be specified, but
each will applied to the system only if an appropriate <a href="#excite-excitation-rules">excitation
rule</a> is set.
There are a few preset field types; others would have to be manually
coded. Note the names are arbitrary, but chosen here to be
descriptive:</p>
<pre><code>field &quot;kick&quot;
  type delta      # E(t=0) = max; E(t&gt;0) = 0
  polarization x  # = x, y, z
  max 0.0001      # maximum value of electric field
  spin total      # = alpha, beta, total (only valid for open-shell)
end
</code></pre>
<pre><code>field &quot;gpulse&quot;
  type gaussian   # Gaussian enveloped quasi-monochromatic pulse: E(t) = max * exp( -(t-t0)^2 / 2s^2) * sin(w0*t + phi0)
  polarization x  # = x, y, z
  frequency 0.12  # frequency of laser pulse in au (e.g., 0.12 au = 3.27 eV)
  phase 0.0       # phase shift of laser pulse (in rad)
  center 200.0    # center of Gaussian envelope (in au time)
  width 50.0      # width of Gaussian pulse (in au time)
  max 0.0001      # maximum value of electric field
  spin total      # = alpha, beta, total (only valid for open-shell)
end
</code></pre>
<pre><code>field &quot;hpulse&quot;
  type hann       # sin^2 (Hann) enveloped quasi-monochromatic pulse
  polarization x  # = x, y, z
  frequency 0.12  # frequency of laser pulse in au (e.g., 0.12 au = 3.27 eV)
  center 200.0    # center of Hann envelope (in au time)
  width 50.0      # width of Hann pulse (in au time)
  max 0.0001      # maximum value of electric field
  spin total      # = alpha, beta, total (only valid for open-shell)
end
</code></pre>
<pre><code>field &quot;resonant&quot;
  type cw         # monochromatic continuous wave
  frequency 0.12  # frequency of laser pulse in au (e.g., 0.12 au = 3.27 eV)
  polarization x  # = x, y, z
  max 0.0001      # maximum value of electric field
  spin total      # = alpha, beta, total (only valid for open-shell)
end
</code></pre>
<h3 id="excite-excitation-rules">EXCITE: Excitation rules<a class="headerlink" href="#excite-excitation-rules" title="Permanent link">&para;</a></h3>
<p>This sets the rules for applying external fields to the system. It takes
the form <code>excite &lt;geom&gt; with &lt;field&gt;</code>, where <code>&lt;geom&gt;</code> is the name of a
geometry fragment (defaults to &ldquo;geometry&rdquo; which is the default geometry
name), and <code>&lt;field&gt;</code> is the name of a <a href="#field-sub-block-for-specifying-external-electric-fields">field
structure</a>.
Assuming, for example, you have defined a field name <code>kick</code> this option
takes the form (note that quotes are optional and shown for clarity):</p>
<pre><code>rt_tddft
  ...
  excite &quot;geometry&quot; with &quot;kick&quot;
  ...
end
</code></pre>
<h3 id="visualization-sub-block-for-controlling-3d-visualization">VISUALIZATION: Sub-block for controlling 3D visualization<a class="headerlink" href="#visualization-sub-block-for-controlling-3d-visualization" title="Permanent link">&para;</a></h3>
<p>This block is used to control visualization of the electronic charge
density, which is typically used during a resonant excitation. This is a
two stage process. During the propagation, a series of density matrices
will be dumped to file (see options below). After propagation, if the
<code>dplot</code> option is set, the code will read in options from a separate
<code>DPLOT</code> block and convert the density matrix snapshots to a corresponding
series of real-space charge density <code>cube</code>
files.</p>
<pre><code>visualization
  tstart 0.0        # start visualization at this time
  tend 100.0        # stop visualization at this time
  treference 0.0    # subtract density matrix at this time (useful for difference densities)
  dplot             # post-process density matrices into cube files after propagation
end
</code></pre>
<h3 id="load-restart">LOAD RESTART<a class="headerlink" href="#load-restart" title="Permanent link">&para;</a></h3>
<p>This keyword needs to be added to <a href="Start_Restart.html">restart</a> a calculation. In the following example, the calculation will restart from the previous calculation and extend the run to the new <code>tmax</code></p>
<pre><code>rt_tddft
  ...
  tmax 10.0        # new end time
  load restart
end
</code></pre>
<h3 id="mocap-sub-block-for-molecular-orbital-complex-absorbing-potential">MOCAP: Sub-block for molecular orbital complex absorbing potential<a class="headerlink" href="#mocap-sub-block-for-molecular-orbital-complex-absorbing-potential" title="Permanent link">&para;</a></h3>
<p>The
K. Lopata and N. Govind,
&ldquo;Near and Above Ionization Electronic Excitations with Non-Hermitian
Real-Time Time-Dependent Density Functional Theory&rdquo;,
Journal of Chemical Theory and Computation 9 (11), 4939-4946 (2013)
    <a href="https://dx.doi.org/10.1021/ct400569s">DOI:10.1021/ct400569s</a></p>
<pre><code>  mocap
    maxval 100.0     # clamp CAP at this value (in Ha)
    emin 0.5         # any MO with eigenvalue &gt;= 0.5 Ha will have CAP applied to it
    prefac 1.0       # prefactor for exponential
    expconst 1.0     # exponential constant for CAP
    on               # turn on/off CAP
    nochecks         # disable checks for speed
    noprint          # don't print CAP value
  end
</code></pre>
<h4 id="maxval-exponential-maximum-value">MAXVAL: Exponential Maximum Value<a class="headerlink" href="#maxval-exponential-maximum-value" title="Permanent link">&para;</a></h4>
<h4 id="emin-vacuum-energy-level">EMIN: Vacuum Energy Level<a class="headerlink" href="#emin-vacuum-energy-level" title="Permanent link">&para;</a></h4>
<h4 id="onoff-turn-onoff-cap">ON/OFF: Turn on/off CAP<a class="headerlink" href="#onoff-turn-onoff-cap" title="Permanent link">&para;</a></h4>
<p>The default value is <code>off</code>, i.e. no complex absorbing potential is applied.</p>
<h2 id="worked-examples">Worked Examples<a class="headerlink" href="#worked-examples" title="Permanent link">&para;</a></h2>
<h3 id="absorption-spectrum-of-water">Absorption spectrum of water<a class="headerlink" href="#absorption-spectrum-of-water" title="Permanent link">&para;</a></h3>
<p>Here, we compute the 6-31G/TD-PBE0 absorption spectrum of gas-phase
water using RT-TDDFT. In the weak-field limit, these results are
essentially identical to those obtained via traditional linear-response
TDDFT. Although it involves significantly more work do use RT-TDDFT in
this case, for very large systems with many roots a real-time approach
becomes advantageous computationally and also does not suffer from
algorithm stability issues.</p>
<p>To compute the absorption, we find the ground state of the system and
then subject it to three delta-function excitations (x,y,z), which
simultaneously excites all electronic modes of that polarization. The
three resulting dipole moments are then Fourier transformed to give the
frequency-dependent linear polarizability, and thus the absorption
spectrum. The full input deck is
<a href="RT_TDDFT_h2o_abs.nw">RT_TDDFT_h2o_abs.nw</a> and
the corresponding output is
<a href="RT_TDDFT_h2o_abs.nwo.gz">RT_TDDFT_h2o_abs.nwo.gz</a>.</p>
<pre><code>title &quot;Water TD-PBE0 absorption spectrum&quot;
echo


start water

##                                                                                                                                                                           
## aug-cc-pvtz / pbe0 optimized                                                                                                                                              
##                                                                                                                                                                           
## Note: you are required to explicitly name the geometry                                                                                                                    
##                                                                                                                                                                           
geometry &quot;system&quot; units angstroms nocenter noautoz noautosym
  O     0.00000000    -0.00001441    -0.34824012
  H    -0.00000000     0.76001092    -0.93285191
  H     0.00000000    -0.75999650    -0.93290797
end

## Note: We need to explicitly set the &quot;active&quot; geometry even though there is only one geom.                                                                                 
set geometry &quot;system&quot;

## All DFT and basis parameters are inherited by the RT-TDDFT code                                                                                                           
basis
 * library 6-31G
end

dft
  xc pbe0
end

## Compute ground state of the system                                                                                                                                        
task dft energy

##                                                                                                                                                                           
## Now, we compute an x, y, and z kick simulation, which we give separate &quot;tags&quot; for post-processing.                                                                  
##                                                                                                                                                                           

unset rt_tddft:*
rt_tddft
  tmax 200.0
  dt 0.2

  tag &quot;kick_x&quot;

  field &quot;kick&quot;
    type delta
    polarization x
    max 0.0001
  end

  excite &quot;system&quot; with &quot;kick&quot;
 end
task dft rt_tddft

unset rt_tddft:*
rt_tddft
  tmax 200.0
  dt 0.2

  tag &quot;kick_y&quot;

  field &quot;kick&quot;
    type delta
    polarization y
    max 0.0001
  end

  excite &quot;system&quot; with &quot;kick&quot;
 end
task dft rt_tddft

unset rt_tddft:*
rt_tddft
  tmax 200.0
  dt 0.2

  tag &quot;kick_z&quot;

  field &quot;kick&quot;
    type delta
    polarization z
    max 0.0001
  end

  excite &quot;system&quot; with &quot;kick&quot;
 end
task dft rt_tddft
</code></pre>
<p>After running the simulation, we extract the x-dipole moment for the
x-kick and similarly for the y and z-kicks (see <a href="https://github.com/nwchemgit/nwchem/tree/master/contrib/parsers">&ldquo;contrib/parsers&rdquo;
directory</a> for this script or download here:
<a href="RT_TDDFT_scripts.tgz">RT_TDDFT_scripts.tgz</a> ).</p>
<pre><code>nw_rtparse.py -xdipole -px -tkick_x h2o_abs.nwo &gt; x.dat
nw_rtparse.py -xdipole -py -tkick_y h2o_abs.nwo &gt; y.dat
nw_rtparse.py -xdipole -pz -tkick_z h2o_abs.nwo &gt; z.dat
</code></pre>
<p>Note, the syntax for extracting the x polarization for the x-kick, etc.
Alternatively, we could grep and cut, or whatnot. This will give use the
resulting time-dependent dipole moments:</p>
<p><img alt="Time-dependent dipole moments" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/RT_TDDFT_h2o_td_dipoles.png" align=middle with="730pt" height="200pt"/>  </p>
<p>Now, we need to take the Fourier transforms of these dipole moments to
yield the the x,x element of the 3x3 linear polarizability tensor, and
similarly for the y,y and z,z elements. Here I am using an FFT utility,
although any discrete Fourier transform will do. To accelerate
convergence of the FFT, I have damped the time signals by
<em>exp(-t /&tau;)</em> which results in Lorentzians with FWHM of
<em>2 / &tau;</em> and have also &ldquo;zero padded&rdquo; the data with 50000 points.
This is not critical for extracting frequencies, but creates &ldquo;cleaner&rdquo;
spectra, although care must be taken to damp sufficiently if padding to
avoid artifacts (see small ripples around 23 eV in plot below). After
Fourier transform, I &ldquo;paste&rdquo; the three files together to easily plot the
absorption, which is constructed from the trace of the polarizability
matrix, i.e., the sum of the imaginary parts of the FFTs of the dipole
moments.</p>
<p><em>S (&omega;) = (4&pi;&omega;)/(3c&kappa;)</em>Tr[Im<em> &alpha;(&omega;)</em>]  </p>
<p>where <em>c</em> is the speed of light (137 in atomic units), <em>&kappa;</em>  is
the kick electric field strength, and <em>&alpha;(&omega;)</em> is the linear
polarizabilty tensor computed from the Fourier transforms of the
time-dependent dipole moments. For example,</p>
<pre><code>fft1d -d50 -z -p50000 &lt; x.dat | rotate_fft &gt; xw.dat
fft1d -d50 -z -p50000 &lt; y.dat | rotate_fft &gt; yw.dat
fft1d -d50 -z -p50000 &lt; z.dat | rotate_fft &gt; zw.dat
paste xw.dat yw.dat zw.day &gt; s.dat
</code></pre>
<p>Here, you can just use your favorite Fourier transform utility or
analysis software, but for convenience there is also a simple GNU Octave
fft1d.m utility in the &ldquo;contrib/parsers&rdquo; directory of the trunk or
download here:
<a href="RT_TDDFT_scripts.tgz">RT_TDDFT_scripts.tgz</a>
Note, options are hardcoded at the moment, so the switches above are not
correct instead edit the file and run (also it reads file rather than
redirect from stdin). Assuming the FFT output takes the form (w, Re, Im,
Abs), to plot using gnuplot we would do:</p>
<pre><code>gnuplot&gt; plot &quot;s.dat&quot; u ($1*27.2114):($1*($3+$7+$11))
</code></pre>
<p>where we have scaled by 27.2114 to output in eV instead of atomic units,
and we have not properly scaled to get the absolute oscillator strengths
(thus our magnitudes are in &ldquo;arbitrary units&rdquo;). The real-time spectrum
is shown below, along with the corresponding linear-response TDDFT
excitations are shown in orange for comparison. Since we are in the weak
field regime, the two are identical. Note the oscillator strengths are
arbitrary and scaled, if not scaled the area under each RT-TDDFT curve
should integrate to the linear response oscillator strength.</p>
<p><img alt="Linear absorption spectrum" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/RT_TDDFT_h2o_abs_spectrum.png" align=middle with="262pt" height="200pt"/>  </p>
<h3 id="resonant-ultraviolet-excitation-of-water">Resonant ultraviolet excitation of water<a class="headerlink" href="#resonant-ultraviolet-excitation-of-water" title="Permanent link">&para;</a></h3>
<p>In this example we compute the time-dependent electron response to a
quasi-monochromatic laser pulse tuned to a particular transition. We
will use the results of the previous example (6-31G/PBE0 gas-phase
water). First, we consider the absorption spectrum (computed previously)
but plotted for the three polarizations (x,y,z) rather then as a sum.
Say we are interested in the excitation near 10 eV. We can clearly see
this is a z-polarized transition (green on curve). To selectively excite
this we could use a continuous wave E-field, which has a delta-function,
i.e., single frequency, bandwidth but since we are doing finite
simulations we need a suitable envelope. The broader the envelope in
time the narrower the excitation in frequency domain, but of course long
simulations become costly so we need to put some thought into the choice
of our envelope. In this case the peak of interest is spectrally
isolated from other z-polarized peaks, so this is quite straightforward.
The procedure is outlined below, and the corresponding frequency extent
of the pulse is shown on the absorption figure in orange. Note that it
only covers one excitation, i.e., the field selectively excites one
mode. The full input deck is
<a href="RT_TDDFT_h2o_resonant.nw">RT_TDDFT_h2o_resonant.nw</a>
and the output is
<a href="RT_TDDFT_h2o_resonant.nwo.gz">RT_TDDFT_h2o_resonant.nwo.gz</a>.</p>
<p><img alt="Absorption spectrum and excitation bandwidth" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/RT_TDDFT_h2o_resonant_spec_field.png" align=middle with="244pt" height="200pt"/>  </p>
<pre><code>title &quot;Water TD-PBE0 resonant excitation&quot; 
echo
scratch_dir ./scratch
permanent_dir ./perm

start water

##
## aug-cc-pvtz / pbe0 optimized
##
## Note: you are required to explicitly name the geometry
##
geometry &quot;system&quot; units angstroms nocenter noautoz noautosym
  O     0.00000000    -0.00001441    -0.34824012
  H    -0.00000000     0.76001092    -0.93285191
  H     0.00000000    -0.75999650    -0.93290797
end

## Note: We need to explicitly set the &quot;active&quot; geometry even though there is only one geom.
set geometry &quot;system&quot; 

## All DFT and basis parameters are inherited by the RT-TDDFT code
basis
 * library 6-31G
end

dft
 xc pbe0
end

## Compute ground state of the system
task dft energy

##
## We excite the system with a quasi-monochromatic
## (Gaussian-enveloped) z-polarized E-field tuned to a transition at
## 10.25 eV.  The envelope takes the form:
##
## G(t) = exp(-(t-t0)^2 / 2s^2)
##
## The target excitation has an energy (frequency) of w = 0.3768 au
## and thus an oscillation period of T = 2 pi / w = 16.68 au
##
## Since we are doing a Gaussian envelope in time, we will get a
## Gaussian envelope in frequency (Gaussians are eigenfunctions of a
## Fourier transform), with width equal to the inverse of the width in
## time.  Say, we want a Gaussian in frequency with FWHM = 1 eV
## (recall FWHM = 2 sqrt (2ln2) s_freq) we want an s_freq = 0.42 eV =
## 0.0154 au, thus in time we need s_time = 1 / s_time = 64.8 au.
##
## Now we want the envelope to be effectively zero at t=0, say 1e-8
## (otherwise we get &quot;windowing&quot; effects).  Reordering G(t):
##
## t0 = t - sqrt(-2 s^2 ln G(t))
##
## That means our Gaussian needs to be centered at t0 = 393.3 au.
##
## The total simulation time will be 1000 au to leave lots of time to
## see oscillations after the field has passed.
##
rt_tddft
  tmax 1000.0
  dt 0.2

  field &quot;driver&quot;
    type gaussian
    polarization z
    frequency 0.3768  # = 10.25 eV
    center 393.3
    width 64.8
    max 0.0001
  end

  excite &quot;system&quot; with &quot;driver&quot;
 end
task dft rt_tddft
</code></pre>
<p><img alt="Time-dependent electric field and dipole moment during resonant excitation" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/RT_TDDFT_h2o_resonant_td.png" align=middle with="268pt" height="200pt"/>  </p>
<p>From the time-dependent dipole moment you can see the field driving the
system into a superposition of the ground state and the one excited
state, which manifests as monochromatic oscillations. After the field
has passed the dipole oscillations continue forever as there is no
damping in the system.</p>
<h3 id="charge-transfer-between-a-tcne-dimer">Charge transfer between a TCNE dimer<a class="headerlink" href="#charge-transfer-between-a-tcne-dimer" title="Permanent link">&para;</a></h3>
<p>Here we compute the time-dependent charge oscillations between a TCNE
(tetracyanoethylene) dimer separated by 3 Angstroms, where the top
molecule starts neutral and the bottom one starts with a -1 charge. This
somewhat non-physical starting point will lead to far-from-equilibrium
dynamics as the charge violently sloshes between the two molecules, with
the oscillation period a function of the molecular separation. The trick
here is to use fragments by have multiple geometries in the input deck,
where each fragment is converged separately, then assembled together
without SCF to use as a starting point. We use a small but diffuse basis
and a range-separated functional (CAM-B3LYP). The input deck is
<a href="RT_TDDFT_tcne_dimer.nw">RT_TDDFT_tcne_dimer.nw</a>
and the full output is
<a href="RT_TDDFT_tcne_dimer.nwo.gz">RT_TDDFT_tcne_dimer.nwo.gz</a>.</p>
<pre><code>title &quot;Tetracyanoethylene dimer charge transfer&quot;

echo
scratch_dir ./scratch
permanent_dir ./perm

start tcne
echo

##
## Each fragment optimized with cc-pvdz/B3LYP
##
geometry &quot;bottom&quot; units angstroms noautosym nocenter noautoz
 C    -1.77576486     0.66496556     0.00004199
 N    -2.94676621     0.71379797     0.00004388
 C    -0.36046718     0.62491168     0.00003506
 C     0.36049301    -0.62492429    -0.00004895
 C     1.77579907    -0.66504145    -0.00006082
 N     2.94680364    -0.71382258    -0.00006592
 C    -0.31262746    -1.87038951    -0.00011201
 N    -0.85519492    -2.90926164    -0.00016331
 C     0.31276207     1.87031662     0.00010870
 N     0.85498782     2.90938919     0.00016857
end

geometry &quot;top&quot; units angstroms noautosym nocenter noautoz
 C    -1.77576486     0.66496556     3.00004199
 N    -2.94676621     0.71379797     3.00004388
 C    -0.36046718     0.62491168     3.00003506
 C     0.36049301    -0.62492429     2.99995105
 C     1.77579907    -0.66504145     2.99993918
 N     2.94680364    -0.71382258     2.99993408
 C    -0.31262746    -1.87038951     2.99988799
 N    -0.85519492    -2.90926164     2.99983669
 C     0.31276207     1.87031662     3.00010870
 N     0.85498782     2.90938919     3.00016857
end


## dimer geometry is the union of bottom and top geometry
geometry &quot;dimer&quot; units angstroms noautosym nocenter noautoz
 C    -1.77576486     0.66496556     0.00004199
 N    -2.94676621     0.71379797     0.00004388
 C    -0.36046718     0.62491168     0.00003506
 C     0.36049301    -0.62492429    -0.00004895
 C     1.77579907    -0.66504145    -0.00006082
 N     2.94680364    -0.71382258    -0.00006592
 C    -0.31262746    -1.87038951    -0.00011201
 N    -0.85519492    -2.90926164    -0.00016331
 C     0.31276207     1.87031662     0.00010870
 N     0.85498782     2.90938919     0.00016857
#---
 C    -1.77576486     0.66496556     3.00004199
 N    -2.94676621     0.71379797     3.00004388
 C    -0.36046718     0.62491168     3.00003506
 C     0.36049301    -0.62492429     2.99995105
 C     1.77579907    -0.66504145     2.99993918
 N     2.94680364    -0.71382258     2.99993408
 C    -0.31262746    -1.87038951     2.99988799
 N    -0.85519492    -2.90926164     2.99983669
 C     0.31276207     1.87031662     3.00010870
 N     0.85498782     2.90938919     3.00016857
end


##
## C, N: 3-21++G
##
basis spherical
C    S
    172.2560000              0.0617669        
     25.9109000              0.3587940        
      5.5333500              0.7007130        
C    SP
      3.6649800             -0.3958970              0.2364600        
      0.7705450              1.2158400              0.8606190        
C    SP
      0.1958570              1.0000000              1.0000000        
C    SP
      0.0438000              1.0000000              1.0000000        
N    S
    242.7660000              0.0598657        
     36.4851000              0.3529550        
      7.8144900              0.7065130        
N    SP
      5.4252200             -0.4133010              0.2379720        
      1.1491500              1.2244200              0.8589530        
N    SP
      0.2832050              1.0000000              1.0000000        
N    SP
      0.0639000              1.0000000              1.0000000        
end


##
## Charge density fitting basis.
##
basis &quot;cd basis&quot;
C    S
      5.91553927E+02         0.31582020
      1.72117940E+02         0.87503863
      5.47992590E+01         2.30760524
C    S
      1.89590940E+01         1.0000000
C    S
      7.05993000E+00         1.0000000
C    S
      2.79484900E+00         1.0000000
C    S
      1.15863400E+00         1.0000000
C    S
      4.94324000E-01         1.0000000
C    S
      2.12969000E-01         1.0000000
C    P
      3.27847358E-01         1.0000000
C    P
      7.86833659E-01         1.0000000
C    P
      1.97101832E+00         1.0000000
C    D
      4.01330100E+00         1.0000000
C    D
      1.24750500E+00         1.0000000
C    D
      4.08148000E-01         1.0000000
C    F
      9.00000000E-01         1.0000000
N    S
      7.91076935E+02         0.41567506
      2.29450184E+02         1.14750694
      7.28869600E+01         3.01935767
N    S
      2.51815960E+01         1.0000000
N    S
      9.37169700E+00         1.0000000
N    S
      3.71065500E+00         1.0000000
N    S
      1.53946300E+00         1.0000000
N    S
      6.57553000E-01         1.0000000
N    S
      2.83654000E-01         1.0000000
N    P
      4.70739194E-01         1.0000000
N    P
      1.12977407E+00         1.0000000
N    P
      2.83008403E+00         1.0000000
N    D
      5.83298650E+00         1.0000000
N    D
      1.73268650E+00         1.0000000
N    D
      5.45242500E-01         1.0000000
N    F
      1.82648000E+00         1.0000000
end


##
## Universal DFT parameters. Note, we are doing open-shell even for
## the neutral fragment so the movecs have the correct size. 
##
## We are using the CAM-B3LYP functional (no need to use &quot;direct&quot;
## since we are doing CD fitting).
##
dft
  xc xcamb88 1.00 lyp 0.81 vwn_5 0.19 hfexch 1.00
  cam 0.33 cam_alpha 0.19 cam_beta 0.46
  odft
  convergence density 1d-9
  grid fine
  maxiter 1000
end


##
## Converge bottom fragment with extra electron and top fragment as
## neutral.
##
charge -1
set geometry &quot;bottom&quot;
dft
  mult 2
  vectors input atomic output &quot;bottom.movecs&quot;
end
task dft energy

charge 0
set geometry &quot;top&quot;
dft
  mult 1
  vectors input atomic output &quot;top.movecs&quot;
end
task dft energy


##
## Assemble the two fragments but don't do SCF--this keeps the system
## in a far-from-equilibrium state from which we will watch the
## dynamics.
##
charge -1
set geometry &quot;dimer&quot;
dft
  mult 2
  vectors input fragment &quot;bottom.movecs&quot; &quot;top.movecs&quot; output &quot;dimer.movecs&quot;
  noscf
end
task dft energy


##
## Now do RT-TDDFT from this crazy state without any electric fields.
##
rt_tddft
  tmax 500.0
  dt 0.2
  load vectors &quot;dimer.movecs&quot;

  print dipole field energy s2 charge
end
task dft rt_tddft
</code></pre>
<p><img alt="Time dependent charge oscillation between a TCNE dimer" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/RT_TDDFT_tcne_td_charge.png" align=middle with="364pt" height="200pt"/>  </p>
<p>The time-dependent charge shows that the excess electron starts on the
&ldquo;bottom&rdquo; molecule (i.e., a total electronic charge of -65), then swings
to completely occupy the &ldquo;top&rdquo; molecule then oscillates back and forth.
The frequency of this oscillation is dependent on the separation, with
larger separations leading to lower frequencies. It is important to
note, however, this starting point is highly non-physical, specifically
converging the two fragments together and &ldquo;gluing&rdquo; them together
introduces an indeterminate amount of energy to the system, but this
simulation shows how charge dynamics simulations can be done.</p>
<h3 id="mo-cap-example">MO CAP example<a class="headerlink" href="#mo-cap-example" title="Permanent link">&para;</a></h3>
<pre><code>## aug-cc-pvtz/PBE0 optimized
geometry &quot;system&quot; units angstroms noautosym noautoz nocenter
  O     0.00000043     0.11188833     0.00000000
  H     0.76000350    -0.47275229     0.00000000
  H    -0.76000393    -0.47275063     0.00000000
end

set geometry &quot;system&quot;

basis spherical
  * library 6-31G*
end

dft
  xc pbe0
  convergence density 1d-9
end
task dft

rt_tddft
  dt 0.2
  tmax 250.0

  print dipole field energy charge

  mocap
    expconst 1.0     # exponential constant for CAP
    emin 0.5         # any MO with eigenvalue &gt;= 0.5 Ha will have CAP applied to it
    prefac 1.0       # prefactor for exponential
    maxval 100.0     # clamp CAP at this value (in Ha)
    on               # turn on CAP
    nochecks         # disable checks for speed
    noprint          # don't print CAP value
  end

  field &quot;kick&quot;
    type delta
    max 0.0001
    polarization z
  end

  excite &quot;system&quot; with &quot;kick&quot;
end
task dft rt_tddft
</code></pre>
<p>After running the parser script on the output files from the input above using either with the <code>on</code> or <code>off</code> keywords, the following plot can be produced from the data file obtained with the command <code>nw_rtparse.py   -xdipole -pz -t"&lt;rt_tddft&gt;"</code>
<img alt="Time dependent dipole with and without CAP" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/cap_dipole.png" align=middle with="364pt" height="275pt"/></p>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="Excited-State-Calculations.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: CIS, TDHF, TDDFT" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              CIS, TDHF, TDDFT
            </div>
          </div>
        </a>
      
      
        
        <a href="Plane-Wave-Density-Functional-Theory.html" class="md-footer__link md-footer__link--next" aria-label="Next: Plane-Wave Density Functional Theory" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Plane-Wave Density Functional Theory
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.expand", "navigation.top"], "search": "assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
      
    
    
  </body>
</html>