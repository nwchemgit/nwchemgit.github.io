<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://nwchemgit.github.io/ONIOM.html">
  <link rel="shortcut icon" href="img/favicon.ico">
  <title>Hybrid Calculations with ONIOM - NWChem</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="css/theme.css" />
  <link rel="stylesheet" href="css/theme_extra.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Hybrid Calculations with ONIOM";
    var mkdocs_page_input_path = "ONIOM.md";
    var mkdocs_page_url = "/ONIOM.html";
  </script>
  
  <script src="js/jquery-2.1.1.min.js" defer></script>
  <script src="js/modernizr-2.8.3.min.js" defer></script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="." class="icon icon-home"> NWChem</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Home.html">NWChem Manual</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Download.html">How to download and install NWChem</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Quantum-Mechanical-Methods.html">Quantum Mechanical Methods</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Quantum-Molecular-Dynamics.html">Quantum Molecular Dynamics</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Hybrid-Approaches.html">Hybrid Approaches</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Other-Capabilities.html">Other Capabilities</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Examples.html">NWChem Examples</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Compiling-NWChem.html">How to Compile NWChem</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Benchmarks.html">Benchmarks performed with NWChem</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Known-Bugs.html">Known Bugs</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Tutorials.html">NWChem Tutorials</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Forum.html">Forum</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Archived-Forum.html">Archived Forum</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="EMSL_Arrows.html">EMSL Arrows</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Software-supporting-NWChem.html">Software supporting NWChem</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Supplementary-Information.html">Supplementary Information</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Containers.html">Containers</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href=".">NWChem</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".">Docs</a> &raquo;</li>
    
      
    
    <li>Hybrid Calculations with ONIOM</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/nwchemgit/nwchem-wiki/blob/master/ONIOM.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="hybrid-calculations-with-oniom">Hybrid Calculations with ONIOM<a class="headerlink" href="#hybrid-calculations-with-oniom" title="Permanent link">&para;</a></h1>
<p>ONIOM is the hybrid method of Morokuma and co-workers that enables
different levels of theory to be applied to different parts of a
molecule/system and combined to produce a consistent energy expression.
The objective is to perform a high-level calculation on just a small
part of the system and to include the effects of the remainder at lower
levels of theory, with the end result being of similar accuracy to a
high-level calculation on the full system.</p>
<ol>
<li>M. Svensson, S. Humbel, R.D.J. Froese, T. Mastubara, S. Sieber, and
    K. Morokuma, J. Phys. Chem., 100, 19357 (1996).</li>
<li>S. Dapprich, I. Komaromi, K.S. Byun, K. Morokuma, and M.J. Frisch,
    J. Mol. Struct. (Theochem), 461-462, 1 (1999).</li>
<li>R.D.J. Froese and K. Morokuma in &ldquo;Encylopedia of Computational
    Chemistry&rdquo;, volume 2, pp.1244-1257, (ed. P. von Rague Schleyer,
    John Wiley and Sons, Chichester, Sussex, 1998).</li>
</ol>
<p>The NWChem ONIOM module implements two- and three-layer ONIOM models for
use in energy, gradient, geometry optimization, and vibrational
frequency calculations with any of the pure quantum mechanical methods
within NWChem. At the present time, it is not possible to perform ONIOM
calculations with either solvation models or classical force fields. Nor
is it yet possible to compute properties except as derivatives of the
total energy.</p>
<p>Using the terminology of Morokuma et al., the full molecular geometry
including all atoms is referred to as the &ldquo;real&rdquo; geometry and it is
treated using a &ldquo;low&rdquo;-level of theory. A subset of these atoms (referred
to as the &ldquo;model&rdquo; geometry) are treated using both the &ldquo;low&rdquo;-level and a
&ldquo;high&rdquo;-level of theory. A three-layer model also introduces an
&ldquo;intermediate&rdquo; model geometry and a &ldquo;medium&rdquo; level of theory.</p>
<p>The two-layer model requires a high and low level of theory and a real
and model molecular geometry. The energy at the high-level of theory for
the real geometry is estimated as</p>
<pre><code>     E(High,Real) = E(Low,Real) + [E(High,Model) - E(Low,Model)].
</code></pre>
<p>The three-layer model requires high, medium and low levels of theory,
and real, intermediate and model geometries and the corresponding energy
estimate is</p>
<pre><code>     E(High,Real) = E(Low,Real) + [E(High,Model) - E(Medium,Model)]
                    +  [E(Medium,Inter) - E(Low,Inter)].
</code></pre>
<p>When does ONIOM work well? The approximation for a two-layer model will
be good if</p>
<ul>
<li>the model system includes the interactions that dominate the energy
    difference being computed and the high-level of theory describes
    these to the required precision, and</li>
<li>the interactions between the model and the rest of the real system
    (substitution effects) are described to sufficient accuracy at the
    lower level of theory.</li>
</ul>
<p>ONIOM is used to compute energy differences and the absolute energies
are not all that meaningful even though they are well defined. Due to
cancellation of errors, ONIOM actually works better than you might
expect, but a poorly designed calculation can yield very bad results.
Please read and heed the caution at the end of the article by Dapprich
et al.</p>
<p>The input options are as
follows</p>
<pre><code>ONIOM  
  HIGH   &lt;string theory&gt; [basis &lt;string basis default &quot;ao basis&quot;&gt;] \  
                         [ecp &lt;string ecp&gt;] [input &lt;string input&gt;]  
 [MEDIUM &lt;string theory&gt; [basis &lt;string basis default &quot;ao basis&quot;&gt;] \  
                         [ecp &lt;string ecp&gt;] [input &lt;string input&gt;]]  
  LOW    &lt;string theory&gt; [basis &lt;string basis default &quot;ao basis&quot;&gt;] \  
                         [ecp &lt;string ecp&gt;] [input &lt;string input&gt;]  
  MODEL &lt;integer natoms&gt; [charge &lt;double charge&gt;] \  
                         [&lt;integer i1 j1&gt; &lt;real g1&gt; [&lt;string tag1&gt;] ...]  
 [INTER &lt;integer natoms&gt; [charge &lt;double charge&gt;] \  
                         [&lt;integer i1 j1&gt; &lt;real g1&gt; [&lt;string tag1&gt;] ...]]  
 [VECTORS [low-real &lt;string mofile&gt;] [low-model &lt;string mofile&gt;] \  
          [high-model &lt;string mofile&gt;] [medium-model &lt;string mofile]\  
          [medium-inter &lt;string mofile&gt;] [low-inter &lt;string mofile&gt;]]  
 [PRINT ...]  
 [NOPRINT ...]  
END
</code></pre>
<p>which are described in detail below.</p>
<p>For better validation of user input, the HIGH, LOW and MODEL directives
must always be specified. If the one of the MEDIUM or INTER directives
are specified, then so must the other.</p>
<h2 id="real-model-and-intermediate-geometries">Real, model and intermediate geometries<a class="headerlink" href="#real-model-and-intermediate-geometries" title="Permanent link">&para;</a></h2>
<p>The geometry and total charge of the full or real system should be
specified as normal using the <a href="Geometry.html">geometry</a> directive.
If <img alt="$N_{model}$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/e739a8a9732a54838b9b1d5173730d5a.svg?invert_in_darkmode&sanitize=true" align=middle width="48.48327pt" height="22.38192pt"/> of the atoms are to be included in the model system,
then these should be specified first in the geometry. Similarly, in a
three-layer calculation, if there are <img alt="$N_{inter}$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/a0974a9c9e88110489b9327f7d294bd3.svg?invert_in_darkmode&sanitize=true" align=middle width="43.48179pt" height="22.38192pt"/> atoms to be included
in the intermediate system, then these should also be arranged together
at the beginning of the geometry. The implict assumption is that the
model system is a subset of the intermediate system which is a subset of
the real system. The number of atoms to be included in the model and
intemediate systems are specified using the MODEL and INTER directives.
Optionally, the total charge of the model and intermediate systems may
be adjusted. The default is that all three systems have the same total
charge.</p>
<p>Example 1. A two-layer calculation on <img alt="$K^{+}(H_{2}O)$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/12f4155c2cfe5fbf243abc21184651e5.svg?invert_in_darkmode&sanitize=true" align=middle width="72.67227pt" height="26.12412pt"/> taking the
potassium ion as the model system. Note that no bonds are broken so no
link atoms are introduced. The real geometry would be specified with
potassium (the model) first.</p>
<pre><code>   geometry autosym  
     K  0    0.00    1.37  
     O  0    0.00   -1.07  
     H  0   -0.76   -1.68  
     H  0    0.76   -1.68  
   end
</code></pre>
<p>and the following directive in the ONIOM input block indicates that one
atom (implicitly the first in the geometry) is in the model system</p>
<pre><code>   model 1
</code></pre>
<h3 id="link-atoms">Link atoms<a class="headerlink" href="#link-atoms" title="Permanent link">&para;</a></h3>
<p>Link atoms for bonds spanning two regions are automatically generated
from the bond information. The additional parameters on the MODEL and
INTER directives describe the broken bonds including scale factors for
placement of the link atom and, optionally, the type of link atom. The
type of link atom defaults to hydrogen, but any type may be specified
(actually here you are specifying a geometry tag which is used to
associate a <a href="Geometry.html">geometrical center</a> with an atom type
and basis sets, etc. For each broken bond specify the numbers of the two
atoms (i and j), the scale factor (g) and optionally the tag of the link
atom. Link atoms are placed along the vector connecting the the first to
the second atom of the bond according to the equation</p>
<p><img alt="$\underline{R}_{link} = (1-g)\underline{R}_{1} + g*\underline{R}_{2}$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/ef8d3972c822c37484342b86b5ad27ab.svg?invert_in_darkmode&sanitize=true" align=middle width="191.996145pt" height="24.56553pt"/></p>
<p>where <em>g</em> is the scale factor. If the scale factor is one, then the link
atom is placed where the second atom was. More usually, the scale factor
is less than one, in which case the link atom is placed between the
original two atoms. The scale factor should be chosen so that the link
atom (usually hydrogen) is placed near its equilibrium bond length from
the model atom. E.g., when breaking a single carbon-carbon bond (typical
length 1.528 Angstrøms) using a hydrogen link atom we will want a
carbon-hydrogen bond length of about 1.084 Angstrøms, so the scale
factor should be chosen as 1.084/1.528 ~ 0.709.</p>
<p>Example 2. A calculation on acetaldehyde (<img alt="$H_{3}C-CHO$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/9615cbc1d27fcbf805188bee31d14ebc.svg?invert_in_darkmode&sanitize=true" align=middle width="94.68855pt" height="22.38192pt"/>) using aldehyde
(<img alt="$H-CHO$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/413f09d46c9fbfd640a837d6d746520f.svg?invert_in_darkmode&sanitize=true" align=middle width="75.76899pt" height="22.38192pt"/>) as the model system. The covalent bond between the two
carbon atoms is broken and a link atom must be introduced to replace the
methyl group. The link atom is automatically generated &ndash; all you need
to do is specify the atoms in the model system that are also in the real
system (here <img alt="$CHO$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/6437f0894a99729bcbb4f09453b64569.svg?invert_in_darkmode&sanitize=true" align=middle width="40.776615pt" height="22.38192pt"/>) and the broken bonds. Here is the geometry of
acetaldehyde with the <img alt="$CHO$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/6437f0894a99729bcbb4f09453b64569.svg?invert_in_darkmode&sanitize=true" align=middle width="40.776615pt" height="22.38192pt"/> of aldehyde first</p>
<pre><code>   geometry  
     C    -0.383    0.288    0.021  
     H    -1.425    0.381    0.376  
     O     0.259    1.263   -0.321  

     H     0.115   -1.570    1.007  
     H    -0.465   -1.768   -0.642  
     H     1.176   -1.171   -0.352  
     C     0.152   -1.150    0.005  
   end
</code></pre>
<p>There are three atoms (the first three) of the real geometry included in
the model geometry, and we are breaking the bond between atoms 1 and 7,
replacing atom 7 with a hydrogen link atom. This is all accomplished by
the directive</p>
<pre><code>   model 3   1 7 0.709 H
</code></pre>
<p>Since the default link atom is hydrogen there is actually no need to
specify the &ldquo;H&rdquo;.</p>
<p>See also the
<a href="ONIOM.html#a-three-layer-example">ONIOM#a-three-layer-example</a>
for a more complex example.</p>
<h3 id="numbering-of-the-link-atoms">Numbering of the link atoms<a class="headerlink" href="#numbering-of-the-link-atoms" title="Permanent link">&para;</a></h3>
<p>The link atoms are appended to the atoms of the model or intermediate
systems in the order that the broken bonds are specified in the input.
This is of importance only if manually constructing an initial guess.</p>
<h2 id="high-medium-and-low-theories">High, medium and low theories<a class="headerlink" href="#high-medium-and-low-theories" title="Permanent link">&para;</a></h2>
<p>The two-layer model requires both the high-level and low-level theories
be specified. The three-layer model also requires the medium-level
theory. Each of these includes a theory (such as SCF, MP2, DFT, CCSD,
CCSD(T), etc.), an optional basis set, an optional ECP, and an optional
string containing general NWChem input.</p>
<h3 id="basis-specification">Basis specification<a class="headerlink" href="#basis-specification" title="Permanent link">&para;</a></h3>
<p>The basis name on the theory directive (high, medium, or low) is that
specified on a basis set directive (see Section 7) and not the name of a
standard basis in the library. If not specified, the basis set for the
high-level theory defaults to the standard &ldquo;ao basis&rdquo;. That for the
medium level defaults to the high-level basis, and the low-level basis
defaults to the medium-level basis. Other wavefunction parameters are
obtained from the standard wavefunction input blocks. See <a href="#effective-core-potential">Effective
core potential</a> for an example.</p>
<h3 id="effective-core-potentials">Effective core potentials<a class="headerlink" href="#effective-core-potentials" title="Permanent link">&para;</a></h3>
<p>If an <a href="ECP.html">effective core potential</a> is specified in the
usual fashion outside of the ONIOM input then this will be used in all
calculations. If an alternative ECP name (the name specified on the ECP
directive in the same manner as done for basis sets) is specified on one
of the theory directives, then this ECP will be used in preference for
that level of theory. See the
<a href="ONIOM.html#a-three-layer-example">ONIOM#a-three-layer-example</a>
for sample input.</p>
<h3 id="general-input-strings">General input strings<a class="headerlink" href="#general-input-strings" title="Permanent link">&para;</a></h3>
<p>For many purposes, the ability to specify the theory, basis and
effective core potential is adequate. All of the options for each theory
are determined from their independent input blocks. However, if the same
theory (e.g., DFT) is to be used with different options for the ONIOM
theoretical models, then the general input strings must be used. These
strings are processed as NWChem input each time the theoretical model is
invoked. The strings may contain any NWChem input, except for options
pertaining to ONIOM and the task directive. The intent that the strings
be used just to control the options pertaining to the theory being used.</p>
<p>A word of caution. Be sure to check that the options are producing the
desired results. Since the NWChem database is persistent and the ONIOM
calculations happen in an undefined order, the input strings should
fully define the calculation you wish to have happen.</p>
<p>For instance, if the high model is DFT/B3LYP/6-311g** and the low
model is DFT/LDA/3-21g, the ONIOM input might look like this</p>
<pre><code>   oniom  
     model 3  
     low  dft basis 3-21g    input &quot;dft; xc; end&quot;  
     high dft basis 6-311g** input &quot;dft; xc b3lyp; end&quot;  
   end
</code></pre>
<p>The empty XC directive restores the default LDA exchange-correlation
option (see Section 11.3). Note that semi-colons and other quotation
marks inside the input string must be preceded by a backslash to avoid
special interpretation.</p>
<p>See <a href="#dft-with-and-without-charge-fitting">|DFT with and without charge
fitting</a> for another
example.</p>
<h2 id="use-of-symmetry">Use of symmetry<a class="headerlink" href="#use-of-symmetry" title="Permanent link">&para;</a></h2>
<p>Symmetry should work just fine as long as the model and intermediate
regions respect the symmetry &ndash; i.e., symmetry equivalent atoms need to
be treated equivalently. If symmetry equivalent atoms must be treated in
separate regions then the symmetry must be lowered (or completely
switched off).</p>
<h2 id="molecular-orbital-files">Molecular orbital files<a class="headerlink" href="#molecular-orbital-files" title="Permanent link">&para;</a></h2>
<p>The VECTORS directive in the ONIOM block is different to that elsewhere
in NWChem. For each of the necessary combinations of theory and geometry
you can specify a different file for the molecular orbitals. By default
each combination will store the MO vectors in the permanent directory
using a file name created by appending to the name of the calculation
the following string</p>
<ul>
<li>low-real &ndash; &ldquo;.lrmos&rdquo;</li>
<li>low-inter &ndash; &ldquo;.limos&rdquo;</li>
<li>low-model &ndash; &ldquo;.lmmos&rdquo;</li>
<li>medium-inter &ndash; &ldquo;.mimos&rdquo;</li>
<li>medium-model &ndash; &ldquo;.mmmos&rdquo;</li>
<li>high-model &ndash; &ldquo;.hmmos&rdquo;</li>
</ul>
<p>Each calculation will utilize the appropriate vectors which is more
efficient during geometry optimizations and frequency calculations, and
is also useful for the initial calculation. In the absence of existing
MO vectors files, the default atomic guess is used (see
<a href="Hartree-Fock-Theory-for-Molecules.html#vectors-inputoutput-of-mo-vectors">|Input/output of MO vectors</a>).</p>
<p>If special measures must be taken to converge the initial SCF, DFT or
MCSCF calculation for one or more of the systems, then initial vectors
may be saved in a file with the default name, or another name may be
specified using the VECTORS directive. Note that subsequent vectors
(e.g., from a geometry optimization) will be written back to this file,
so take a copy if you wish to preserve it. To generate the initial guess
for the model or intermediate systems it is necessary to generate the
geometries which is most readily done, if there are link atoms, by just
running NWChem on the input for the ONIOM calculation on your
workstation. It will print these geometries before starting any
calculations which you can then terminate.</p>
<p>E.g., in a calculation on Fe(III) surrounded by some ligands, it is hard
to converge the full (real) system from the atomic guess so as to obtain
a <img alt="$d^5$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/81701ee85f8bb9d3d7757e8fb5463c7e.svg?invert_in_darkmode&sanitize=true" align=middle width="15.052125pt" height="26.70657pt"/> configuration for the iron atom since the <em>d</em> orbitals are
often nominally lower in energy than some of the ligand orbitals. The
most effective mechanism is to converge the isolated Fe(III) and then to
use the <a href="Hartree-Fock-Theory-for-Molecules.html#superposition-of-fragment-molecular-orbitals">fragment
guess</a>
as a starting guess for the real system. The resulting converged
molecular orbitals can be saved either with the default name (as
described above in this section), in which case no additional input is
necessary. If an alternative name is desired, then the VECTORS directive
may be used as follows</p>
<pre><code>   vectors low-real /u/rjh/jobs/fe_ether_water.mos
</code></pre>
<h2 id="restarting">Restarting<a class="headerlink" href="#restarting" title="Permanent link">&para;</a></h2>
<p>Restart of ONIOM calculations does not currently work as smoothly as we
would like. For geometry optimizations that terminated gracefully by
running out of iterations, the restart will work as normal. Otherwise,
specify in the input of the restart job the last geometry of the
optimization. The Hessian information will be reused and the calculation
should proceed losing at most the cost of one ONIOM gradient evaluation.
For energy or frequency calculations, restart may not currently be
possible.</p>
<h2 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h2>
<h3 id="hydrocarbon-bond-energy">Hydrocarbon bond energy<a class="headerlink" href="#hydrocarbon-bond-energy" title="Permanent link">&para;</a></h3>
<p>A simple two-layer model changing just the wavefunction with one link
atom.</p>
<p>This reproduces the two-layer ONIOM (MP2:HF) result from Dapprich et al.
for the reaction <img alt="$R-CH_{3} = R-CH_{2} + H$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/9941ef20af8e4f201893a098776e7617.svg?invert_in_darkmode&sanitize=true" align=middle width="189.804945pt" height="22.38192pt"/> with <img alt="$R=CH_3$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/105147afab9baf8d8264b1624bf3eeee.svg?invert_in_darkmode&sanitize=true" align=middle width="67.45398pt" height="22.38192pt"/> using
<img alt="$CH_4$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/ae893ddc6a1df993f14669218c18b5e1.svg?invert_in_darkmode&sanitize=true" align=middle width="33.022275pt" height="22.38192pt"/> as the model. The geometries of <img alt="$R-CH_3$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/19809976b707de2a4a0c5e682e945a0e.svg?invert_in_darkmode&sanitize=true" align=middle width="65.62743pt" height="22.38192pt"/> and <img alt="$R-CH_2$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/930cb353b2d97e89745a01f4068b1d8d.svg?invert_in_darkmode&sanitize=true" align=middle width="65.62743pt" height="22.38192pt"/> are
optimized at the DFT-B3LYP/6-311++G** level of theory, and then ONIOM
is used to compute the binding energy using UMP2 for the model system
and HF for the real system. The results, including MP2 calculations on
the full system for comparison, are as given in the table
below.</p>
<p><center></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Theory</td>
<td>Me-CH2</td>
<td>Me-Me</td>
<td>H</td>
<td>De(Hartree)</td>
<td>De(kcal/mol)</td>
</tr>
<tr>
<td>B3LYP</td>
<td>-79.185062</td>
<td>-79.856575</td>
<td>-0.502256</td>
<td>0.169257</td>
<td>106.2</td>
</tr>
<tr>
<td>HF</td>
<td>-78.620141</td>
<td>-79.251701</td>
<td>-0.499817</td>
<td>0.131741</td>
<td>82.7</td>
</tr>
<tr>
<td>MP2</td>
<td>-78.904716</td>
<td>-79.571654</td>
<td>-0.499817</td>
<td>0.167120</td>
<td>104.9</td>
</tr>
<tr>
<td>MP2:HF</td>
<td>-78.755223</td>
<td>-79.422559</td>
<td>-0.499817</td>
<td>0.167518</td>
<td>105.1</td>
</tr>
</tbody>
</table>
<p>Energies for ONIOM example 1, hydrocarbon bond energy using MP2:HF
two-layer model.</p>
<p></center></p>
<p>The following input first performs a calculation on <img alt="$CH_{3}-CH_2$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/0a3697ccc48b9f13c6a21bc7897138f2.svg?invert_in_darkmode&sanitize=true" align=middle width="86.93421pt" height="22.38192pt"/>, and
then on <img alt="$CH_{3}-CH_3$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/110844c6b36dfb26d1dabe5db2aea198.svg?invert_in_darkmode&sanitize=true" align=middle width="86.93421pt" height="22.38192pt"/>. Note that in the second calculation we cannot
use the full symmetry since we are breaking the C-C bond in forming the
model system (the non-equivalence of the methyl groups is perhaps more
apparent if we write
<img alt="$R-CH_3$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/19809976b707de2a4a0c5e682e945a0e.svg?invert_in_darkmode&sanitize=true" align=middle width="65.62743pt" height="22.38192pt"/>).</p>
<pre><code>   start  

   basis spherical  
     H library 6-311++G**; C library 6-311++G**  
   end  

   title &quot;ONIOM Me-CH2&quot;  

   geometry autosym  
     H    -0.23429328     1.32498565     0.92634814  
     H    -0.23429328     1.32498565    -0.92634814  
     C    -0.13064265     0.77330370     0.00000000  
     H    -1.01618703    -1.19260361     0.00000000  
     H     0.49856072    -1.08196901    -0.88665533  
     H     0.49856072    -1.08196901     0.88665533  
     C    -0.02434414    -0.71063687     0.00000000  
   end  

   scf; uhf; doublet; thresh 1e-6; end  
   mp2; freeze atomic; end  

   oniom  
     high mp2  
     low  scf  
     model 3   3 7 0.724  
   end  

   task oniom  

   title &quot;ONIOM Me-Me&quot;  

   geometry   # Note cannot use full D3D symmetry here, either specify noautosym, or change an atom tag (here C -&gt; C1)  
     H   -0.72023641     0.72023641    -1.16373235  
     H    0.98386124     0.26362482    -1.16373235  
     H   -0.26362482    -0.98386124    -1.16373235  
     C    0.00000000     0.00000000    -0.76537515  
     H    0.72023641    -0.72023641     1.16373235  
     H   -0.98386124    -0.26362482     1.16373235  
     H    0.26362482     0.98386124     1.16373235  
     C1   0.00000000     0.00000000     0.76537515  
   end  

   scf; rhf; singlet; end  

   oniom  
     high mp2  
     low  scf  
     model 4   4 8 0.724  
   end  

   task oniom
</code></pre>
<h3 id="optimization-and-frequencies">Optimization and frequencies<a class="headerlink" href="#optimization-and-frequencies" title="Permanent link">&para;</a></h3>
<p>A two-layer model including modification of theory, basis, ECP and total
charge and no link atoms.</p>
<p>This input reproduces the ONIOM optimization and vibrational frequency
calculation of <img alt="$Rh(CO)_{2}Cp$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/8f6c655d6daa3150f91c0db87db43609.svg?invert_in_darkmode&sanitize=true" align=middle width="89.05941pt" height="24.56553pt"/> of Dapprich et al. The model system is
<img alt="$Rh(CO)_{2}^{+}$" src="https://raw.githubusercontent.com/wiki/nwchemgit/nwchem/svgs/4689fc1148533f4fb945fc3e4de82f91.svg?invert_in_darkmode&sanitize=true" align=middle width="70.61835pt" height="28.25757pt"/>. The low theory is the Gaussian LANL2MB model
(Hay-Wadt n+1 ECP with minimal basis on Rh, STO-3G on others) with SCF.
The high theory is the Gaussian LANL2DZ model (another Hay-Wadt ECP with
a DZ basis set on Rh, Dunning split valence on the other atoms) with
DFT/B3LYP. Note that different names should be used for the basis set
and ECP since the same mechanism is used to store them in the
database.</p>
<pre><code>   start  

   ecp LANL2DZ_ECP  
     rh library LANL2DZ_ECP  
   end  

   basis LANL2DZ spherical  
     rh library LANL2DZ_ECP  
     o library SV_(Dunning-Hay); c library SV_(Dunning-Hay); h library SV_(Dunning-Hay)  
   end  

   ecp Hay-Wadt_MB_(n+1)_ECP  
     rh library Hay-Wadt_MB_(n+1)_ECP  
   end  

   # This is the minimal basis used by Gaussian.  It is not the same   
   # as the one in the EMSL basis set library for this ECP.  
   basis Hay-Wadt_MB_(n+1) spherical   
     Rh s; .264600D+01 -.135541D+01; .175100D+01  .161122D+01; .571300D+00  .589381D+00  
     Rh s; .264600D+01  .456934D+00; .175100D+01 -.595199D+00; .571300D+00 -.342127D+00  
           .143800D+00  .410138D+00; .428000D-01  .780486D+00  
     Rh p; .544000D+01 -.987699D-01; .132900D+01  .743359D+00; .484500D+00  .366846D+00  
     Rh p; .659500D+00 -.370046D-01; .869000D-01  .452364D+00; .257000D-01  .653822D+00  
     Rh d; .366900D+01  .670480D-01; .142300D+01  .455084D+00; .509100D+00  .479584D+00  
           .161000D+00  .233826D+00  
     o  library sto-3g; c  library sto-3g; h  library sto-3g  
   end  

   charge 0  
   geometry autosym  
     rh       0.00445705    -0.15119674     0.00000000  
     c       -0.01380554    -1.45254070     1.35171818  
     c       -0.01380554    -1.45254070    -1.35171818  
     o       -0.01805883    -2.26420212     2.20818932  
     o       -0.01805883    -2.26420212    -2.20818932  
     c        1.23209566     1.89314720     0.00000000  
     c        0.37739392     1.84262319    -1.15286640  
     c       -1.01479160     1.93086461    -0.70666350  
     c       -1.01479160     1.93086461     0.70666350  
     c        0.37739392     1.84262319     1.15286640  
     h        2.31251453     1.89903673     0.00000000  
     h        0.70378132     1.86131979    -2.18414218  
     h       -1.88154273     1.96919306    -1.35203550  
     h       -1.88154273     1.96919306     1.35203550  
     h        0.70378132     1.86131979     2.18414218  
   end  

   dft; grid fine; convergence gradient 1e-6 density 1e-6; xc b3lyp; end  
   scf; thresh 1e-6; end  

   oniom  
     low scf basis Hay-Wadt_MB_(n+1) ecp  Hay-Wadt_MB_(n+1)_ECP  
     high dft basis LANL2DZ ecp LANL2DZ_ECP  
     model 5 charge 1  
     print low  
   end  

   task oniom optimize  
   task oniom freq
</code></pre>
<h3 id="a-three-layer-example">A three-layer example<a class="headerlink" href="#a-three-layer-example" title="Permanent link">&para;</a></h3>
<p>A three layer example combining CCSD(T), and MP2 with two different
quality basis sets, and using multiple link atoms.</p>
<p>The full system is tetra-dimethyl-amino-ethylene (TAME) or
(N(Me)2)2-C=C-(N(Me)2)2. The intermediate system is (NH2)2-C=C-(NH2)2
and H2C=CH2 is the model system. CCSD(T)+aug-cc-pvtz is used for the
model region, MP2+aug-cc-pvtz for the intermediate region, and
MP2+aug-cc-pvdz for everything.</p>
<p>In the real geometry the first two atoms (C, C) are the model system
(link atoms will be added automatically). The first six atoms (C, C, N,
N, N, N) describe the intermediate system (again with link atoms to be
added automatically). The atoms have been numbered using comments to
make the bonding input easier to generate.</p>
<p>To make the model system, four C-N bonds are broken between the ethylene
fragment and the dimethyl-amino groups and replaced with C-H bonds. To
make the intermediate system, eight C-N bonds are broken between the
nitrogens and the methyl groups and replaced with N-H bonds. The scaling
factor could be chosen differently for each of the bonds.</p>
<pre><code>   start   

   geometry   
     C  0.40337795 -0.17516305 -0.51505208  # 1  
     C -0.40328664  0.17555927  0.51466084  # 2  
     N  1.87154979 -0.17516305 -0.51505208  # 3  
     N -0.18694782 -0.60488524 -1.79258692  # 4  
     N  0.18692927  0.60488318  1.79247594  # 5  
     N -1.87148219  0.17564718  0.51496494  # 6  
     C  2.46636552  1.18039452 -0.51505208  # 7  
     C  2.48067731 -1.10425355  0.46161675  # 8  
     C -2.46642715 -1.17982091  0.51473105  # 9  
     C -2.48054940  1.10495864 -0.46156202  # 10  
     C  0.30027136  0.14582197 -2.97072148  # 11  
     C -0.14245927 -2.07576980 -1.96730852  # 12  
     C -0.29948109 -0.14689874  2.97021079  # 13  
     C  0.14140463  2.07558249  1.96815181  # 14  
     H  0.78955302  2.52533887  1.19760764  
     H -0.86543435  2.50958894  1.88075113  
     ... and 22 other hydrogen atoms on the methyl groups  
   end  

   basis aug-cc-pvtz spherical  
     C library aug-cc-pvtz; H library aug-cc-pvtz  
   end  

   basis aug-cc-pvdz spherical  
     C library aug-cc-pvtz; H library aug-cc-pvtz  
   end  

   oniom        
     high ccsd(t) basis aug-cc-pvtz  
     medium mp2 basis aug-cc-pvtz  
     low mp2 basis aug-cc-pvdz  
     model 2   1 3  0.87   1 4  0.87   2 5  0.87   2 6  0.87  

     inter 6   3 7  0.69   3 8  0.69   4 11 0.69   4 12 0.69 \  
               5 13 0.69   5 14 0.69   6 9  0.69   6 10 0.69  
   end  

   task oniom
</code></pre>
<h3 id="dft-with-and-without-charge-fitting">DFT with and without charge fitting<a class="headerlink" href="#dft-with-and-without-charge-fitting" title="Permanent link">&para;</a></h3>
<p>Demonstrates use of general input strings.</p>
<p>A two-layer model for anthracene (a linear chain of three fused benzene
rings) using benzene as the model system. The high-level theory is
DFT/B3LYP/TZVP with exact Coulomb. The low level is DFT/LDA/DZVP2 with
charge fitting.</p>
<p>Note the following.</p>
<ol>
<li>The semi-colons and quotation marks inside the input string must be
    quoted with backslash.</li>
<li>The low level of theory sets the fitting basis set and the high
    level of theory unsets it.  </li>
</ol>
<pre><code>   start  
   geometry   
     symmetry d2h  
     C    0.71237329    -1.21458940     0.0  
     C   -0.71237329    -1.21458940     0.0  
     C    0.71237329     1.21458940     0.0  
     C   -0.71237329     1.21458940     0.0  
     C   -1.39414269     0.00000000     0.0  
     C    1.39414269     0.00000000     0.0  
     H   -2.47680865     0.00000000     0.0  
     H    2.47680865     0.00000000     0.0  
     C    1.40340535    -2.48997027     0.0  
     C   -1.40340535    -2.48997027     0.0  
     C    1.40340535     2.48997027     0.0  
     C   -1.40340535     2.48997027     0.0  
     C    0.72211503     3.64518615     0.0  
     C   -0.72211503     3.64518615     0.0  
     C    0.72211503    -3.64518615     0.0  
     C   -0.72211503    -3.64518615     0.0  
     H    2.48612947     2.48094825     0.0  
     H    1.24157357     4.59507342     0.0  
     H   -1.24157357     4.59507342     0.0  
     H   -2.48612947     2.48094825     0.0  
     H    2.48612947    -2.48094825     0.0  
     H    1.24157357    -4.59507342     0.0  
     H   -1.24157357    -4.59507342     0.0  
     H   -2.48612947    -2.48094825     0.0  
   end  

   basis small  
     h library DZVP_(DFT_Orbital)  
     c library DZVP_(DFT_Orbital)  
   end  

   basis fitting  
     h library DGauss_A1_DFT_Coulomb_Fitting  
     c library DGauss_A1_DFT_Coulomb_Fitting  
   end  

   basis big  
     h library TZVP_(DFT_Orbital)  
     c library TZVP_(DFT_Orbital)  
   end  

   oniom  
     model 8   1 9 0.75   2 10 0.75   3 11 0.75   4 12 0.75  
     high dft basis big   input &quot;unset &quot;cd basis&quot;; dft; xc b3lyp; end&quot;  
     low  dft basis small input &quot;set &quot;cd basis&quot; fitting; dft; xc; end&quot;  
   end  

   task oniom
</code></pre>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/nwchemgit/nwchem-wiki/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
    
  </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme_extra.js" defer></script>
    <script src="js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
