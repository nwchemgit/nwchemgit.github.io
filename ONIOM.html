
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="NWChem Website">
      
      
      
        <link rel="canonical" href="https://nwchemgit.github.io/ONIOM.html">
      
      
        <link rel="prev" href="VEM-Model.html">
      
      
        <link rel="next" href="qmmm_introduction.html">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.3">
    
    
      
        <title>Hybrid Calculations with ONIOM - NWChem</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.6b71719e.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Lato";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#hybrid-calculations-with-oniom" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="NWChem" class="md-header__button md-logo" aria-label="NWChem" data-md-component="logo">
      
  <img src="assets/MS3logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NWChem
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Hybrid Calculations with ONIOM
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/nwchemgit/nwchem-wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="NWChem" class="md-nav__button md-logo" aria-label="NWChem" data-md-component="logo">
      
  <img src="assets/MS3logo.png" alt="logo">

    </a>
    NWChem
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nwchemgit/nwchem-wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Home.html" class="md-nav__link">
        NWChem Manual
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" tabindex="0" aria-expanded="false">
          How to get NWChem
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="How to get NWChem" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          How to get NWChem
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Download.html" class="md-nav__link">
        How to download and install NWChem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Compiling-NWChem.html" class="md-nav__link">
        Compiling NWChem from source
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" tabindex="0" aria-expanded="false">
          Introduction 
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Introduction " data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Introduction 
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Getting-Started.html" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="NWChem-Architecture.html" class="md-nav__link">
        NWChem Architecture
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Capabilities.html" class="md-nav__link">
        Functionalities
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Top-level.html" class="md-nav__link">
        Top-level Directives
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Geometry.html" class="md-nav__link">
        Geometries
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Basis.html" class="md-nav__link">
        Basis sets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="ECP.html" class="md-nav__link">
        Effective Core Potentials
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Relativistic-All-electron-Approximations.html" class="md-nav__link">
        Relativistic all-electron approximations
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_10" tabindex="0" aria-expanded="false">
          Quantum-Mechanical-Methods
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Quantum-Mechanical-Methods" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Quantum-Mechanical-Methods
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Hartree-Fock-Theory-for-Molecules.html" class="md-nav__link">
        Hartree-Fock
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Density-Functional-Theory-for-Molecules.html" class="md-nav__link">
        Density Functional Theory (DFT)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Excited-State-Calculations.html" class="md-nav__link">
        CIS, TDHF, TDDFT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="RT-TDDFT.html" class="md-nav__link">
        Real-time TDDFT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Plane-Wave-Density-Functional-Theory.html" class="md-nav__link">
        Plane-Wave Density Functional Theory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="TCE.html" class="md-nav__link">
        Tensor Contraction Engine Module: CI, MBPT, and CC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="MP2.html" class="md-nav__link">
        MP2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="CCSD.html" class="md-nav__link">
        Coupled Cluster Calculations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Multiconfiguration_SCF.html" class="md-nav__link">
        MCSCF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="GW.html" class="md-nav__link">
        Molecular GW
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_11" tabindex="0" aria-expanded="false">
          Quantum Molecular Dynamics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Quantum Molecular Dynamics" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Quantum Molecular Dynamics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Plane-Wave-Density-Functional-Theory.html" class="md-nav__link">
        Plane-Wave Density Functional Theory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Gaussian-Basis-AIMD.html" class="md-nav__link">
        Gaussian Basis AIMD
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_12" type="checkbox" id="__nav_12" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_12" tabindex="0" aria-expanded="true">
          Hybrid Approaches
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Hybrid Approaches" data-md-level="1">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          Hybrid Approaches
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="COSMO-Solvation-Model.html" class="md-nav__link">
        COSMO Solvation Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="SMD-Model.html" class="md-nav__link">
        SMD (Solvation Model Based on Density) Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="VEM-Model.html" class="md-nav__link">
        VEM (Vertical Excitation or Emission) Model
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Hybrid Calculations with ONIOM
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="ONIOM.html" class="md-nav__link md-nav__link--active">
        Hybrid Calculations with ONIOM
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-model-and-intermediate-geometries" class="md-nav__link">
    Real, model and intermediate geometries
  </a>
  
    <nav class="md-nav" aria-label="Real, model and intermediate geometries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#link-atoms" class="md-nav__link">
    Link atoms
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#numbering-of-the-link-atoms" class="md-nav__link">
    Numbering of the link atoms
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#high-medium-and-low-theories" class="md-nav__link">
    High, medium and low theories
  </a>
  
    <nav class="md-nav" aria-label="High, medium and low theories">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basis-specification" class="md-nav__link">
    Basis specification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#effective-core-potentials" class="md-nav__link">
    Effective core potentials
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#general-input-strings" class="md-nav__link">
    General input strings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-of-symmetry" class="md-nav__link">
    Use of symmetry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#molecular-orbital-files" class="md-nav__link">
    Molecular orbital files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restarting" class="md-nav__link">
    Restarting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydrocarbon-bond-energy" class="md-nav__link">
    Hydrocarbon bond energy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimization-and-frequencies" class="md-nav__link">
    Optimization and frequencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-three-layer-example" class="md-nav__link">
    A three-layer example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dft-with-and-without-charge-fitting" class="md-nav__link">
    DFT with and without charge fitting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_12_5" type="checkbox" id="__nav_12_5" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_12_5" tabindex="0" aria-expanded="false">
          QMMM
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="QMMM" data-md-level="2">
        <label class="md-nav__title" for="__nav_12_5">
          <span class="md-nav__icon md-icon"></span>
          QMMM
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="qmmm_introduction.html" class="md-nav__link">
        QMMM Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM.html" class="md-nav__link">
        QMMM table of contents
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_12_5_3" type="checkbox" id="__nav_12_5_3" >
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_12_5_3" tabindex="0" aria-expanded="false">
          QMMM Restart and Topology Files
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="QMMM Restart and Topology Files" data-md-level="3">
        <label class="md-nav__title" for="__nav_12_5_3">
          <span class="md-nav__icon md-icon"></span>
          QMMM Restart and Topology Files
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Restart_and_Topology_Files.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Preparation_Prerequisites.html" class="md-nav__link">
        QMMM Preparation Prerequisites
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_preparation_basic.html" class="md-nav__link">
        Qmmm preparation basic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_preparation_solvation.html" class="md-nav__link">
        Qmmm preparation solvation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_preparation_constraints.html" class="md-nav__link">
        Qmmm preparation constraints
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_12_5_4" type="checkbox" id="__nav_12_5_4" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_12_5_4" tabindex="0" aria-expanded="false">
          QMMM Input File
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="QMMM Input File" data-md-level="3">
        <label class="md-nav__title" for="__nav_12_5_4">
          <span class="md-nav__icon md-icon"></span>
          QMMM Input File
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Input_File.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_QM_Parameters.html" class="md-nav__link">
        QM_Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_MM_Parameters.html" class="md-nav__link">
        QMMM MM Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_QMMM_Parameters.html" class="md-nav__link">
        QM/MM parameters
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_12_5_5" type="checkbox" id="__nav_12_5_5" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_12_5_5" tabindex="0" aria-expanded="false">
          QMMMM Single Point Calculations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="QMMMM Single Point Calculations" data-md-level="3">
        <label class="md-nav__title" for="__nav_12_5_5">
          <span class="md-nav__icon md-icon"></span>
          QMMMM Single Point Calculations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="qmmm_sp_energy.html" class="md-nav__link">
        QMMM Ground State Energy and Gradient
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Excited_States.html" class="md-nav__link">
        QMMM Excited State Energy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="qmmm_sp_property.html" class="md-nav__link">
        QMMM Properties
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_ESP.html" class="md-nav__link">
        QMMM ESP Charge Analysis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_12_5_6" type="checkbox" id="__nav_12_5_6" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_12_5_6" tabindex="0" aria-expanded="false">
          QMMM Potential Energy Surface Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="QMMM Potential Energy Surface Analysis" data-md-level="3">
        <label class="md-nav__title" for="__nav_12_5_6">
          <span class="md-nav__icon md-icon"></span>
          QMMM Potential Energy Surface Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_optimization.html" class="md-nav__link">
        QMMM Optimization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Transition_States.html" class="md-nav__link">
        QMMM Transition States
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_freq.html" class="md-nav__link">
        QMMM Hessians and Frequency
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_NEB_Calculations.html" class="md-nav__link">
        QMMM Reaction Pathway Calculations with NEB
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Dynamics.html" class="md-nav__link">
        QMMM Dynamics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Free_Energy.html" class="md-nav__link">
        QMMM Free Energy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Appendix.html" class="md-nav__link">
        QMMM Apppendix
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Bq.html" class="md-nav__link">
        Point charges
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="1D-RISM.html" class="md-nav__link">
        1-D RISM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_13" type="checkbox" id="__nav_13" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_13" tabindex="0" aria-expanded="false">
          Potential Energy Surface Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Potential Energy Surface Analysis" data-md-level="1">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          Potential Energy Surface Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Geometry-Optimization.html" class="md-nav__link">
        Geometry Optimization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Hessians-and-Vibrational-Frequencies.html" class="md-nav__link">
        Hessians
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Constraints.html" class="md-nav__link">
        Constraints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Nudged-Elastic-Band-and-Zero-Temperature-String-Methods.html" class="md-nav__link">
        Nudged Elastic Band (NEB) method
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_14" type="checkbox" id="__nav_14" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_14" tabindex="0" aria-expanded="false">
          Electronic Structure Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Electronic Structure Analysis" data-md-level="1">
        <label class="md-nav__title" for="__nav_14">
          <span class="md-nav__icon md-icon"></span>
          Electronic Structure Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Properties.html" class="md-nav__link">
        Properties
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ESP.html" class="md-nav__link">
        Electrostatic potentials
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="DPLOT.html" class="md-nav__link">
        DPLOT
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_15" type="checkbox" id="__nav_15" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_15" tabindex="0" aria-expanded="false">
          Other-Capabilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Other-Capabilities" data-md-level="1">
        <label class="md-nav__title" for="__nav_15">
          <span class="md-nav__icon md-icon"></span>
          Other-Capabilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Electron-Transfer.html" class="md-nav__link">
        Electron Transfer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Python.html" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Quantum.html" class="md-nav__link">
        Quantum
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="VSCF.html" class="md-nav__link">
        Vibrational SCF (VSCF)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="CCCA_method.html" class="md-nav__link">
        Correlation consistent Composite Approach (ccCA)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Interface.html" class="md-nav__link">
        Interfaces to Other Programs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_16" type="checkbox" id="__nav_16" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_16" tabindex="0" aria-expanded="false">
          Molecular Mechanics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Molecular Mechanics" data-md-level="1">
        <label class="md-nav__title" for="__nav_16">
          <span class="md-nav__icon md-icon"></span>
          Molecular Mechanics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Prepare.html" class="md-nav__link">
        Prepare
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="MD.html" class="md-nav__link">
        MD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Analysis.html" class="md-nav__link">
        Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Format_of_MD_Files.html" class="md-nav__link">
        Format of MD files
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Python.html" class="md-nav__link">
        Controlling NWChem with Python
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_18" type="checkbox" id="__nav_18" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_18" tabindex="0" aria-expanded="false">
          NWChem Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="NWChem Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_18">
          <span class="md-nav__icon md-icon"></span>
          NWChem Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Sample.html" class="md-nav__link">
        Sample input files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Geometry-examples.html" class="md-nav__link">
        Examples of geometries using symmetry
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Benchmarks.html" class="md-nav__link">
        Benchmarks performed with NWChem
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Known-Bugs.html" class="md-nav__link">
        Known Bugs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="FAQ.html" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Tutorials.html" class="md-nav__link">
        NWChem Tutorials
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Forum.html" class="md-nav__link">
        Forum
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Archived-Forum.html" class="md-nav__link">
        Archived Forum
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="EMSL_Arrows.html" class="md-nav__link">
        EMSL Arrows
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_26" type="checkbox" id="__nav_26" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_26" tabindex="0" aria-expanded="false">
          Supplementary Information
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Supplementary Information" data-md-level="1">
        <label class="md-nav__title" for="__nav_26">
          <span class="md-nav__icon md-icon"></span>
          Supplementary Information
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://hpc.pnl.gov/globalarrays/" class="md-nav__link">
        Global Arrays
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ARMCI.html" class="md-nav__link">
        Choosing the ARMCI Library
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Interfaces-with-External-Software.html" class="md-nav__link">
        Interfaces with External Software
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Software-supporting-NWChem.html" class="md-nav__link">
        Software supporting NWChem
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Containers.html" class="md-nav__link">
        Containers
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://nwchemgit.github.io/nwchemusermanual.pdf" class="md-nav__link">
        Documentation in PDF format
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-model-and-intermediate-geometries" class="md-nav__link">
    Real, model and intermediate geometries
  </a>
  
    <nav class="md-nav" aria-label="Real, model and intermediate geometries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#link-atoms" class="md-nav__link">
    Link atoms
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#numbering-of-the-link-atoms" class="md-nav__link">
    Numbering of the link atoms
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#high-medium-and-low-theories" class="md-nav__link">
    High, medium and low theories
  </a>
  
    <nav class="md-nav" aria-label="High, medium and low theories">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basis-specification" class="md-nav__link">
    Basis specification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#effective-core-potentials" class="md-nav__link">
    Effective core potentials
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#general-input-strings" class="md-nav__link">
    General input strings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-of-symmetry" class="md-nav__link">
    Use of symmetry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#molecular-orbital-files" class="md-nav__link">
    Molecular orbital files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restarting" class="md-nav__link">
    Restarting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hydrocarbon-bond-energy" class="md-nav__link">
    Hydrocarbon bond energy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimization-and-frequencies" class="md-nav__link">
    Optimization and frequencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-three-layer-example" class="md-nav__link">
    A three-layer example
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dft-with-and-without-charge-fitting" class="md-nav__link">
    DFT with and without charge fitting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/nwchemgit/nwchem-wiki/edit/master/ONIOM.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/nwchemgit/nwchem-wiki/raw/master/ONIOM.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5Z"/></svg>
    </a>
  



<h1 id="hybrid-calculations-with-oniom">Hybrid Calculations with ONIOM<a class="headerlink" href="#hybrid-calculations-with-oniom" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>ONIOM is the hybrid method of Morokuma and co-workers that enables
different levels of theory to be applied to different parts of a
molecule/system and combined to produce a consistent energy expression.
The objective is to perform a high-level calculation on just a small
part of the system and to include the effects of the remainder at lower
levels of theory, with the end result being of similar accuracy to a
high-level calculation on the full system.</p>
<ol>
<li>M. Svensson, S. Humbel, R.D.J. Froese, T. Mastubara, S. Sieber, and
    K. Morokuma, J. Phys. Chem., 100, 19357 (1996).</li>
<li>S. Dapprich, I. Komaromi, K.S. Byun, K. Morokuma, and M.J. Frisch,
    J. Mol. Struct. (Theochem), 461-462, 1 (1999).</li>
<li>R.D.J. Froese and K. Morokuma in &ldquo;Encylopedia of Computational
    Chemistry&rdquo;, volume 2, pp.1244-1257, (ed. P. von Rague Schleyer,
    John Wiley and Sons, Chichester, Sussex, 1998).</li>
</ol>
<p>The NWChem ONIOM module implements two- and three-layer ONIOM models for
use in energy, gradient, geometry optimization, and vibrational
frequency calculations with any of the pure quantum mechanical methods
within NWChem. At the present time, it is not possible to perform ONIOM
calculations with either solvation models or classical force fields. Nor
is it yet possible to compute properties except as derivatives of the
total energy.</p>
<p>Using the terminology of Morokuma et al., the full molecular geometry
including all atoms is referred to as the &ldquo;real&rdquo; geometry and it is
treated using a &ldquo;low&rdquo;-level of theory. A subset of these atoms (referred
to as the &ldquo;model&rdquo; geometry) are treated using both the &ldquo;low&rdquo;-level and a
&ldquo;high&rdquo;-level of theory. A three-layer model also introduces an
&ldquo;intermediate&rdquo; model geometry and a &ldquo;medium&rdquo; level of theory.</p>
<p>The two-layer model requires a high and low level of theory and a real
and model molecular geometry. The energy at the high-level of theory for
the real geometry is estimated as</p>
<pre><code>     E(High,Real) = E(Low,Real) + [E(High,Model) - E(Low,Model)].
</code></pre>
<p>The three-layer model requires high, medium and low levels of theory,
and real, intermediate and model geometries and the corresponding energy
estimate is</p>
<pre><code>     E(High,Real) = E(Low,Real) + [E(High,Model) - E(Medium,Model)]
                    +  [E(Medium,Inter) - E(Low,Inter)].
</code></pre>
<p>When does ONIOM work well? The approximation for a two-layer model will
be good if</p>
<ul>
<li>the model system includes the interactions that dominate the energy
    difference being computed and the high-level of theory describes
    these to the required precision, and</li>
<li>the interactions between the model and the rest of the real system
    (substitution effects) are described to sufficient accuracy at the
    lower level of theory.</li>
</ul>
<p>ONIOM is used to compute energy differences and the absolute energies
are not all that meaningful even though they are well defined. Due to
cancellation of errors, ONIOM actually works better than you might
expect, but a poorly designed calculation can yield very bad results.
Please read and heed the caution at the end of the article by Dapprich
et al.</p>
<p>The input options are as
follows</p>
<pre><code>ONIOM  
  HIGH   &lt;string theory&gt; [basis &lt;string basis default &quot;ao basis&quot;&gt;] \  
                         [ecp &lt;string ecp&gt;] [input &lt;string input&gt;]  
 [MEDIUM &lt;string theory&gt; [basis &lt;string basis default &quot;ao basis&quot;&gt;] \  
                         [ecp &lt;string ecp&gt;] [input &lt;string input&gt;]]  
  LOW    &lt;string theory&gt; [basis &lt;string basis default &quot;ao basis&quot;&gt;] \  
                         [ecp &lt;string ecp&gt;] [input &lt;string input&gt;]  
  MODEL &lt;integer natoms&gt; [charge &lt;double charge&gt;] \  
                         [&lt;integer i1 j1&gt; &lt;real g1&gt; [&lt;string tag1&gt;] ...]  
 [INTER &lt;integer natoms&gt; [charge &lt;double charge&gt;] \  
                         [&lt;integer i1 j1&gt; &lt;real g1&gt; [&lt;string tag1&gt;] ...]]  
 [VECTORS [low-real &lt;string mofile&gt;] [low-model &lt;string mofile&gt;] \  
          [high-model &lt;string mofile&gt;] [medium-model &lt;string mofile]\  
          [medium-inter &lt;string mofile&gt;] [low-inter &lt;string mofile&gt;]]  
 [PRINT ...]  
 [NOPRINT ...]  
END
</code></pre>
<p>which are described in detail below.</p>
<p>For better validation of user input, the <code>HIGH</code>, <code>LOW</code> and <code>MODEL</code> directives
must always be specified. If the one of the <code>MEDIUM</code> or <code>INTER</code> directives
are specified, then so must the other.</p>
<h2 id="real-model-and-intermediate-geometries">Real, model and intermediate geometries<a class="headerlink" href="#real-model-and-intermediate-geometries" title="Permanent link">&para;</a></h2>
<p>The geometry and total charge of the full or real system should be
specified as normal using the <a href="Geometry.html">geometry</a> directive.
If <script type="math/tex">N_{model}</script> of the atoms are to be included in the model system,
then these should be specified first in the geometry. Similarly, in a
three-layer calculation, if there are <script type="math/tex">N_{inter}</script> atoms to be included
in the intermediate system, then these should also be arranged together
at the beginning of the geometry. The implict assumption is that the
model system is a subset of the intermediate system which is a subset of
the real system. The number of atoms to be included in the model and
intemediate systems are specified using the MODEL and INTER directives.
Optionally, the total charge of the model and intermediate systems may
be adjusted. The default is that all three systems have the same total
charge.</p>
<p>Example 1. A two-layer calculation on <script type="math/tex">K^{+}(H_{2}O)</script> taking the
potassium ion as the model system. Note that no bonds are broken so no
link atoms are introduced. The real geometry would be specified with
potassium (the model) first.</p>
<pre><code>   geometry autosym  
     K  0    0.00    1.37  
     O  0    0.00   -1.07  
     H  0   -0.76   -1.68  
     H  0    0.76   -1.68  
   end
</code></pre>
<p>and the following directive in the ONIOM input block indicates that one
atom (implicitly the first in the geometry) is in the model system</p>
<pre><code>   model 1
</code></pre>
<h3 id="link-atoms">Link atoms<a class="headerlink" href="#link-atoms" title="Permanent link">&para;</a></h3>
<p>Link atoms for bonds spanning two regions are automatically generated
from the bond information. The additional parameters on the <code>MODEL</code> and
<code>INTER</code> directives describe the broken bonds including scale factors for
placement of the link atom and, optionally, the type of link atom. The
type of link atom defaults to hydrogen, but any type may be specified
(actually here you are specifying a geometry tag which is used to
associate a <a href="Geometry.html">geometrical center</a> with an atom type
and basis sets, etc. For each broken bond specify the numbers of the two
atoms (i and j), the scale factor (g) and optionally the tag of the link
atom. Link atoms are placed along the vector connecting the the first to
the second atom of the bond according to the equation</p>
<p>
<script type="math/tex; mode=display">\underline{R}_{link} = (1-g)\underline{R}_{1} + g*\underline{R}_{2}</script>
</p>
<p>where <em>g</em> is the scale factor. If the scale factor is one, then the link
atom is placed where the second atom was. More usually, the scale factor
is less than one, in which case the link atom is placed between the
original two atoms. The scale factor should be chosen so that the link
atom (usually hydrogen) is placed near its equilibrium bond length from
the model atom. E.g., when breaking a single carbon-carbon bond (typical
length 1.528 Angstrms) using a hydrogen link atom we will want a
carbon-hydrogen bond length of about 1.084 Angstrms, so the scale
factor should be chosen as 1.084/1.528 ~ 0.709.</p>
<p>Example 2. A calculation on acetaldehyde (H<sub>3</sub>C-CHO) using aldehyde
(H-CHO) as the model system. The covalent bond between the two
carbon atoms is broken and a link atom must be introduced to replace the
methyl group. The link atom is automatically generated &ndash; all you need
to do is specify the atoms in the model system that are also in the real
system (here CHO) and the broken bonds. Here is the geometry of
acetaldehyde with the CHO of aldehyde first</p>
<pre><code>   geometry  
     C    -0.383    0.288    0.021  
     H    -1.425    0.381    0.376  
     O     0.259    1.263   -0.321  

     H     0.115   -1.570    1.007  
     H    -0.465   -1.768   -0.642  
     H     1.176   -1.171   -0.352  
     C     0.152   -1.150    0.005  
   end
</code></pre>
<p>There are three atoms (the first three) of the real geometry included in
the model geometry, and we are breaking the bond between atoms 1 and 7,
replacing atom 7 with a hydrogen link atom. This is all accomplished by
the directive</p>
<pre><code>   model 3   1 7 0.709 H
</code></pre>
<p>Since the default link atom is hydrogen there is actually no need to
specify the &ldquo;H&rdquo;.</p>
<p>See also the
<a href="#a-three-layer-example">ONIOM three layer example</a>
for a more complex example.</p>
<h3 id="numbering-of-the-link-atoms">Numbering of the link atoms<a class="headerlink" href="#numbering-of-the-link-atoms" title="Permanent link">&para;</a></h3>
<p>The link atoms are appended to the atoms of the model or intermediate
systems in the order that the broken bonds are specified in the input.
This is of importance only if manually constructing an initial guess.</p>
<h2 id="high-medium-and-low-theories">High, medium and low theories<a class="headerlink" href="#high-medium-and-low-theories" title="Permanent link">&para;</a></h2>
<p>The two-layer model requires both the high-level and low-level theories
be specified. The three-layer model also requires the medium-level
theory. Each of these includes a theory (such as SCF, MP2, DFT, CCSD,
CCSD(T), etc.), an optional basis set, an optional ECP, and an optional
string containing general NWChem input.</p>
<h3 id="basis-specification">Basis specification<a class="headerlink" href="#basis-specification" title="Permanent link">&para;</a></h3>
<p>The basis name on the theory directive (high, medium, or low) is that
specified on a basis set directive (see Section 7) and not the name of a
standard basis in the library. If not specified, the basis set for the
high-level theory defaults to the standard &ldquo;ao basis&rdquo;. That for the
medium level defaults to the high-level basis, and the low-level basis
defaults to the medium-level basis. Other wavefunction parameters are
obtained from the standard wavefunction input blocks. See <a href="#effective-core-potentials">Effective
core potentials</a> for an example.</p>
<h3 id="effective-core-potentials">Effective core potentials<a class="headerlink" href="#effective-core-potentials" title="Permanent link">&para;</a></h3>
<p>If an <a href="ECP.html">effective core potential</a> is specified in the
usual fashion outside of the ONIOM input then this will be used in all
calculations. If an alternative ECP name (the name specified on the ECP
directive in the same manner as done for basis sets) is specified on one
of the theory directives, then this ECP will be used in preference for
that level of theory. See the
<a href="#a-three-layer-example">ONIOM three layer example</a>
for sample input.</p>
<h3 id="general-input-strings">General input strings<a class="headerlink" href="#general-input-strings" title="Permanent link">&para;</a></h3>
<p>For many purposes, the ability to specify the theory, basis and
effective core potential is adequate. All of the options for each theory
are determined from their independent input blocks. However, if the same
theory (e.g., DFT) is to be used with different options for the ONIOM
theoretical models, then the general input strings must be used. These
strings are processed as NWChem input each time the theoretical model is
invoked. The strings may contain any NWChem input, except for options
pertaining to ONIOM and the <code>task</code> directive. The intent that the strings
be used just to control the options pertaining to the theory being used.</p>
<p>A word of caution. Be sure to check that the options are producing the
desired results. Since the NWChem database is persistent and the ONIOM
calculations happen in an undefined order, the input strings should
fully define the calculation you wish to have happen.</p>
<p>For instance, if the high model is DFT/B3LYP/6-311g** and the low
model is DFT/LDA/3-21g, the ONIOM input might look like this</p>
<pre><code>   oniom  
     model 3  
     low  dft basis 3-21g    input &quot;dft; xc; end&quot;  
     high dft basis 6-311g** input &quot;dft; xc b3lyp; end&quot;  
   end
</code></pre>
<p>The empty XC directive restores the default LDA exchange-correlation
option (see Section 11.3). Note that semi-colons and other quotation
marks inside the input string must be preceded by a backslash to avoid
special interpretation.</p>
<p>See <a href="#dft-with-and-without-charge-fitting">|DFT with and without charge
fitting</a> for another
example.</p>
<h2 id="use-of-symmetry">Use of symmetry<a class="headerlink" href="#use-of-symmetry" title="Permanent link">&para;</a></h2>
<p>Symmetry should work just fine as long as the model and intermediate
regions respect the symmetry &ndash; i.e., symmetry equivalent atoms need to
be treated equivalently. If symmetry equivalent atoms must be treated in
separate regions then the symmetry must be lowered (or completely
switched off).</p>
<h2 id="molecular-orbital-files">Molecular orbital files<a class="headerlink" href="#molecular-orbital-files" title="Permanent link">&para;</a></h2>
<p>The VECTORS directive in the ONIOM block is different to that elsewhere
in NWChem. For each of the necessary combinations of theory and geometry
you can specify a different file for the molecular orbitals. By default
each combination will store the MO vectors in the permanent directory
using a file name created by appending to the name of the calculation
the following string</p>
<ul>
<li>low-real &ndash; &ldquo;.lrmos&rdquo;</li>
<li>low-inter &ndash; &ldquo;.limos&rdquo;</li>
<li>low-model &ndash; &ldquo;.lmmos&rdquo;</li>
<li>medium-inter &ndash; &ldquo;.mimos&rdquo;</li>
<li>medium-model &ndash; &ldquo;.mmmos&rdquo;</li>
<li>high-model &ndash; &ldquo;.hmmos&rdquo;</li>
</ul>
<p>Each calculation will utilize the appropriate vectors which is more
efficient during geometry optimizations and frequency calculations, and
is also useful for the initial calculation. In the absence of existing
MO vectors files, the default atomic guess is used (see
<a href="Hartree-Fock-Theory-for-Molecules.html#vectors-inputoutput-of-mo-vectors">|Input/output of MO vectors</a>).</p>
<p>If special measures must be taken to converge the initial SCF, DFT or
MCSCF calculation for one or more of the systems, then initial vectors
may be saved in a file with the default name, or another name may be
specified using the VECTORS directive. Note that subsequent vectors
(e.g., from a geometry optimization) will be written back to this file,
so take a copy if you wish to preserve it. To generate the initial guess
for the model or intermediate systems it is necessary to generate the
geometries which is most readily done, if there are link atoms, by just
running NWChem on the input for the ONIOM calculation on your
workstation. It will print these geometries before starting any
calculations which you can then terminate.</p>
<p>E.g., in a calculation on Fe(III) surrounded by some ligands, it is hard
to converge the full (real) system from the atomic guess so as to obtain
a <script type="math/tex">d^5</script> configuration for the iron atom since the <em>d</em> orbitals are
often nominally lower in energy than some of the ligand orbitals. The
most effective mechanism is to converge the isolated Fe(III) and then to
use the <a href="Hartree-Fock-Theory-for-Molecules.html#vectors-fragment-superposition-of-fragment-molecular-orbitals">fragment
guess</a>
as a starting guess for the real system. The resulting converged
molecular orbitals can be saved either with the default name (as
described above in this section), in which case no additional input is
necessary. If an alternative name is desired, then the <code>VECTORS</code> directive
may be used as follows</p>
<pre><code>   vectors low-real /u/rjh/jobs/fe_ether_water.mos
</code></pre>
<h2 id="restarting">Restarting<a class="headerlink" href="#restarting" title="Permanent link">&para;</a></h2>
<p>Restart of ONIOM calculations does not currently work as smoothly as we
would like. For geometry optimizations that terminated gracefully by
running out of iterations, the restart will work as normal. Otherwise,
specify in the input of the restart job the last geometry of the
optimization. The Hessian information will be reused and the calculation
should proceed losing at most the cost of one ONIOM gradient evaluation.
For energy or frequency calculations, restart may not currently be
possible.</p>
<h2 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h2>
<h3 id="hydrocarbon-bond-energy">Hydrocarbon bond energy<a class="headerlink" href="#hydrocarbon-bond-energy" title="Permanent link">&para;</a></h3>
<p>A simple two-layer model changing just the wavefunction with one link
atom.</p>
<p>This reproduces the two-layer ONIOM (MP2:HF) result from Dapprich et al.
for the reaction <script type="math/tex">R-CH_{3} = R-CH_{2} + H</script> with <script type="math/tex">R=CH_3</script> using
<script type="math/tex">CH_4</script> as the model. The geometries of <script type="math/tex">R-CH_3</script> and <script type="math/tex">R-CH_2</script> are
optimized at the DFT-B3LYP/6-311++G** level of theory, and then ONIOM
is used to compute the binding energy using UMP2 for the model system
and HF for the real system. The results, including MP2 calculations on
the full system for comparison, are as given in the table
below.</p>
<p><center></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Theory</td>
<td>Me-CH2</td>
<td>Me-Me</td>
<td>H</td>
<td>De(Hartree)</td>
<td>De(kcal/mol)</td>
</tr>
<tr>
<td>B3LYP</td>
<td>-79.185062</td>
<td>-79.856575</td>
<td>-0.502256</td>
<td>0.169257</td>
<td>106.2</td>
</tr>
<tr>
<td>HF</td>
<td>-78.620141</td>
<td>-79.251701</td>
<td>-0.499817</td>
<td>0.131741</td>
<td>82.7</td>
</tr>
<tr>
<td>MP2</td>
<td>-78.904716</td>
<td>-79.571654</td>
<td>-0.499817</td>
<td>0.167120</td>
<td>104.9</td>
</tr>
<tr>
<td>MP2:HF</td>
<td>-78.755223</td>
<td>-79.422559</td>
<td>-0.499817</td>
<td>0.167518</td>
<td>105.1</td>
</tr>
</tbody>
</table>
<p>Energies for ONIOM example 1, hydrocarbon bond energy using MP2:HF
two-layer model.</p>
<p></center></p>
<p>The following input first performs a calculation on <script type="math/tex">CH_{3}-CH_2</script>, and
then on <script type="math/tex">CH_{3}-CH_3</script>. Note that in the second calculation we cannot
use the full symmetry since we are breaking the C-C bond in forming the
model system (the non-equivalence of the methyl groups is perhaps more
apparent if we write <script type="math/tex">R-CH_3</script>).</p>
<pre><code>   start  

   basis spherical  
     H library 6-311++G**; C library 6-311++G**  
   end  

   title &quot;ONIOM Me-CH2&quot;  

   geometry autosym  
     H    -0.23429328     1.32498565     0.92634814  
     H    -0.23429328     1.32498565    -0.92634814  
     C    -0.13064265     0.77330370     0.00000000  
     H    -1.01618703    -1.19260361     0.00000000  
     H     0.49856072    -1.08196901    -0.88665533  
     H     0.49856072    -1.08196901     0.88665533  
     C    -0.02434414    -0.71063687     0.00000000  
   end  

   scf; uhf; doublet; thresh 1e-6; end  
   mp2; freeze atomic; end  

   oniom  
     high mp2  
     low  scf  
     model 3   3 7 0.724  
   end  

   task oniom  

   title &quot;ONIOM Me-Me&quot;  

   geometry   # Note cannot use full D3D symmetry here, either specify noautosym, or change an atom tag (here C -&gt; C1)  
     H   -0.72023641     0.72023641    -1.16373235  
     H    0.98386124     0.26362482    -1.16373235  
     H   -0.26362482    -0.98386124    -1.16373235  
     C    0.00000000     0.00000000    -0.76537515  
     H    0.72023641    -0.72023641     1.16373235  
     H   -0.98386124    -0.26362482     1.16373235  
     H    0.26362482     0.98386124     1.16373235  
     C1   0.00000000     0.00000000     0.76537515  
   end  

   scf; rhf; singlet; end  

   oniom  
     high mp2  
     low  scf  
     model 4   4 8 0.724  
   end  

   task oniom
</code></pre>
<h3 id="optimization-and-frequencies">Optimization and frequencies<a class="headerlink" href="#optimization-and-frequencies" title="Permanent link">&para;</a></h3>
<p>A two-layer model including modification of theory, basis, ECP and total
charge and no link atoms.</p>
<p>This input reproduces the ONIOM optimization and vibrational frequency
calculation of Rh(CO)<sub>2</sub>Cp of Dapprich et al. The model system is
Rh(CO)<sub>2</sub><sup>+</sup>. The low theory is the Gaussian LANL2MB model
(Hay-Wadt n+1 ECP with minimal basis on Rh, STO-3G on others) with SCF.
The high theory is the Gaussian LANL2DZ model (another Hay-Wadt ECP with
a DZ basis set on Rh, Dunning split valence on the other atoms) with
DFT/B3LYP. Note that different names should be used for the basis set
and ECP since the same mechanism is used to store them in the
database.</p>
<pre><code>   start  

   ecp LANL2DZ_ECP  
     rh library LANL2DZ_ECP  
   end  

   basis LANL2DZ spherical  
     rh library LANL2DZ_ECP  
     o library SV_(Dunning-Hay); c library SV_(Dunning-Hay); h library SV_(Dunning-Hay)  
   end  

   ecp Hay-Wadt_MB_(n+1)_ECP  
     rh library Hay-Wadt_MB_(n+1)_ECP  
   end  

   # This is the minimal basis used by Gaussian.  It is not the same   
   # as the one in the EMSL basis set library for this ECP.  
   basis Hay-Wadt_MB_(n+1) spherical   
     Rh s; .264600D+01 -.135541D+01; .175100D+01  .161122D+01; .571300D+00  .589381D+00  
     Rh s; .264600D+01  .456934D+00; .175100D+01 -.595199D+00; .571300D+00 -.342127D+00  
           .143800D+00  .410138D+00; .428000D-01  .780486D+00  
     Rh p; .544000D+01 -.987699D-01; .132900D+01  .743359D+00; .484500D+00  .366846D+00  
     Rh p; .659500D+00 -.370046D-01; .869000D-01  .452364D+00; .257000D-01  .653822D+00  
     Rh d; .366900D+01  .670480D-01; .142300D+01  .455084D+00; .509100D+00  .479584D+00  
           .161000D+00  .233826D+00  
     o  library sto-3g; c  library sto-3g; h  library sto-3g  
   end  

   charge 0  
   geometry autosym  
     rh       0.00445705    -0.15119674     0.00000000  
     c       -0.01380554    -1.45254070     1.35171818  
     c       -0.01380554    -1.45254070    -1.35171818  
     o       -0.01805883    -2.26420212     2.20818932  
     o       -0.01805883    -2.26420212    -2.20818932  
     c        1.23209566     1.89314720     0.00000000  
     c        0.37739392     1.84262319    -1.15286640  
     c       -1.01479160     1.93086461    -0.70666350  
     c       -1.01479160     1.93086461     0.70666350  
     c        0.37739392     1.84262319     1.15286640  
     h        2.31251453     1.89903673     0.00000000  
     h        0.70378132     1.86131979    -2.18414218  
     h       -1.88154273     1.96919306    -1.35203550  
     h       -1.88154273     1.96919306     1.35203550  
     h        0.70378132     1.86131979     2.18414218  
   end  

   dft; grid fine; convergence gradient 1e-6 density 1e-6; xc b3lyp; end  
   scf; thresh 1e-6; end  

   oniom  
     low scf basis Hay-Wadt_MB_(n+1) ecp  Hay-Wadt_MB_(n+1)_ECP  
     high dft basis LANL2DZ ecp LANL2DZ_ECP  
     model 5 charge 1  
     print low  
   end  

   task oniom optimize  
   task oniom freq
</code></pre>
<h3 id="a-three-layer-example">A three-layer example<a class="headerlink" href="#a-three-layer-example" title="Permanent link">&para;</a></h3>
<p>A three layer example combining CCSD(T), and MP2 with two different
quality basis sets, and using multiple link atoms.</p>
<p>The full system is tetra-dimethyl-amino-ethylene (TAME) or
(N(Me)2)2-C=C-(N(Me)2)2. The intermediate system is (NH2)2-C=C-(NH2)2
and H2C=CH2 is the model system. CCSD(T)+aug-cc-pvtz is used for the
model region, MP2+aug-cc-pvtz for the intermediate region, and
MP2+aug-cc-pvdz for everything.</p>
<p>In the real geometry the first two atoms (C, C) are the model system
(link atoms will be added automatically). The first six atoms (C, C, N,
N, N, N) describe the intermediate system (again with link atoms to be
added automatically). The atoms have been numbered using comments to
make the bonding input easier to generate.</p>
<p>To make the model system, four C-N bonds are broken between the ethylene
fragment and the dimethyl-amino groups and replaced with C-H bonds. To
make the intermediate system, eight C-N bonds are broken between the
nitrogens and the methyl groups and replaced with N-H bonds. The scaling
factor could be chosen differently for each of the bonds.</p>
<pre><code>   start   

   geometry   
     C  0.40337795 -0.17516305 -0.51505208  # 1  
     C -0.40328664  0.17555927  0.51466084  # 2  
     N  1.87154979 -0.17516305 -0.51505208  # 3  
     N -0.18694782 -0.60488524 -1.79258692  # 4  
     N  0.18692927  0.60488318  1.79247594  # 5  
     N -1.87148219  0.17564718  0.51496494  # 6  
     C  2.46636552  1.18039452 -0.51505208  # 7  
     C  2.48067731 -1.10425355  0.46161675  # 8  
     C -2.46642715 -1.17982091  0.51473105  # 9  
     C -2.48054940  1.10495864 -0.46156202  # 10  
     C  0.30027136  0.14582197 -2.97072148  # 11  
     C -0.14245927 -2.07576980 -1.96730852  # 12  
     C -0.29948109 -0.14689874  2.97021079  # 13  
     C  0.14140463  2.07558249  1.96815181  # 14  
     H  0.78955302  2.52533887  1.19760764  
     H -0.86543435  2.50958894  1.88075113  
     ... and 22 other hydrogen atoms on the methyl groups  
   end  

   basis aug-cc-pvtz spherical  
     C library aug-cc-pvtz; H library aug-cc-pvtz  
   end  

   basis aug-cc-pvdz spherical  
     C library aug-cc-pvtz; H library aug-cc-pvtz  
   end  

   oniom        
     high ccsd(t) basis aug-cc-pvtz  
     medium mp2 basis aug-cc-pvtz  
     low mp2 basis aug-cc-pvdz  
     model 2   1 3  0.87   1 4  0.87   2 5  0.87   2 6  0.87  

     inter 6   3 7  0.69   3 8  0.69   4 11 0.69   4 12 0.69 \  
               5 13 0.69   5 14 0.69   6 9  0.69   6 10 0.69  
   end  

   task oniom
</code></pre>
<h3 id="dft-with-and-without-charge-fitting">DFT with and without charge fitting<a class="headerlink" href="#dft-with-and-without-charge-fitting" title="Permanent link">&para;</a></h3>
<p>Demonstrates use of general input strings.</p>
<p>A two-layer model for anthracene (a linear chain of three fused benzene
rings) using benzene as the model system. The high-level theory is
DFT/B3LYP/TZVP with exact Coulomb. The low level is DFT/LDA/DZVP2 with
charge fitting.</p>
<p>Note the following.</p>
<ol>
<li>The semi-colons and quotation marks inside the input string must be
    quoted with backslash.</li>
<li>The low level of theory sets the fitting basis set and the high
    level of theory unsets it.  </li>
</ol>
<pre><code>   start  
   geometry   
     symmetry d2h  
     C    0.71237329    -1.21458940     0.0  
     C   -0.71237329    -1.21458940     0.0  
     C    0.71237329     1.21458940     0.0  
     C   -0.71237329     1.21458940     0.0  
     C   -1.39414269     0.00000000     0.0  
     C    1.39414269     0.00000000     0.0  
     H   -2.47680865     0.00000000     0.0  
     H    2.47680865     0.00000000     0.0  
     C    1.40340535    -2.48997027     0.0  
     C   -1.40340535    -2.48997027     0.0  
     C    1.40340535     2.48997027     0.0  
     C   -1.40340535     2.48997027     0.0  
     C    0.72211503     3.64518615     0.0  
     C   -0.72211503     3.64518615     0.0  
     C    0.72211503    -3.64518615     0.0  
     C   -0.72211503    -3.64518615     0.0  
     H    2.48612947     2.48094825     0.0  
     H    1.24157357     4.59507342     0.0  
     H   -1.24157357     4.59507342     0.0  
     H   -2.48612947     2.48094825     0.0  
     H    2.48612947    -2.48094825     0.0  
     H    1.24157357    -4.59507342     0.0  
     H   -1.24157357    -4.59507342     0.0  
     H   -2.48612947    -2.48094825     0.0  
   end  

   basis small  
     h library DZVP_(DFT_Orbital)  
     c library DZVP_(DFT_Orbital)  
   end  

   basis fitting  
     h library DGauss_A1_DFT_Coulomb_Fitting  
     c library DGauss_A1_DFT_Coulomb_Fitting  
   end  

   basis big  
     h library TZVP_(DFT_Orbital)  
     c library TZVP_(DFT_Orbital)  
   end  

   oniom  
     model 8   1 9 0.75   2 10 0.75   3 11 0.75   4 12 0.75  
     high dft basis big   input &quot;unset &quot;cd basis&quot;; dft; xc b3lyp; end&quot;  
     low  dft basis small input &quot;set &quot;cd basis&quot; fitting; dft; xc; end&quot;  
   end  

   task oniom
</code></pre>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="VEM-Model.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: VEM (Vertical Excitation or Emission) Model" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Previous
                </span>
                VEM (Vertical Excitation or Emission) Model
              </div>
            </div>
          </a>
        
        
          
          <a href="qmmm_introduction.html" class="md-footer__link md-footer__link--next" aria-label="Next: QMMM Introduction" rel="next">
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Next
                </span>
                QMMM Introduction
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.expand", "navigation.top", "navigation.instant", "navigation.tracking", "navigation.indexes", "navigation.footer", "search.highlight", "search.share", "content.action.edit", "content.action.view", "content.code.copy"], "search": "assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.ba449ae6.min.js"></script>
      
        <script src="js/print-site.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
      
    
  </body>
</html>