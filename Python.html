
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="NWChem Website">
      
      
      
        <link rel="canonical" href="https://nwchemgit.github.io/Python.html">
      
      
        <link rel="prev" href="Format_of_MD_Files.html">
      
      
        <link rel="next" href="Sample.html">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.15">
    
    
      
        <title>Controlling NWChem with Python - NWChem</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
    
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#controlling-nwchem-with-python" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="NWChem" class="md-header__button md-logo" aria-label="NWChem" data-md-component="logo">
      
  <img src="assets/MS3logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NWChem
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Controlling NWChem with Python
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/nwchemgit/nwchem-wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="NWChem" class="md-nav__button md-logo" aria-label="NWChem" data-md-component="logo">
      
  <img src="assets/MS3logo.png" alt="logo">

    </a>
    NWChem
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nwchemgit/nwchem-wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        NWChem Homepage
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Home.html" class="md-nav__link">
        NWChem Manual
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          How to get NWChem
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          How to get NWChem
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Download.html" class="md-nav__link">
        How to download and install NWChem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Compiling-NWChem.html" class="md-nav__link">
        Compiling NWChem from source
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Introduction 
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Introduction 
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Getting-Started.html" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="NWChem-Architecture.html" class="md-nav__link">
        NWChem Architecture
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Capabilities.html" class="md-nav__link">
        Functionalities
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Top-level.html" class="md-nav__link">
        Top-level Directives
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Geometry.html" class="md-nav__link">
        Geometries
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Basis.html" class="md-nav__link">
        Basis sets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="ECP.html" class="md-nav__link">
        Effective Core Potentials
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Relativistic-All-electron-Approximations.html" class="md-nav__link">
        Relativistic all-electron approximations
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
          Quantum-Mechanical-Methods
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Quantum-Mechanical-Methods
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Hartree-Fock-Theory-for-Molecules.html" class="md-nav__link">
        Hartree-Fock
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Density-Functional-Theory-for-Molecules.html" class="md-nav__link">
        Density Functional Theory (DFT)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Excited-State-Calculations.html" class="md-nav__link">
        CIS, TDHF, TDDFT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="RT-TDDFT.html" class="md-nav__link">
        Real-time TDDFT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Plane-Wave-Density-Functional-Theory.html" class="md-nav__link">
        Plane-Wave Density Functional Theory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="TCE.html" class="md-nav__link">
        Tensor Contraction Engine Module: CI, MBPT, and CC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="MP2.html" class="md-nav__link">
        MP2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="CCSD.html" class="md-nav__link">
        Coupled Cluster Calculations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Multiconfiguration_SCF.html" class="md-nav__link">
        MCSCF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="GW.html" class="md-nav__link">
        Molecular GW
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
          Quantum Molecular Dynamics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          Quantum Molecular Dynamics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Plane-Wave-Density-Functional-Theory.html" class="md-nav__link">
        Plane-Wave Density Functional Theory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Gaussian-Basis-AIMD.html" class="md-nav__link">
        Gaussian Basis AIMD
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
          Hybrid Approaches
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          Hybrid Approaches
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Solvation-Models.html" class="md-nav__link">
        Solvation Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="VEM-Model.html" class="md-nav__link">
        VEM (Vertical Excitation or Emission) Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ONIOM.html" class="md-nav__link">
        Hybrid Calculations with ONIOM
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_13_4" id="__nav_13_4_label" tabindex="0">
          QMMM
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_13_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_13_4">
          <span class="md-nav__icon md-icon"></span>
          QMMM
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="qmmm_introduction.html" class="md-nav__link">
        QMMM Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM.html" class="md-nav__link">
        QMMM table of contents
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_4_3" >
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_13_4_3" id="__nav_13_4_3_label" tabindex="0">
          QMMM Restart and Topology Files
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_13_4_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_13_4_3">
          <span class="md-nav__icon md-icon"></span>
          QMMM Restart and Topology Files
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Restart_and_Topology_Files.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Preparation_Prerequisites.html" class="md-nav__link">
        QMMM Preparation Prerequisites
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_preparation_basic.html" class="md-nav__link">
        Qmmm preparation basic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_preparation_solvation.html" class="md-nav__link">
        Qmmm preparation solvation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_preparation_constraints.html" class="md-nav__link">
        Qmmm preparation constraints
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_4_4" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_13_4_4" id="__nav_13_4_4_label" tabindex="0">
          QMMM Input File
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_13_4_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_13_4_4">
          <span class="md-nav__icon md-icon"></span>
          QMMM Input File
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Input_File.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_QM_Parameters.html" class="md-nav__link">
        QM_Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_MM_Parameters.html" class="md-nav__link">
        QMMM MM Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_QMMM_Parameters.html" class="md-nav__link">
        QM/MM parameters
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_4_5" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_13_4_5" id="__nav_13_4_5_label" tabindex="0">
          QMMMM Single Point Calculations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_13_4_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_13_4_5">
          <span class="md-nav__icon md-icon"></span>
          QMMMM Single Point Calculations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="qmmm_sp_energy.html" class="md-nav__link">
        QMMM Ground State Energy and Gradient
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Excited_States.html" class="md-nav__link">
        QMMM Excited State Energy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="qmmm_sp_property.html" class="md-nav__link">
        QMMM Properties
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_ESP.html" class="md-nav__link">
        QMMM ESP Charge Analysis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_4_6" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_13_4_6" id="__nav_13_4_6_label" tabindex="0">
          QMMM Potential Energy Surface Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_13_4_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_13_4_6">
          <span class="md-nav__icon md-icon"></span>
          QMMM Potential Energy Surface Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_optimization.html" class="md-nav__link">
        QMMM Optimization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Transition_States.html" class="md-nav__link">
        QMMM Transition States
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_freq.html" class="md-nav__link">
        QMMM Hessians and Frequency
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_NEB_Calculations.html" class="md-nav__link">
        QMMM Reaction Pathway Calculations with NEB
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Dynamics.html" class="md-nav__link">
        QMMM Dynamics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Free_Energy.html" class="md-nav__link">
        QMMM Free Energy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Appendix.html" class="md-nav__link">
        QMMM Apppendix
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Bq.html" class="md-nav__link">
        Point charges
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="1D-RISM.html" class="md-nav__link">
        1-D RISM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
          Potential Energy Surface Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_14">
          <span class="md-nav__icon md-icon"></span>
          Potential Energy Surface Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Geometry-Optimization.html" class="md-nav__link">
        Geometry Optimization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Hessians-and-Vibrational-Frequencies.html" class="md-nav__link">
        Hessians
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Constraints.html" class="md-nav__link">
        Constraints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Nudged-Elastic-Band-and-Zero-Temperature-String-Methods.html" class="md-nav__link">
        Nudged Elastic Band (NEB) method
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
          Electronic Structure Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_15">
          <span class="md-nav__icon md-icon"></span>
          Electronic Structure Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Properties.html" class="md-nav__link">
        Properties
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ESP.html" class="md-nav__link">
        Electrostatic potentials
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="DPLOT.html" class="md-nav__link">
        DPLOT
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
          Other-Capabilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_16">
          <span class="md-nav__icon md-icon"></span>
          Other-Capabilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Electron-Transfer.html" class="md-nav__link">
        Electron Transfer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Python.html" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Quantum.html" class="md-nav__link">
        Quantum
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="VSCF.html" class="md-nav__link">
        Vibrational SCF (VSCF)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="CCCA_method.html" class="md-nav__link">
        Correlation consistent Composite Approach (ccCA)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Interface.html" class="md-nav__link">
        Interfaces to Other Programs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_17" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_17" id="__nav_17_label" tabindex="0">
          Molecular Mechanics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_17_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_17">
          <span class="md-nav__icon md-icon"></span>
          Molecular Mechanics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Prepare.html" class="md-nav__link">
        Prepare
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="MD.html" class="md-nav__link">
        MD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Analysis.html" class="md-nav__link">
        Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Format_of_MD_Files.html" class="md-nav__link">
        Format of MD files
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Controlling NWChem with Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="Python.html" class="md-nav__link md-nav__link--active">
        Controlling NWChem with Python
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-input-and-run-a-python-program-inside-nwchem" class="md-nav__link">
    How to input and run a Python program inside NWChem
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nwchem-extensions" class="md-nav__link">
    NWChem extensions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hello-world" class="md-nav__link">
    Hello world
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scanning-a-basis-exponent" class="md-nav__link">
    Scanning a basis exponent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scanning-a-basis-exponent-revisited" class="md-nav__link">
    Scanning a basis exponent revisited
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scanning-a-geometric-variable" class="md-nav__link">
    Scanning a geometric variable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scan-using-the-bsse-counterpoise-corrected-energy" class="md-nav__link">
    Scan using the BSSE counterpoise corrected energy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scan-the-geometry-and-compute-the-energy-and-gradient" class="md-nav__link">
    Scan the geometry and compute the energy and gradient
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reaction-energies-varying-the-basis-set" class="md-nav__link">
    Reaction energies varying the basis set
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-database" class="md-nav__link">
    Using the database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-exceptions-from-nwchem" class="md-nav__link">
    Handling exceptions from NWChem
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-geometry-information-a-temporary-hack" class="md-nav__link">
    Accessing geometry information: a temporary hack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scaning-a-basis-exponent-yet-again-plotting-and-handling-child-processes" class="md-nav__link">
    Scaning a basis exponent yet again: plotting and handling child processes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_19" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_19" id="__nav_19_label" tabindex="0">
          NWChem Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_19_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_19">
          <span class="md-nav__icon md-icon"></span>
          NWChem Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Sample.html" class="md-nav__link">
        Sample input files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Geometry-examples.html" class="md-nav__link">
        Examples of geometries using symmetry
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Benchmarks.html" class="md-nav__link">
        Benchmarks performed with NWChem
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Known-Bugs.html" class="md-nav__link">
        Known Bugs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="FAQ.html" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Tutorials.html" class="md-nav__link">
        NWChem Tutorials
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Forum.html" class="md-nav__link">
        Forum
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Archived-Forum.html" class="md-nav__link">
        Archived Forum
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="EMSL_Arrows.html" class="md-nav__link">
        EMSL Arrows
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_27" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_27" id="__nav_27_label" tabindex="0">
          Supplementary Information
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_27_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_27">
          <span class="md-nav__icon md-icon"></span>
          Supplementary Information
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://hpc.pnl.gov/globalarrays/" class="md-nav__link">
        Global Arrays
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ARMCI.html" class="md-nav__link">
        Choosing the ARMCI Library
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Interfaces-with-External-Software.html" class="md-nav__link">
        Interfaces with External Software
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Software-supporting-NWChem.html" class="md-nav__link">
        Software supporting NWChem
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Containers.html" class="md-nav__link">
        Containers
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://nwchemgit.github.io/nwchemusermanual.pdf" class="md-nav__link">
        Documentation in PDF format
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-input-and-run-a-python-program-inside-nwchem" class="md-nav__link">
    How to input and run a Python program inside NWChem
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nwchem-extensions" class="md-nav__link">
    NWChem extensions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hello-world" class="md-nav__link">
    Hello world
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scanning-a-basis-exponent" class="md-nav__link">
    Scanning a basis exponent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scanning-a-basis-exponent-revisited" class="md-nav__link">
    Scanning a basis exponent revisited
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scanning-a-geometric-variable" class="md-nav__link">
    Scanning a geometric variable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scan-using-the-bsse-counterpoise-corrected-energy" class="md-nav__link">
    Scan using the BSSE counterpoise corrected energy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scan-the-geometry-and-compute-the-energy-and-gradient" class="md-nav__link">
    Scan the geometry and compute the energy and gradient
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reaction-energies-varying-the-basis-set" class="md-nav__link">
    Reaction energies varying the basis set
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-database" class="md-nav__link">
    Using the database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-exceptions-from-nwchem" class="md-nav__link">
    Handling exceptions from NWChem
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-geometry-information-a-temporary-hack" class="md-nav__link">
    Accessing geometry information: a temporary hack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scaning-a-basis-exponent-yet-again-plotting-and-handling-child-processes" class="md-nav__link">
    Scaning a basis exponent yet again: plotting and handling child processes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/nwchemgit/nwchem-wiki/edit/master/Python.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/nwchemgit/nwchem-wiki/raw/master/Python.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5Z"/></svg>
    </a>
  


<h1 id="controlling-nwchem-with-python">Controlling NWChem with Python<a class="headerlink" href="#controlling-nwchem-with-python" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>Python programs may be embedded into the NWChem input
and used to control the execution of NWChem. Python is a very powerful
and widely used scripting language that provides useful things such as
variables, conditional branches and loops, and is also readily extended.
Example applications include scanning potential energy surfaces,
computing properties in a variety of basis sets, optimizing the energy
w.r.t. parameters in the basis set, computing polarizabilities with
finite field, and simple molecular dynamics.</p>
<p>Look in the NWChem contrib directory for useful scripts and examples.
Visit the Python web-site <a href="https://www.python.org">https://www.python.org</a> for a full manual and
lots of useful code and resources.</p>
<h2 id="how-to-input-and-run-a-python-program-inside-nwchem">How to input and run a Python program inside NWChem<a class="headerlink" href="#how-to-input-and-run-a-python-program-inside-nwchem" title="Permanent link">&para;</a></h2>
<p>A Python program is input into NWChem inside a Python compound
directive.</p>
<pre><code> python [print|noprint]
   ...
 end
</code></pre>
<p>The END directive must be flush against the left margin (see the
Troubleshooting section for the reason why).</p>
<p>The program is by default printed to standard output when read, but this
may be disabled with the noprint keyword. Python uses indentation to
indicate scope (and the initial level of indentation must be zero),
whereas NWChem uses optional indentation only to make the input more
readable. For example, in Python, the contents of a loop, or
conditionally-executed block of code must be indented further than the
surrounding code. Also, Python attaches special meaning to several
symbols also used by NWChem. For these reasons, the input inside a
PYTHON compound directive is read verbatim except that if the first line
of the Python program is indented, the same amount of indentation is
removed from all subsequent lines. This is so that a program may be
indented inside the PYTHON input block for improved readability of the
NWChem input, while satisfying the constraint that when given to Python
the first line has zero indentation.</p>
<p>E.g., the following two sets of input specify the same Python program.</p>
<pre><code>python  
  print (&quot;Hello&quot;)
  print (&quot;Goodbye&quot;)
end

python  
print (&quot;Hello&quot;)
print (&quot;Goodbye&quot;)
end
</code></pre>
<p>whereas this program is in error since the indentation of the second
line is less than that of the first.</p>
<pre><code>python  
  print (&quot;Hello&quot;)
print (&quot;Goodbye&quot;)
end
</code></pre>
<p>The Python program is not executed until the following directive is
encountered</p>
<pre><code> task python
</code></pre>
<p>which is to maintain consistency with the behavior of NWChem in general.
The program is executed by all nodes. This enables the full
functionality and speed of NWChem to be accessible from Python, but
there are some gotchas</p>
<ul>
<li>Print statements and other output will be executed by all nodes so
    you will get a lot more output than probably desired unless the
    output is restricted to just one node (by convention node zero).</li>
<li>The calls to NWChem functions are all collective (i.e., all nodes
    must execute them). If these calls are not made collectively your
    program may deadlock (i.e., cease to make progress).</li>
<li>When writing to the database (<code>rtdb_put()</code>) it is the data from node
    zero that is written.</li>
<li>NWChem overrides certain default signal handlers so care must be
    taken when creating processes (see Section describing <a href="#scaning-a-basis-exponent-yet-again-plotting-and-handling-child-processes">a scanning example</a>).</li>
</ul>
<h2 id="nwchem-extensions">NWChem extensions<a class="headerlink" href="#nwchem-extensions" title="Permanent link">&para;</a></h2>
<p>Since we have little experience using Python, the NWChem-Python
interface might change in a non-backwardly compatible fashion as we
discover better ways of providing useful functionality. We would
appreciate suggestions about useful things that can be added to the
NWChem-Python interface. In principle, nearly any Fortran or C routine
within NWChem can be extended to Python, but we are also interested in
ideas that will enable users to build completely new things. For
instance, how about being able to define your own energy functions that
can be used with the existing optimizers or dynamics package?</p>
<p>Python has been extended with a module named &ldquo;nwchem&rdquo; which is
automatically imported and contains the following NWChem-specific
commands. They all handle NWChem-related errors by raising the exception
&ldquo;NWChemError&rdquo;, which may be handled in the standard Python manner (see
Section describing <a href="#handling-exceptions-from-nwchem">handling exception</a>).</p>
<ul>
<li><code>input_parse(string)</code> &ndash; invokes the standard NWChem input parser
    with the data in string as input. Note that the usual behavior of
    NWChem will apply &ndash; the parser only reads input up to either end of
    input or until a <code>TASK</code> directive is encountered (the task directive
    is not executed by the parser).</li>
<li><code>task_energy(theory)</code> &ndash; returns the energy as if computed with the
    NWChem directive <code>TASK ENERGY &lt;THEORY&gt;</code>.</li>
<li><code>task_gradient(theory)</code> &ndash; returns a tuple (energy,gradient) as if
    computed with the NWChem directive <code>TASK GRADIENT &lt;THEORY&gt;</code>.</li>
<li><code>task_optimize(theory)</code> &ndash; returns a tuple (energy,gradient) as if
    computed with the NWChem directive <code>TASK OPTIMIZE &lt;THEORY&gt;</code>. The
    energy and gradient will be those at the last point in the
    optimization and consistent with the current geometry in the
    database.</li>
<li><code>ga_nodeid()</code> &ndash; returns the number of the parallel process.</li>
<li><code>rtdb_print(print_values)</code> &ndash; prints the contents of the RTDB. If
    <code>print_values</code> is 0, only the keys are printed, if it is 1 then the
    values are also printed.</li>
<li><code>rtdb_put(name, values)</code> or <code>rtdb_put(name, values, type)</code> &ndash; puts the
    values into the database with the given name. In the first form, the
    type is inferred from the first value, and in the second form the
    type is specified using the last argument as one of INT, DBL,
    LOGICAL, or CHAR.</li>
<li><code>rtdb_get(name)</code> &ndash; returns the data from the database associated
    with the given name.</li>
</ul>
<p>An
<a href="#accessing-geometry-information-a-temporary-hack">example</a>
below explains, in lieu of a Python wrapper for the geometry object, how
to obtain the Cartesian molecular coordinates directly from the
database.</p>
<h2 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h2>
<p>Several examples will provide the best explanation of how the extensions
are used, and how Python might prove useful.</p>
<h3 id="hello-world">Hello world<a class="headerlink" href="#hello-world" title="Permanent link">&para;</a></h3>
<pre><code>python
  print ('Hello world from process %i'  % ga_nodeid())
end

task python
</code></pre>
<p>This input prints the traditional greeting from each parallel
process.</p>
<h3 id="scanning-a-basis-exponent">Scanning a basis exponent<a class="headerlink" href="#scanning-a-basis-exponent" title="Permanent link">&para;</a></h3>
<pre><code>geometry units au
 O 0 0 0; H 0 1.430 -1.107; H 0 -1.430 -1.107
end

python
exponent = 0.1
while (exponent &lt;= 2.01):
    input_parse('''                                                                                                
    basis noprint                                                                                                  
     H library 3-21g; O library 3-21g; O d; %f 1.0                                                                 
    end                                                                                                            
    ''' % (exponent))
    print (' exponent = %5.4f,' % exponent, ', energy = %16.10f' % task_energy('scf'))
    exponent = exponent + 0.1
end

print none

task python
</code></pre>
<p>This program augments a 3-21g basis for water with a d-function on
oxygen and varies the exponent from 0.1 to 2.0 in steps of 0.1, printing
the exponent and energy at each step.</p>
<p>The geometry is input as usual, but the basis set input is embedded
inside a call to <code>input_parse()</code> in the Python program. The standard
Python string substitution is used to put the current value of the
exponent into the basis set (replacing the %f) before being parsed by
NWChem. The energy is returned by <code>task_energy('scf')</code> and printed out.
The print none in the NWChem input switches off all NWChem output so all
you will see is the output from your Python program.</p>
<p>Note that execution in parallel may produce unwanted output since all
process execute the print statement inside the Python program.</p>
<p>Look in the NWChem contrib directory for a routine that makes the above
task easier.</p>
<h3 id="scanning-a-basis-exponent-revisited">Scanning a basis exponent revisited<a class="headerlink" href="#scanning-a-basis-exponent-revisited" title="Permanent link">&para;</a></h3>
<pre><code>geometry units au
O 0 0 0; H 0 1.430 -1.107; H 0 -1.430 -1.107
end


python
  if (ga_nodeid() == 0): plotdata = open(&quot;plotdata&quot;,'w')

  def energy_at_exponent(exponent):
    input_parse('''                                                                                                
    basis noprint                                                                                                  
      H library 3-21g; O library 3-21g; O d; %f 1.0                                                                
    end                                                                                                            
    ''' % (exponent))
    return task_energy('scf')

  exponent = 0.1
  while exponent &lt;= 2.01:
    energy = energy_at_exponent(exponent)
    if (ga_nodeid() == 0):
        print (' exponent = %5.4f,' % exponent, ', energy = %16.10f' % energy)
        plotdata.write('%f %f\n' % (exponent , energy))
    exponent = exponent + 0.1

  if (ga_nodeid() == 0): plotdata.close()
end

print none
task python
</code></pre>
<p>This input performs exactly the same calculation as the previous one,
but uses a slightly more sophisticated Python program, also writes the
data out to a file for easy visualization with a package such as
gnuplot, and protects write statements to prevent duplicate output in a
parallel job. The only significant differences are in the Python
program. A file called &ldquo;plotdata&rdquo; is opened, and then a procedure is
defined which given an exponent returns the energy. Next comes the main
loop that scans the exponent through the desired range and prints the
results to standard output and to the file. When the loop is finished
the additional output file is closed.</p>
<h3 id="scanning-a-geometric-variable">Scanning a geometric variable<a class="headerlink" href="#scanning-a-geometric-variable" title="Permanent link">&para;</a></h3>
<pre><code>python
   geometry = '''
     geometry noprint; symmetry d2h
        C 0 0 %f; H 0  0.916 1.224
     end
   '''
   x = 0.6
   while (x &lt; 0.721):
     input_parse(geometry % x)
     energy = task_energy('scf')
     print (' x = %5.2f   energy = %10.6f' % (x, energy))
     x = x + 0.01
end

basis; C library 6-31g*; H library 6-31g*; end

print none

task python
</code></pre>
<p>This scans the bond length in ethene from 1.2 to 1.44 in steps of 0.2
computing the energy at each geometry. Since it is using D<sub>2h</sub>
symmetry the program actually uses a variable (x) that is half the bond
length.</p>
<p>Look in the NWChem contrib directory for a routine that makes the above
task
easier.</p>
<h3 id="scan-using-the-bsse-counterpoise-corrected-energy">Scan using the BSSE counterpoise corrected energy<a class="headerlink" href="#scan-using-the-bsse-counterpoise-corrected-energy" title="Permanent link">&para;</a></h3>
<pre><code>basis spherical
  Ne library cc-pvdz; BqNe library Ne cc-pvdz
  He library cc-pvdz; BqHe library He cc-pvdz
end

mp2; tight; freeze core atomic; end

print none

python
  supermolecule = 'geometry noprint;   Ne 0 0 0;   He 0 0 %f; end\n'
  fragment1     = 'geometry noprint;   Ne 0 0 0; BqHe 0 0 %f; end\n'
  fragment2     = 'geometry noprint; BqNe 0 0 0;   He 0 0 %f; end\n'

  def energy(geometry):
    input_parse(geometry + 'scf; vectors atomic; end\n')
    return task_energy('mp2')

  def bsse_energy(z):
    return energy(supermolecule % z) - \
        energy(fragment1 % z) - \
        energy(fragment2 % z)
  z = 3.3
  while (z &lt; 4.301):
    e = bsse_energy(z)
    if (ga_nodeid() == 0): print (' z = %5.2f   energy = %10.7f ' % (z, e))
    z = z + 0.1
end

task python
</code></pre>
<p>This example scans the He&ndash;Ne bond-length from 3.3 to 4.3 and prints out
the BSSE counterpoise corrected MP2 energy.</p>
<p>The basis set is specified as usual, noting that we will need functions
on ghost centers to do the counterpoise correction. The Python program
commences by defining strings containing the geometry of the
super-molecule and two fragments, each having one variable to be
substituted. Next, a function is defined to compute the energy given a
geometry, and then a function is defined to compute the counterpoise
corrected energy at a given bond length. Finally, the bond length is
scanned and the energy printed. When computing the energy, the atomic
guess has to be forced in the SCF since by default it will attempt to
use orbitals from the previous calculation which is not appropriate
here.</p>
<p>Since the counterpoise corrected energy is a linear combination of other
standard energies, it is possible to compute the analytic derivatives
term by term. Thus, combining this example and the next could yield the
foundation of a BSSE corrected geometry optimization
package.</p>
<h3 id="scan-the-geometry-and-compute-the-energy-and-gradient">Scan the geometry and compute the energy and gradient<a class="headerlink" href="#scan-the-geometry-and-compute-the-energy-and-gradient" title="Permanent link">&para;</a></h3>
<pre><code> basis noprint; H library sto-3g; O library sto-3g; end

 python
 print ('   y     z     energy                gradient')
 print (' ----- ----- ---------- ------------------------------------')
 y = 1.2
 while y &lt;= 1.61:
     z = 1.0
     while z &lt;= 1.21:
         input_parse('''
           geometry noprint units atomic
             O 0   0   0
             H 0  %f -%f
             H 0 -%f -%f
           end
         ''' % (y, z, y, z))

         (energy,gradient) = task_gradient('scf')

         print (' %5.2f %5.2f %9.6f' % (y, z, energy)),
         i = 0
         while (i &lt; len(gradient)):
             print ('%5.2f' % gradient[i]),
             i = i + 1
         print ('')
     z = z + 0.1
 y = y + 0.1
end

print none

task python
</code></pre>
<p>This program illustrates evaluating the energy and gradient by calling
task_gradient(). A water molecule is scanned through several C<sub>2v</sub>
geometries by varying the y and z coordinates of the two hydrogen atoms.
At each geometry the coordinates, energy and gradient are printed.</p>
<p>The basis set (sto-3g) is input as usual. The two while loops vary the y
and z coordinates. These are then substituted into a geometry which is
parsed by NWChem using <code>input_parse()</code>. The energy and gradient are then
evaluated by calling <code>task_gradient()</code> which returns a tuple containing
the energy (a scalar) and the gradient (a vector or list). These are
printed out exploiting the Python convention that a print statement
ending in a comma does not print end-of-line.</p>
<h3 id="reaction-energies-varying-the-basis-set">Reaction energies varying the basis set<a class="headerlink" href="#reaction-energies-varying-the-basis-set" title="Permanent link">&para;</a></h3>
<pre><code>mp2; freeze atomic; end

print none

python
  energies = {}
  c2h4 = 'geometry noprint; symmetry d2h; \
          C 0 0 0.672; H 0 0.935 1.238; end\n'
  ch4  = 'geometry noprint; symmetry td; \
          C 0 0 0; H 0.634 0.634 0.634; end\n'
  h2   = 'geometry noprint; H 0 0 0.378; H 0 0 -0.378; end\n'

  def energy(basis, geometry):
    input_parse('''
      basis spherical noprint
        c library %s ; h library %s 
      end
    ''' % (basis, basis))
    input_parse(geometry)
    return task_energy('mp2')

  for basis in ('sto-3g', '6-31g', '6-31g*', 'cc-pvdz', 'cc-pvtz'):
     energies[basis] =   2*energy(basis, ch4) \
                       - 2*energy(basis, h2) - energy(basis, c2h4)
     if (ga_nodeid() == 0): print (basis, ' %8.6f' % energies[basis])
end 

task python
</code></pre>
<p>In this example the reaction energy for  2H<sub>2</sub> + C<sub>2</sub>H<sub>4</sub> &rarr;
2CH<sub>4</sub> is evaluated using MP2 in several basis sets. The geometries are
fixed, but could be re-optimized in each basis. To illustrate the useful
associative arrays in Python, the reaction energies are put into the
associative array energies &ndash; note its declaration at the top of the
program.</p>
<h3 id="using-the-database">Using the database<a class="headerlink" href="#using-the-database" title="Permanent link">&para;</a></h3>
<pre><code> python  
   rtdb_put(&quot;test_int2&quot;, 22)  
   rtdb_put(&quot;test_int&quot;, [22, 10, 3],    INT)  
   rtdb_put(&quot;test_dbl&quot;, [22.9, 12.4, 23.908],  DBL)  
   rtdb_put(&quot;test_str&quot;, &quot;hello&quot;, CHAR)  
   rtdb_put(&quot;test_logic&quot;, [0,1,0,1,0,1], LOGICAL)  
   rtdb_put(&quot;test_logic2&quot;, 0, LOGICAL)  

   rtdb_print(1)  

   print &quot;test_str    = &quot;, rtdb_get(&quot;test_str&quot;)  
   print &quot;test_int    = &quot;, rtdb_get(&quot;test_int&quot;)  
   print &quot;test_in2    = &quot;, rtdb_get(&quot;test_int2&quot;)  
   print &quot;test_dbl    = &quot;, rtdb_get(&quot;test_dbl&quot;)  
   print &quot;test_logic  = &quot;, rtdb_get(&quot;test_logic&quot;)  
   print &quot;test_logic2 = &quot;, rtdb_get(&quot;test_logic2&quot;)  
 end  

 task python
</code></pre>
<p>This example illustrates how to access the database from Python.</p>
<h3 id="handling-exceptions-from-nwchem">Handling exceptions from NWChem<a class="headerlink" href="#handling-exceptions-from-nwchem" title="Permanent link">&para;</a></h3>
<pre><code> geometry; he 0 0 0; he 0 0 2; end  
 basis; he library 3-21g; end  
 scf; maxiter 1; end  

 python  
   try:  
     task_energy('scf')  
   except NWChemError, message:  
     print 'Error from NWChem ... ', message  
 end  

 task python
</code></pre>
<p>The above test program shows how to handle exceptions generated by
NWChem by forcing an SCF calculation on He<sub>2&lt;\sub&gt; to fail due to
insufficient iterations.</p>
<p>If an NWChem command fails it will raise the exception &ldquo;NWChemError&rdquo;
(case sensitive) unless the error was fatal. If the exception is not
caught, then it will cause the entire Python program to terminate with
an error. This Python program catches the exception, prints out the
message, and then continues as if all was well since the exception has
been handled.</p>
<p>If your Python program detects an error, raise an unhandled exception.
Do not call exit(1) since this may circumvent necessary clean-up of the
NWChem execution environment.</p>
<h3 id="accessing-geometry-information-a-temporary-hack">Accessing geometry information: a temporary hack<a class="headerlink" href="#accessing-geometry-information-a-temporary-hack" title="Permanent link">&para;</a></h3>
<p>In an ideal world the geometry and basis set objects would have full
Python wrappers, but until then a back-door solution will have to
suffice. We&rsquo;ve already seen how to use <code>input_parse()</code> to put geometry
(and basis) data into NWChem, so it only remains to get the geometry
data back after it has been updated by a geometry optimzation or some
other operation.</p>
<p>The following Python procedure retrieves the coordinates in the same
units as initially input for a geometry of a given name. Its full source
is included in the NWChem contrib directory.</p>
<pre><code> def geom_get_coords(name):  
   try:  
     actualname = rtdb_get(name)  
   except NWChemError:  
     actualname = name  
   coords = rtdb_get('geometry:' + actualname + ':coords')  
   units  = rtdb_get('geometry:' + actualname + ':user units')  
   if (units == 'a.u.'):  
     factor = 1.0  
   elif (units == 'angstroms'):  
     factor = rtdb_get('geometry:'+actualname+':angstrom_to_au')  
   else:  
     raise NWChemError,'unknown units'  
   i = 0  
   while (i &lt; len(coords)):  
     coords[i] = coords[i] / factor  
     i = i + 1  
   return coords
</code></pre>
<p>A <a href="Geometry.html">geometry</a> with name NAME has its coordinates (in
atomic units) stored in the database entry <code>geometry:NAME:coords</code>. A minor
wrinkle here is that indirection is possible (and used by the
optimizers) so that we must first check if NAME actually points to
another name. In the program this is done in the first try&hellip;except
sequence. With the actual name of the geometry, we can get the
coordinates. Any exceptions are passed up to the caller. The rest of the
code is just to convert back into the initial input units &ndash; only atomic
units or Angstrøms are handled in this simple example. Returned is a
list of the atomic coordinates in the same units as your initial input.</p>
<p>The routine is used as follows</p>
<pre><code>   coords = geom_get_coords('geometry')
</code></pre>
<p>or, if you want better error handling</p>
<pre><code>   try:  
     coords = geom_get_coords('geometry')  
   except NWChemError,message:  
     print 'Coordinates for geometry not found ', message  
   else:  
     print coords
</code></pre>
<p>This is very dirty and definitely not supported from one release to
another, but, browsing the output of <code>rtdb_print()</code> at the end of a
calculation is a good way to find stuff. To be on safer ground, look in
the programmers manual since some of the high-level routines do pass
data via the database in a well-defined and supported manner. Be warned
&ndash; you must be very careful if you try to modify data in the database.
The input parser does many important things that are not immediately
apparent (e.g., ensure the geometry is consistent with the point group,
mark the SCF as not converged if the SCF options are changed, &hellip;).
Where at all possible your Python program should generate standard
NWChem input and pass it to <code>input_parse()</code> rather than setting
parameters directly in the
database.</p>
<h3 id="scaning-a-basis-exponent-yet-again-plotting-and-handling-child-processes">Scaning a basis exponent yet again: plotting and handling child processes<a class="headerlink" href="#scaning-a-basis-exponent-yet-again-plotting-and-handling-child-processes" title="Permanent link">&para;</a></h3>
<pre><code> geometry units au  
   O 0 0 0; H 0 1.430 -1.107; H 0 -1.430 -1.107  
 end  

 print none  

 python  
   import Gnuplot, time, signal  

   def energy_at_exponent(exponent):  
      input_parse('''  
         basis noprint  
            H library 3-21g; O library 3-21g; O d; %f 1.0  
         end  
      ''' % (exponent))  
      return task_energy('scf')  

   data = []  
   exponent = 0.5  
   while exponent &lt;= 0.6:  
      energy = energy_at_exponent(exponent)  
      print ' exponent = ', exponent, ' energy = ', energy  
      data = data + [exponent,energy](exponent,energy.md)  
      exponent = exponent + 0.02  

   if (ga_nodeid() == 0):  
      signal.signal(signal.SIGCHLD, signal.SIG_DFL)  
      g = Gnuplot.Gnuplot()  
      g('set data style linespoints')  
      g.plot(data)  
      time.sleep(30)  # 30s to look at the plot  

 end  

 task python
</code></pre>
<p>This illustrates how to handle signals from terminating child processes
and how to generate simple plots on UNIX systems. The <a href="#scanning-a-basis-exponent-revisited">scanning
example</a> is modified so
that instead of writing the data to a file for subsequent visualization,
it is saved for subsequent visualization with Gnuplot (you&rsquo;ll need both
Gnuplot and the corresponding package for Python in your PYTHONPATH.
Look at <a href="https://web.archive.org/web/20010717060625/http://monsoon.harvard.edu/~mhagger/download/">https://web.archive.org/web/20010717060625/http://monsoon.harvard.edu/~mhagger/download/</a>).</p>
<p>The issue is that NWChem traps various signals from the O/S that usually
indicate bad news in order to provide better error handling and reliable
clean-up of shared, parallel resources. One of these signals is SIGCHLD
which is generated whenever a child process terminates. If you want to
create child processes within Python, then the NWChem handler for
SIGCHLD must be replaced with the default handler. There seems to be no
easy way to restore the NWChem handler after the child has completed,
but this should have no serious side effect.</p>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<p>Common problems with Python programs inside NWChem.</p>
<ol>
<li>You get the message  </li>
</ol>
<pre><code>    0:python_input: indentation must be &gt;= that of first line: 4  
</code></pre>
<pre><code>This indicates that NWChem thinks that a line is less indented than
the first line. If this is not the case then perhaps there is a tab
in your input which NWChem treats as a single space character but
appears to you as more spaces. Try running untabify in Emacs. The
problem could also be the END directive that terminates the PYTHON
compound directive -- since Python also has an end statement. To
avoid confusion the END directive for NWChem must be at the start of
the line.
</code></pre>
<ol>
<li>Your program hangs or deadlocks &ndash; most likely you have a piece of
    code that is restricted to executing on a subset of the processors
    (perhaps just node 0) but is calling (perhaps indirectly) a function
    that must execute on all nodes.</li>
</ol>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="Format_of_MD_Files.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Format of MD files" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Format of MD files
              </div>
            </div>
          </a>
        
        
          
          <a href="Sample.html" class="md-footer__link md-footer__link--next" aria-label="Next: Sample input files" rel="next">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Sample input files
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.top", "navigation.instant", "navigation.tracking", "navigation.indexes", "navigation.footer", "search.highlight", "search.share", "content.action.edit", "content.action.view", "content.code.copy"], "search": "assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.b4d07000.min.js"></script>
      
        <script src="js/print-site.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
      
    
  </body>
</html>