<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://nwchemgit.github.io/Qmmm_NEB_Calculations.html">
  <link rel="shortcut icon" href="img/favicon.ico">
  <title>Qmmm NEB Calculations - NWChem</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="css/theme.css" />
  <link rel="stylesheet" href="css/theme_extra.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Qmmm NEB Calculations";
    var mkdocs_page_input_path = "Qmmm_NEB_Calculations.md";
    var mkdocs_page_url = "/Qmmm_NEB_Calculations.html";
  </script>
  
  <script src="js/jquery-2.1.1.min.js" defer></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="." class="icon icon-home"> NWChem</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Home.html">User Documentation</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Download.html">How to download NWChem</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Quantum-Mechanical-Methods.html">Quantum Mechanical Methods</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Quantum-Molecular-Dynamics.html">Quantum Molecular Dynamics</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Hybrid-Approaches.html">Hybrid Approaches</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Other-Capabilities.html">Other Capabilities</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Examples.html">Examples</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Supplementary-Information.html">Supplementary Information</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Compiling-NWChem.html">How to install NWChem</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Benchmarks.html">Benchmarks performed with NWChem</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Known-Bugs.html">Known Bugs</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Tutorials.html">Tutorials</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Forum.html">Forum</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Archived-Forum.html">Archived Forum</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="EMSL_Arrows.html">EMSL Arrows</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href=".">NWChem</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".">Docs</a> &raquo;</li>
    
      
    
    <li>Qmmm NEB Calculations</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/nwchemgit/nwchem-wiki/blob/master/Qmmm_NEB_Calculations.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>Experimental implementation of Nudged Elastic Band (NEB) method is
available for reaction pathway calculations with QM/MM. The actual
pathway/beads construction involves (by default) only the region
containing QM and link atoms (referred to as qmlink). The rest of the
system plays a passive role and is quenched/optimized each time a
gradient on a bead is calculated.</p>
<p>The initial guess for NEB pathway can be generated using geometries of
the starting and ending point provided by the .rst files. These are set
in the input using the following directive</p>
<pre><code>set qmmm:neb_path_limits xxx_start.rst xxx_end.rst
</code></pre>

<p>where xxx_start.rst xxx_end.rst refers to starting and ending point of
the NEB pathway. Both rst files have to be present at the <strong>top level</strong>
directory. It should be noted that only coordinates of qmlink region
will be used from these two files. The initial coordinates for the rest
of the system come from reference rst file provided in the MD block</p>
<pre><code>md
  system xxx_ref
  ...
end
</code></pre>

<p>Typically this reference restart file ( xxx_ref.rst ) would be a copy
of a restart file for starting or ending point.</p>
<p>The number of beads in the NEB pathway, initial optimization step size,
and number of optimization steps are set using the following directives</p>
<pre><code>set neb:nbeads 10
set neb:stepsize 10
set neb:steps 20
</code></pre>

<p>The calculation starts by constructing initial guess for the pathway
(consisting of a sequence of numbered rst files) by combining linearly
interpolated coordinates of the qmlink regions from starting and ending
rst files and classical coordinates from the reference file. Next phase
involves calculation of the gradients on qmlink region atoms for each of
the beads. This involves two steps. First classical region around the
qmlink region is relaxed following standard QM/MM optimization protocol.
Aside the fact that optimization region cannot be qmlink, all other
optimization directives apply and should be set in the QM/MM block
following standard convention, e.g.</p>
<pre><code>qmmm
 region  solvent
 maxiter 1000
 ncycles 1
 density espfit
end
</code></pre>

<p>or</p>
<pre><code>qmmm
 region  mm_solute solvent
 maxiter 300          1000
 ncycles 3
 density espfit
end
</code></pre>

<p>In both examples presented above we utilized espfit option for density
to speed up calculations. <strong>Note that optimization region cannot be
qmlink!</strong></p>
<p>After the optimization has been performed the gradient on qmlink region
is calculated. The procedure is repeated for all the beads. After that
the bead coordinates will be advanced following NEB protocol and the
entire cycle will be repeated again.</p>
<p>In addition to interpolated initial guess, one can also specify custom
initial path represented by numbered sequence of restart files stored in
the <strong>perm</strong> directory. This behavior will be triggered automatically in
the absence of <em>qmmm:neb_path_limits</em> directive. The default naming of
the custom initial path is of the form <system>XXX.rst, where <system>
is the prefix of reference restart file as defined in MD block and XXX
is the 3-digit integer counter with zero blanks (001,002, &hellip;, 010, 011,
..). If needed the prefix for the custom initial path can be adjusted
using</p>
<p><code>set qmmm:neb_path</code><string prefix></p>
<p>The progress of NEB calculation can be monitored by</p>
<pre><code>grep gnorm &lt;output file&gt;
</code></pre>

<p>Experience shows that the value of gnorm less or around O(10^-2)
indicates converged pathway. The current pathway in the XYZ format can
be found in the output file (look for XYZ FILE string) and viewed as
animation in some of the molecular viewers (e.g.
<a href="http://jmol.sourceforge.net/">JMOL</a>)</p>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/nwchemgit/nwchem-wiki/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
      
    </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
