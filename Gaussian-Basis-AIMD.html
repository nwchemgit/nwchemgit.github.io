<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://nwchemgit.github.io/Gaussian-Basis-AIMD.html" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>Gaussian Basis AIMD - NWChem</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Gaussian Basis AIMD";
        var mkdocs_page_input_path = "Gaussian-Basis-AIMD.md";
        var mkdocs_page_url = "/Gaussian-Basis-AIMD.html";
      </script>
    
    <script src="js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]--> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="." class="icon icon-home"> NWChem
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Home.html">NWChem Manual</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Download.html">How to download and install NWChem</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction </a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Quantum-Mechanical-Methods.html">Quantum Mechanical Methods</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Quantum-Molecular-Dynamics.html">Quantum Molecular Dynamics</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Hybrid-Approaches.html">Hybrid Approaches</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Other-Capabilities.html">Other Capabilities</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Examples.html">NWChem Examples</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Compiling-NWChem.html">How to Compile NWChem</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Benchmarks.html">Benchmarks performed with NWChem</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Known-Bugs.html">Known Bugs</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Tutorials.html">NWChem Tutorials</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Forum.html">Forum</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Archived-Forum.html">Archived Forum</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="EMSL_Arrows.html">EMSL Arrows</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Software-supporting-NWChem.html">Software supporting NWChem</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Supplementary-Information.html">Supplementary Information</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Containers.html">Containers</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href=".">NWChem</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Gaussian Basis AIMD</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/nwchemgit/nwchem-wiki/blob/master/Gaussian-Basis-AIMD.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <div class="toc">
<ul>
<li><a href="#gaussian-basis-aimd">Gaussian Basis AIMD</a><ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#qmd-keywords">QMD Keywords</a><ul>
<li><a href="#dt_nucl-nuclear-time-step">DT_NUCL: Nuclear time step</a></li>
<li><a href="#nstep_nucl-simulation-steps">NSTEP_NUCL: Simulation steps</a></li>
<li><a href="#targ_temp-temperature-of-the-system">TARG_TEMP: Temperature of the system</a></li>
<li><a href="#thermostat-thermostat-for-controling-temperature-of-the-simulation">THERMOSTAT: Thermostat for controling temperature of the simulation</a></li>
<li><a href="#rand_seed-seed-for-the-random-number-generator">RAND_SEED: Seed for the random number generator</a></li>
<li><a href="#com_step-how-often-center-of-mass-translations-and-rotations-are-removed">COM_STEP: How often center-of-mass translations and rotations are removed</a></li>
<li><a href="#print_xyz-how-often-to-print-trajectory-information-to-xyz-file">PRINT_XYZ: How often to print trajectory information to xyz file</a></li>
<li><a href="#linear-flag-for-linear-molecules">LINEAR: Flag for linear molecules</a></li>
<li><a href="#property-how-often-to-calculate-molecular-properties-as-part-of-the-md-simulation">PROPERTY: How often to calculate molecular properties as part of the MD simulation</a></li>
<li><a href="#tddft-how-often-to-peform-tddft-calculation-as-part-of-the-md-simulation">TDDFT: How often to peform TDDFT calculation as part of the MD simulation</a></li>
</ul>
</li>
<li><a href="#sample-input-files">Sample input files</a><ul>
<li><a href="#ground-state-molecular-dynamics">Ground state Molecular Dynamics</a></li>
<li><a href="#excited-state-molecular-dynamics">Excited state Molecular Dynamics</a></li>
<li><a href="#property-calculation-in-a-molecular-dynamics-simulation">Property calculation in a Molecular Dynamics simulation</a></li>
</ul>
</li>
<li><a href="#processing-the-output-of-a-qmd-run">Processing the output of a QMD run</a><ul>
<li><a href="#namd-non-adiabatic-excited-stated-molecular-dynamics">NAMD: Non-adiabatic Excited Stated Molecular Dynamics</a><ul>
<li><a href="#deco-decoherence-flag">DECO: Decoherence flag</a></li>
<li><a href="#dt_elec-electronic-dynamics-time-step">DT_ELEC: Electronic dynamics time step</a></li>
<li><a href="#n_states-number-of-states">N_STATES: Number of states</a></li>
<li><a href="#init_state-initial-state">INIT_STATE: Initial state</a></li>
<li><a href="#tdks-time-dependent-kohn-sham">TDKS: Time-Dependent Kohn-Sham</a></li>
<li><a href="#namd-input-example">NAMD Input Example</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h1 id="gaussian-basis-aimd">Gaussian Basis AIMD<a class="headerlink" href="#gaussian-basis-aimd" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>This module performs adiabatic ab initio molecular dynamics on finite
systems. The nuclei are integrated using the velocity-Verlet algorithm,
and the electronic potential can be provided by any of the Gaussian
basis set based methods in NWChem, e.g. DFT, TDDFT, TCE, MP2, SCF,
MCSCF, etc. If analytic gradients are not available for the selected
level of theory, numerical gradients will automatically be used. Initial
velocities are randomly selected from the Maxwell-Boltzmann distribution
at the specified temperature, unless a restart file (<code>.qmdrst</code>) is
present. If a restart file is present, the trajectory information will
be read from that file and the trajectory will resume from that point.</p>
<p>For computational details and a case study using the module, please
refer to the following paper: S. A. Fischer, T. W. Ueltschi, P. Z.
El-Khoury, A. L. Mifflin, W. P. Hess, H.F. Wang, C. J. Cramer, N. Govind
&ldquo;Infrared and Raman Spectroscopy from Ab Initio Molecular Dynamics and
Static Normal Mode Analysis: The CH Region of DMSO as a Case Study&rdquo; J.
Phys. Chem. B, 120 (8), pp 1429â€“1436 (2016); <a href="https://dx.doi.org/10.1021/acs.jpcb.5b03323">DOI:10.1021/acs.jpcb.5b03323</a>.</p>
<pre><code>QMD
  [dt_nucl &lt;double default 10.0&gt;]  
  [nstep_nucl &lt;integer default 1000&gt;]  
  [targ_temp &lt;double default 298.15&gt;]  
  [thermostat &lt;string default none&gt; &lt;thermostat parameters&gt;]  
  [rand_seed &lt;integer default new one generated for each run&gt;]  
  [com_step &lt;integer default 100&gt;]  
  [print_xyz &lt;integer default 1&gt;]  
  [linear]   
  [property &lt;integer default 1&gt;] 
  [tddft &lt;integer default 1&gt;]
  [namd ]
END
</code></pre>
<p>The module is called as:</p>
<pre><code>task &lt;level of theory&gt; qmd
</code></pre>
<p>where <level of theory> is any Gaussian basis set method in NWChem</p>
<h2 id="qmd-keywords">QMD Keywords<a class="headerlink" href="#qmd-keywords" title="Permanent link">&para;</a></h2>
<h3 id="dt_nucl-nuclear-time-step">DT_NUCL: Nuclear time step<a class="headerlink" href="#dt_nucl-nuclear-time-step" title="Permanent link">&para;</a></h3>
<p>This specifies the nuclear time step in atomic units (1 a.u. = 0.02419
fs).
Default: 10.0 a.u.</p>
<h3 id="nstep_nucl-simulation-steps">NSTEP_NUCL: Simulation steps<a class="headerlink" href="#nstep_nucl-simulation-steps" title="Permanent link">&para;</a></h3>
<p>This specifies the number of steps to take in the nuclear dynamics.<br />
Default: 1000</p>
<h3 id="targ_temp-temperature-of-the-system">TARG_TEMP: Temperature of the system<a class="headerlink" href="#targ_temp-temperature-of-the-system" title="Permanent link">&para;</a></h3>
<p>This specifies the temperature to use with the thermostat. Also it is
used in generating initial velocities from the Maxwell-Boltzmann
distribution.<br />
Default: 298.15 K</p>
<h3 id="thermostat-thermostat-for-controling-temperature-of-the-simulation">THERMOSTAT: Thermostat for controling temperature of the simulation<a class="headerlink" href="#thermostat-thermostat-for-controling-temperature-of-the-simulation" title="Permanent link">&para;</a></h3>
<p>This specifies the thermostat to use for regulating the temperature of
the nuclei. Possible options are:</p>
<ul>
<li><strong>none</strong></li>
</ul>
<p>No thermostat is used, i.e. an NVE ensemble is simulated. Default  </p>
<ul>
<li><strong>svr</strong> <code>&lt;double default 1000.0&gt;</code></li>
</ul>
<p>Stochastic velocity rescaling thermostat of Bussi, Donadio, and Parrinello,
 J. Chem. Phys. 126, 014101 (2007)<br />
   Number sets the relaxation parameter of the thermostat  </p>
<ul>
<li><strong>langevin</strong> <code>&lt;double default 0.1&gt;</code></li>
</ul>
<p>Langevin dynamics, implementation according to Bussi and Parrinello Phys. Rev. E 75, 056707 (2007)<br />
   Number sets the value of the friction  </p>
<ul>
<li><strong>berendsen</strong> <code>&lt;double default 1000.0&gt;</code>  </li>
</ul>
<p>Berendsen thermostat, number sets the relaxation parameter of the thermostat  </p>
<ul>
<li><strong>rescale</strong></li>
</ul>
<p>Velocity rescaling, i.e. isokinetic ensemble  </p>
<h3 id="rand_seed-seed-for-the-random-number-generator">RAND_SEED: Seed for the random number generator<a class="headerlink" href="#rand_seed-seed-for-the-random-number-generator" title="Permanent link">&para;</a></h3>
<p>This specifies the seed for initializing the random number generator. If
not given, a unique random seed will be generated. Even without a
thermostat, this will influence the initial
velocities.</p>
<h3 id="com_step-how-often-center-of-mass-translations-and-rotations-are-removed">COM_STEP: How often center-of-mass translations and rotations are removed<a class="headerlink" href="#com_step-how-often-center-of-mass-translations-and-rotations-are-removed" title="Permanent link">&para;</a></h3>
<p>This specifies that center-of-mass translations and rotations will be
removed every <code>com_step</code> steps. Default 10 COM translations and rotations
are removed on startup (either randomized initial velocities or those
read from the restart file).</p>
<h3 id="print_xyz-how-often-to-print-trajectory-information-to-xyz-file">PRINT_XYZ: How often to print trajectory information to xyz file<a class="headerlink" href="#print_xyz-how-often-to-print-trajectory-information-to-xyz-file" title="Permanent link">&para;</a></h3>
<p>This specifies how often the trajectory information (coordinates, velocities,
total energy, step number, dipole (if available)) is written to the xyz file. The
units for the coordinates and velocities in the xyz file are Angstrom
and Angstrom/fs, respectively.<br />
For example, <code>print_xyz 5</code> will write the xyz trajectory file every 5 steps.<br />
Default: 1 </p>
<h3 id="linear-flag-for-linear-molecules">LINEAR: Flag for linear molecules<a class="headerlink" href="#linear-flag-for-linear-molecules" title="Permanent link">&para;</a></h3>
<p>If present, the code assumes the molecule is linear.</p>
<h3 id="property-how-often-to-calculate-molecular-properties-as-part-of-the-md-simulation">PROPERTY: How often to calculate molecular properties as part of the MD simulation<a class="headerlink" href="#property-how-often-to-calculate-molecular-properties-as-part-of-the-md-simulation" title="Permanent link">&para;</a></h3>
<p>If present, the code will look for the property block and calculate the requested properties.<br />
For example, <code>property 5</code> will calculate properties on the current geometry every 5 steps.<br />
Default: 0 (e.g properties are not computed)  </p>
<h3 id="tddft-how-often-to-peform-tddft-calculation-as-part-of-the-md-simulation">TDDFT: How often to peform TDDFT calculation as part of the MD simulation<a class="headerlink" href="#tddft-how-often-to-peform-tddft-calculation-as-part-of-the-md-simulation" title="Permanent link">&para;</a></h3>
<p>If present, the code will look for the tddft block and calculate the absorption spectrum.<br />
For example, <code>tddft 5</code> will perform tddft calculations on the current geometry every 5 steps.<br />
Default: 0 (e.g tddft is not run)</p>
<h2 id="sample-input-files">Sample input files<a class="headerlink" href="#sample-input-files" title="Permanent link">&para;</a></h2>
<h3 id="ground-state-molecular-dynamics">Ground state Molecular Dynamics<a class="headerlink" href="#ground-state-molecular-dynamics" title="Permanent link">&para;</a></h3>
<p>The following is a sample input for a ground state MD simulation. The
simulation is 200 steps long with a 10 a.u. time step, using the
stochastic velocity rescaling thermostat with a relaxation parameter of
100 a.u. and a target temperature of 200 K. Center-of-mass rotations and
translations will be removed every 10 steps and trajectory information
will be output to the xyz file every 5 steps.</p>
<pre><code>start qmd_dft_h2o_svr  
echo  
print low  
geometry noautosym noautoz  
  O   0.00000000    -0.01681748     0.11334792  
  H   0.00000000     0.81325914    -0.34310308  
  H   0.00000000    -0.67863597    -0.56441201  
end  
basis  
  * library 6-31G*  
end  
dft  
  xc pbe0  
end  
qmd  
  nstep_nucl  200  
  dt_nucl     10.0  
  targ_temp   200.0  
  com_step    10  
  thermostat  svr 100.0  
  print_xyz   5  
end  
task dft qmd
</code></pre>
<h3 id="excited-state-molecular-dynamics">Excited state Molecular Dynamics<a class="headerlink" href="#excited-state-molecular-dynamics" title="Permanent link">&para;</a></h3>
<p>The following is a sample input for an excited state MD simulation on
the first excited state. The simulation is 200 steps long with a 10 a.u.
time step, run in the microcanonical ensemble. Center-of-mass rotations
and translations will be removed every 10 steps and trajectory
information will be output to the xyz file every 5 steps.</p>
<pre><code>start qmd_tddft_h2o_svr  
echo  
print low  
geometry noautosym noautoz  
  O   0.00000000    -0.01681748     0.11334792  
  H   0.00000000     0.81325914    -0.34310308  
  H   0.00000000    -0.67863597    -0.56441201  
end  
basis  
  * library 6-31G*  
end  
dft  
  xc pbe0  
end  
tddft  
  nroots 5  
  notriplet  
  target 1  
  civecs  
  grad  
    root 1  
  end  
end  
qmd  
  nstep_nucl  200  
  dt_nucl     10.0  
  com_step    10  
  thermostat  none  
  print_xyz   5  
end  
task tddft qmd
</code></pre>
<h3 id="property-calculation-in-a-molecular-dynamics-simulation">Property calculation in a Molecular Dynamics simulation<a class="headerlink" href="#property-calculation-in-a-molecular-dynamics-simulation" title="Permanent link">&para;</a></h3>
<p>Thefollowing is a sample input for an MD simulation that compute
polarizability by means of the
<a href="Properties.html#polarizability-computed-with-the-sum-over-orbitals-method">SOS method</a>
at each time step.</p>
<pre><code>start qmd_prop_h2o_svr  
echo  
print low  
geometry noautosym noautoz  
  O   0.00000000    -0.01681748     0.11334792  
  H   0.00000000     0.81325914    -0.34310308  
  H   0.00000000    -0.67863597    -0.56441201  
end  
basis  
  * library 6-31G*  
end  
dft  
  xc pbe0  
end  

qmd  
  nstep_nucl  200  
  dt_nucl     10.0  
  com_step    10  
  thermostat  none  
  print_xyz   5
  property 1
end  

property
 polfromsos
end
task tddft qmd
</code></pre>
<p>Additional sample inputs can be found in $NWCHEM_TOP/QA/tests/qmd_*
(e.g. <a href="https://github.com/nwchemgit/nwchem/tree/master/QA/tests/qmd_dft_h2o_berendsen_props">https://github.com/nwchemgit/nwchem/tree/master/QA/tests/qmd_dft_h2o_berendsen_props</a>)</p>
<h2 id="processing-the-output-of-a-qmd-run">Processing the output of a QMD run<a class="headerlink" href="#processing-the-output-of-a-qmd-run" title="Permanent link">&para;</a></h2>
<p>The xyz file produced by the QMD module contains the velocities (given
in Angstrom/fs), in addition to the coordinates (given in Angstrom). The
comment lines also contain the time step, total energy (atomic units),
and dipole moment (atomic units). In the directory <a href="https://github.com/nwchemgit/nwchem/tree/master/contrib/qmd_tools">$NWCHEM_TOP/contrib/qmd_tools</a>, the code <a href="https://github.com/nwchemgit/nwchem/blob/master/contrib/qmd_tools/qmd_analysis.f90">qmd_analysis.f90</a> will used the xyz trajectory as input to calculate the IR spectrum and
vibrational density of states from Fourier transforms of the dipole and
atomic momenta autocorrelation functions, respectively. The code needs
to be linked to a LAPACK library when compiled; the Makefile in the
directory will compile the code with the LAPACK routines included with
the NWChem source.</p>
<p>Here we compute the IR spectrum and the element-wise breakdown of the
  vibrational density of states for silicon tetrachloride (SiCl<sub>4</sub>). The
following input file was used.</p>
<pre><code>start SiCl4  
echo  
print low  
geometry noautosym noautoz  
  Si              -0.00007905     0.00044148     0.00000001  
  Cl               0.71289590     1.00767685     1.74385011  
  Cl              -2.13658008    -0.00149375    -0.00000001  
  Cl               0.71086735    -2.01430142    -0.00000001  
  Cl               0.71289588     1.00767684    -1.74385011  
end  
basis  
  * library 6-31G  
end  
dft  
  xc hfexch 1.0  
end  
qmd  
  nstep_nucl  20000  
  dt_nucl     10.0  
  targ_temp   20.0  
  com_step    10  
  rand_seed   12345  
  thermostat  none  
end  
task dft qmd
</code></pre>
<p>The IR spectrum and vibrational density of states were generated from
the <a href="qmd_tools.tar.gz">qmd_analysis code</a> with the following
command.</p>
<pre><code>./qmd_analysis -xyz SiCl4.xyz -steps 15000 -skip 5000 -ts 10.0 -temp 20.0 -smax 800 -width 10.0
</code></pre>
<p>where we have skipped the first 5000 steps from the simulation and only
used the data from the last 15000 steps to compute the spectra. The time
step is given as 10 a.u. since that was the time step in the simulation
and we output the trajectory information every step. The temperature was
set to 20 K (for analysis, this is only used in the calculation of the
quantum correction factor for the autocorrelation function of the dipole
moment). The option smax sets the maximum of the spectral window that is
output to 800 wave numbers. The width option sets the full-width at
half-maximum of the peaks in the resulting spectra.</p>
<p>The computed IR spectrum and vibrational density of states are shown
here.</p>
<p><img alt="pic1" src="SiCl4IR.png" />
<img alt="pic2" src="SiCl4VDOS.png" /></p>
<h3 id="namd-non-adiabatic-excited-stated-molecular-dynamics">NAMD: Non-adiabatic Excited Stated Molecular Dynamics<a class="headerlink" href="#namd-non-adiabatic-excited-stated-molecular-dynamics" title="Permanent link">&para;</a></h3>
<p>For  details of the NAMD implementation, please
refer to the following paper:<br />
H. Song, S. A. Fischer, Y. Zhang, C. J. Cramer, S. Mukamel, N. Govind and S. Tretiak,
&ldquo;First Principles Nonadiabatic Excited-State Molecular Dynamics in NWChem&rdquo;,
Journal of Chemical Theory and Computation  16 (10), pp. 6418-6427 (2020);
<a href="https://dx.doi.org/10.1021/acs.jctc.0c00295">DOI:10.1021/acs.jctc.0c00295</a>.</p>
<pre><code>[namd]
  [init_state &lt;integer default 2&gt;]
  [nstates &lt;integer default 2&gt;]
  [dt_elec &lt;double default 0.01&gt;]
  [deco &lt;logical default .false.]
  [tdks &lt;integer default 1&gt;]
[end]  
</code></pre>
<p>In the <code>namd</code> sub-block within the <code>qmd</code> block, please note:</p>
<ul>
<li>The number of roots requested in the tddft block must be at least nstates-1.</li>
<li>The nuclear time step (dt_nucl) must be an integer multiple of the electronic time step (<code>mod(dt_nucl,dt_elec)=0</code>).</li>
</ul>
<h4 id="deco-decoherence-flag">DECO: Decoherence flag<a class="headerlink" href="#deco-decoherence-flag" title="Permanent link">&para;</a></h4>
<p>The <code>deco</code> flag applies the EDC electronic decoherence correction described in the paper:<br />
G. Granucci and M. Persico,
&ldquo;Critical appraisal of the fewest switches algorithm for surface hopping&rdquo;, J. Chem. Phys. 126, 134114 (2007);
<a href="https://dx.doi.org/10.1063/1.2715585">DOI:10.1063/1.2715585</a>.
The default value is <code>.false.</code>, i.e. no decoherence correction is applied.</p>
<h4 id="dt_elec-electronic-dynamics-time-step">DT_ELEC: Electronic dynamics time step<a class="headerlink" href="#dt_elec-electronic-dynamics-time-step" title="Permanent link">&para;</a></h4>
<p>The keyword <code>dt_elec</code> sets the electronic time step in atomic units.</p>
<h4 id="n_states-number-of-states">N_STATES: Number of states<a class="headerlink" href="#n_states-number-of-states" title="Permanent link">&para;</a></h4>
<p>The keyword <code>nstates</code> sets the number of electronic states to include in the calculation, i.e.
the number of states for use with Eq. 5 of the 2020 Song paper.</p>
<h4 id="init_state-initial-state">INIT_STATE: Initial state<a class="headerlink" href="#init_state-initial-state" title="Permanent link">&para;</a></h4>
<p>The keyword <code>init_state</code> sets the initial electronic state to be occupied;
the numbering for this keyword and the output that reports the currently
occupied state runs from 0 (ground state) to <code>nstates-1</code>.
So if you want to start a calculation in the first excited state, you would set
<code>init_state</code> to 1.</p>
<h4 id="tdks-time-dependent-kohn-sham">TDKS: Time-Dependent Kohn-Sham<a class="headerlink" href="#tdks-time-dependent-kohn-sham" title="Permanent link">&para;</a></h4>
<p>The keyword <code>tdks</code> will use Time-Dependent Kohn-Sham instead of the default <a href="Excited-State-Calculations.html#cis-and-rpa-the-tamm-dancoff-approximation">Tamm-Dancoff</a> approximation.<br />
The keyword requires the keyword <a href="Density-Functional-Theory-for-Molecules.html#odft-and-mult-open-shell-systems"><code>odft</code></a>
in the <code>dft</code> input block to work.<br />
It can have two values:</p>
<ul>
<li><code>1</code> (default) selects the alpha spin channel</li>
<li><code>2</code>  selects the beta spin channel</li>
</ul>
<h4 id="namd-input-example">NAMD Input Example<a class="headerlink" href="#namd-input-example" title="Permanent link">&para;</a></h4>
<p>Example input for  fewest-switches surface-hopping (FSSH) approach.</p>
<pre><code>geometry noautosym nocenter
O 0.0000  0.0000  0.1197
H 0.0000  0.7615 -0.4790
H 0.0000 -0.7615 -0.4790
end
basis
* library 6-31G*
end

dft
  xc b3lyp
end

tddft
  nroots 10
  notriplet
  cis
  civecs
  grad
    root 1
  end
end

qmd
  nstep_nucl 50
  dt_nucl 0.5
  targ_temp 300.0
  thermostat svr 500
  namd 
    nstates 5
    init_state 3
    dt_elec 0.1
    deco .true.
  end
end
task tddft qmd
</code></pre>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/nwchemgit/nwchem-wiki" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
    
  </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme_extra.js" defer></script>
    <script src="js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
