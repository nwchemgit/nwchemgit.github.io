<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://nwchemgit.github.io/Gaussian-Basis-AIMD.html">
  <link rel="shortcut icon" href="img/favicon.ico">
  <title>Gaussian Basis AIMD - NWChem</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="css/theme.css" />
  <link rel="stylesheet" href="css/theme_extra.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Gaussian Basis AIMD";
    var mkdocs_page_input_path = "Gaussian-Basis-AIMD.md";
    var mkdocs_page_url = "/Gaussian-Basis-AIMD.html";
  </script>
  
  <script src="js/jquery-2.1.1.min.js" defer></script>
  <script src="js/modernizr-2.8.3.min.js" defer></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="." class="icon icon-home"> NWChem</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Home.html">User Documentation</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Download.html">Download</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Quantum-Mechanical-Methods.html">Quantum Mechanical Methods</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Quantum-Molecular-Dynamics.html">Quantum Molecular Dynamics</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Other-Capabilities.html">Other Capabilities</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Examples.html">Examples</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Supplementary-Information.html">Supplementary Information</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Compiling-NWChem.html">Compiling NWChem from source</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Benchmarks.html">Benchmarks performed with NWChem</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Known-Bugs.html">Known Bugs</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Tutorials.html">Tutorials</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Forum.html">Forum</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Archived-Forum.html">Archived Forum</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href=".">NWChem</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".">Docs</a> &raquo;</li>
    
      
    
    <li>Gaussian Basis AIMD</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/nwchemgit/nwchem-wiki/blob/master/Gaussian-Basis-AIMD.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>This module performs adiabatic ab initio molecular dynamics on finite
systems. The nuclei are integrated using the velocity-Verlet algorithm,
and the electronic potential can be provided by any of the Gaussian
basis set based methods in NWChem, e.g. DFT, TDDFT, TCE, MP2, SCF,
MCSCF, etc. If analytic gradients are not available for the selected
level of theory, numerical gradients will automatically be used. Initial
velocities are randomly selected from the Maxwell-Boltzmann distribution
at the specified temperature, unless a restart file (<code>.qmdrst</code>) is
present. If a restart file is present, the trajectory information will
be read from that file and the trajectory will resume from that point.</p>
<p>For computational details and a case study using the module, please
refer to the following paper: S. A. Fischer, T. W. Ueltschi, P. Z.
El-Khoury, A. L. Mifflin, W. P. Hess, H.F. Wang, C. J. Cramer, N. Govind
&ldquo;Infrared and Raman Spectroscopy from Ab Initio Molecular Dynamics and
Static Normal Mode Analysis: The CH Region of DMSO as a Case Study&rdquo; J.
Phys. Chem. B, 120 (8), pp 1429–1436 (2016), <a href="https://dx.doi.org/10.1021/acs.jpcb.5b03323">DOI:10.1021/acs.jpcb.5b03323</a> (2015).</p>
<pre><code>QMD
  [dt_nucl &lt;double default 10.0&gt;]  
  [nstep_nucl &lt;integer default 1000&gt;]  
  [targ_temp &lt;double default 298.15&gt;]  
  [thermostat &lt;string default none&gt; &lt;thermostat parameters&gt;]  
  [rand_seed &lt;integer default new one generated for each run&gt;]  
  [com_step &lt;integer default 100&gt;]  
  [print_xyz &lt;integer default 1&gt;]  
  [linear]   
  [property &lt;integer default 1&gt;] 
  [tddft &lt;integer default 1&gt;]   
END
</code></pre>

<p>The module is called as:</p>
<pre><code>task &lt;level of theory&gt; qmd
</code></pre>

<p>where <level of theory> is any Gaussian basis set method in NWChem</p>
<h2 id="qmd-keywords">QMD Keywords<a class="headerlink" href="#qmd-keywords" title="Permanent link">&para;</a></h2>
<h3 id="dt_nucl-nuclear-time-step">dt_nucl &ndash; Nuclear time step<a class="headerlink" href="#dt_nucl-nuclear-time-step" title="Permanent link">&para;</a></h3>
<p>This specifies the nuclear time step in atomic units (1 a.u. = 0.02419
fs). Default 10.0 a.u.</p>
<h3 id="nstep_nucl-simulation-steps">nstep_nucl &ndash; Simulation steps<a class="headerlink" href="#nstep_nucl-simulation-steps" title="Permanent link">&para;</a></h3>
<p>This specifies the number of steps to take in the nuclear dynamics.
Default 1000</p>
<h3 id="targ_temp-temperature-of-the-system">targ_temp &ndash; Temperature of the system<a class="headerlink" href="#targ_temp-temperature-of-the-system" title="Permanent link">&para;</a></h3>
<p>This specifies the temperature to use with the thermostat. Also it is
used in generating initial velocities from the Maxwell-Boltzmann
distribution. Default 298.15
K</p>
<h3 id="thermostat-thermostat-for-controling-temperature-of-the-simulation">thermostat &ndash; Thermostat for controling temperature of the simulation<a class="headerlink" href="#thermostat-thermostat-for-controling-temperature-of-the-simulation" title="Permanent link">&para;</a></h3>
<p>This specifies the thermostat to use for regulating the temperature of
the nuclei. Possible options are:</p>
<ul>
<li><strong>none</strong></li>
</ul>
<p>No thermostat is used, i.e. an NVE ensemble is simulated. Default  </p>
<ul>
<li><strong>svr</strong> <code>&lt;double default 1000.0&gt;</code></li>
</ul>
<p>Stochastic velocity rescaling thermostat of Bussi, Donadio, and Parrinello,
 J. Chem. Phys. 126, 014101 (2007)<br />
   Number sets the relaxation parameter of the thermostat  </p>
<ul>
<li><strong>langevin</strong> <code>&lt;double default 0.1&gt;</code></li>
</ul>
<p>Langevin dynamics, implementation according to Bussi and Parrinello Phys. Rev. E 75, 056707 (2007)<br />
   Number sets the value of the friction  </p>
<ul>
<li><strong>berendsen</strong> <code>&lt;double default 1000.0&gt;</code>  </li>
</ul>
<p>Berendsen thermostat, number sets the relaxation parameter of the thermostat  </p>
<ul>
<li><strong>rescale</strong></li>
</ul>
<p>Velocity rescaling, i.e. isokinetic ensemble  </p>
<h3 id="rand_seed-seed-for-the-random-number-generator">rand_seed &ndash; Seed for the random number generator<a class="headerlink" href="#rand_seed-seed-for-the-random-number-generator" title="Permanent link">&para;</a></h3>
<p>This specifies the seed for initializing the random number generator. If
not given, a unique random seed will be generated. Even without a
thermostat, this will influence the initial
velocities.</p>
<h3 id="com_step-how-often-center-of-mass-translations-and-rotations-are-removed">com_step &ndash; How often center-of-mass translations and rotations are removed<a class="headerlink" href="#com_step-how-often-center-of-mass-translations-and-rotations-are-removed" title="Permanent link">&para;</a></h3>
<p>This specifies that center-of-mass translations and rotations will be
removed every com_step steps. Default 10 COM translations and rotations
are removed on startup (either randomized initial velocities or those
read from the restart file).</p>
<h3 id="print_xyz-how-often-to-print-trajectory-information-to-xyz-file">print_xyz &ndash; How often to print trajectory information to xyz file<a class="headerlink" href="#print_xyz-how-often-to-print-trajectory-information-to-xyz-file" title="Permanent link">&para;</a></h3>
<p>This specifies that the trajectory information (coordinates, velocities,
total energy, step number, dipole (if available)) to the xyz file. The
units for the coordinates and velocities in the xyz file are Angstrom
and Angstrom/fs, respectively.</p>
<h3 id="linear-flag-for-linear-molecules">linear &ndash; Flag for linear molecules<a class="headerlink" href="#linear-flag-for-linear-molecules" title="Permanent link">&para;</a></h3>
<p>If present, the code assumes the molecule is linear.</p>
<h3 id="property-how-often-to-calculate-molecular-properties-as-part-of-the-md-simulation">property &ndash; How often to calculate molecular properties as part of the MD simulation<a class="headerlink" href="#property-how-often-to-calculate-molecular-properties-as-part-of-the-md-simulation" title="Permanent link">&para;</a></h3>
<p>If present, the code will look for the property block and calculate the requested properties.<br />
For example, property 5 will calculate properties on the current geometry every 5 steps.  </p>
<h3 id="tddft-how-often-to-peform-tddft-calculation-as-part-of-the-md-simulation">tddft &ndash; How often to peform TDDFT calculation as part of the MD simulation<a class="headerlink" href="#tddft-how-often-to-peform-tddft-calculation-as-part-of-the-md-simulation" title="Permanent link">&para;</a></h3>
<p>If present, the code will look for the tddft block and calculate the absorption spectrum.<br />
For example, tddft 5 will perform tddft calculations on the current geometry every 5 steps.    </p>
<h2 id="sample-input">Sample input<a class="headerlink" href="#sample-input" title="Permanent link">&para;</a></h2>
<p>The following is a sample input for a ground state MD simulation. The
simulation is 200 steps long with a 10 a.u. time step, using the
stochastic velocity rescaling thermostat with a relaxation parameter of
100 a.u. and a target temperature of 200 K. Center-of-mass rotations and
translations will be removed every 10 steps and trajectory information
will be output to the xyz file every 5 steps.</p>
<pre><code>start qmd_dft_h2o_svr  
echo  
print low  
geometry noautosym noautoz  
  O   0.00000000    -0.01681748     0.11334792  
  H   0.00000000     0.81325914    -0.34310308  
  H   0.00000000    -0.67863597    -0.56441201  
end  
basis  
  * library 6-31G*  
end  
dft  
  xc pbe0  
end  
qmd  
  nstep_nucl  200  
  dt_nucl     10.0  
  targ_temp   200.0  
  com_step    10  
  thermostat  svr 100.0  
  print_xyz   5  
end  
task dft qmd
</code></pre>

<p>The following is a sample input for an excited state MD simulation on
the first excited state. The simulation is 200 steps long with a 10 a.u.
time step, run in the microcanonical ensemble. Center-of-mass rotations
and translations will be removed every 10 steps and trajectory
information will be output to the xyz file every 5 steps.</p>
<pre><code>start qmd_tddft_h2o_svr  
echo  
print low  
geometry noautosym noautoz  
  O   0.00000000    -0.01681748     0.11334792  
  H   0.00000000     0.81325914    -0.34310308  
  H   0.00000000    -0.67863597    -0.56441201  
end  
basis  
  * library 6-31G*  
end  
dft  
  xc pbe0  
end  
tddft  
  nroots 5  
  notriplet  
  target 1  
  civecs  
  grad  
    root 1  
  end  
end  
qmd  
  nstep_nucl  200  
  dt_nucl     10.0  
  com_step    10  
  thermostat  none  
  print_xyz   5  
end  
task tddft qmd
</code></pre>

<p>Additional sample inputs can be found in $NWCHEM_TOP/QA/tests/qmd_*</p>
<h2 id="processing-the-output-of-a-qmd-run">Processing the output of a QMD run<a class="headerlink" href="#processing-the-output-of-a-qmd-run" title="Permanent link">&para;</a></h2>
<p>The xyz file produced by the QMD module contains the velocities (given
in Angstrom/fs), in addition to the coordinates (given in Angstrom). The
comment lines also contain the time step, total energy (atomic units),
and dipole moment (atomic units). In $NWCHEM_TOP/contrib/qmd_tools is a
code that will take the xyz trajectory and calculate the IR spectrum and
vibrational density of states from Fourier transforms of the dipole and
atomic momenta autocorrelation functions, respectively. The code needs
to be linked to a LAPACK library when compiled; the Makefile in the
directory will compile the code with the LAPACK routines included with
the NWChem source.</p>
<p>Here we compute the IR spectrum and the element-wise breakdown of the
vibrational density of states for silicon tetrachloride (SiCl4). The
following input file was used.</p>
<pre><code>start SiCl4  
echo  
print low  
geometry noautosym noautoz  
  Si              -0.00007905     0.00044148     0.00000001  
  Cl               0.71289590     1.00767685     1.74385011  
  Cl              -2.13658008    -0.00149375    -0.00000001  
  Cl               0.71086735    -2.01430142    -0.00000001  
  Cl               0.71289588     1.00767684    -1.74385011  
end  
basis  
  * library 6-31G  
end  
dft  
  xc hfexch 1.0  
end  
qmd  
  nstep_nucl  20000  
  dt_nucl     10.0  
  targ_temp   20.0  
  com_step    10  
  rand_seed   12345  
  thermostat  none  
end  
task dft qmd
</code></pre>

<p>The IR spectrum and vibrational density of states were generated from
the <a href="qmd_tools.tar.gz">qmd_analysis code</a> with the following
command.</p>
<pre><code>./qmd_analysis -xyz SiCl4.xyz -steps 15000 -skip 5000 -ts 10.0 -temp 20.0 -smax 800 -width 10.0
</code></pre>

<p>where we have skipped the first 5000 steps from the simulation and only
used the data from the last 15000 steps to compute the spectra. The time
step is given as 10 a.u. since that was the time step in the simulation
and we output the trajectory information every step. The temperature was
set to 20 K (for analysis, this is only used in the calculation of the
quantum correction factor for the autocorrelation function of the dipole
moment). The option smax sets the maximum of the spectral window that is
output to 800 wave numbers. The width option sets the full-width at
half-maximum of the peaks in the resulting spectra.</p>
<p>The computed IR spectrum and vibrational density of states are shown
here.</p>
<p><img alt="pic1" src="SiCl4IR.png" /> 
<img alt="pic2" src="SiCl4VDOS.png" /></p>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/nwchemgit/nwchem-wiki/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
      
    </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
