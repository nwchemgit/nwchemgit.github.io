<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://nwchemgit.github.io/ARMCI.html" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>Choosing the ARMCI Library - NWChem</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Choosing the ARMCI Library";
        var mkdocs_page_input_path = "ARMCI.md";
        var mkdocs_page_url = "/ARMCI.html";
      </script>
    
    <script src="js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]--> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="." class="icon icon-home"> NWChem
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Home.html">NWChem Manual</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Download.html">How to download and install NWChem</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction </a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Quantum-Mechanical-Methods.html">Quantum Mechanical Methods</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Quantum-Molecular-Dynamics.html">Quantum Molecular Dynamics</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Hybrid-Approaches.html">Hybrid Approaches</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Other-Capabilities.html">Other Capabilities</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Examples.html">NWChem Examples</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Compiling-NWChem.html">How to Compile NWChem</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Benchmarks.html">Benchmarks performed with NWChem</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Known-Bugs.html">Known Bugs</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Tutorials.html">NWChem Tutorials</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Forum.html">Forum</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Archived-Forum.html">Archived Forum</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="EMSL_Arrows.html">EMSL Arrows</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Software-supporting-NWChem.html">Software supporting NWChem</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Supplementary-Information.html">Supplementary Information</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Containers.html">Containers</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href=".">NWChem</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="." class="icon icon-home" alt="Docs"></a> &raquo;</li><li>Choosing the ARMCI Library</li>
    <li class="wy-breadcrumbs-aside">
        <a href="https://github.com/nwchemgit/nwchem-wiki/blob/master/ARMCI.md"
          class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="choosing-the-armci-library">Choosing the ARMCI Library<a class="headerlink" href="#choosing-the-armci-library" title="Permanent link">&para;</a></h1>
<p>The Global Arrays parallel environment relies upon a one-sided
communication runtime system. There are at least three options currently
available:</p>
<ul>
<li>ARMCI - This is the original one-sided library developed with Global
    Arrays by PNNL. It supports the widest range of platforms. See
    <a href="http://hpc.pnl.gov/globalarrays/support.shtml">http://hpc.pnl.gov/globalarrays/support.shtml</a> for details.</li>
<li>ComEx - This library is being developed by PNNL to replace ARMCI. It
    supports the fewer platforms than ARMCI but may be more robust on
    modern ones like InfiniBand. See
    <a href="http://hpc.pnl.gov/globalarrays/support.shtml">http://hpc.pnl.gov/globalarrays/support.shtml</a> for details.</li>
<li>ARMCI-MPI - This library is a completely separate implementation of
    the ARMCI interface by Argonne and Intel. It uses the one-sided
    communication features of MPI, rather than a platform-specific
    conduit. It currents provides both MPI-2 and MPI-3 implementations;
    the MPI-3 one is supported by nearly all platforms. See
    <a href="https://wiki.mpich.org/armci-mpi/index.php/Main_Page">https://wiki.mpich.org/armci-mpi/index.php/Main_Page</a> for details.</li>
</ul>
<p>By default, Global Arrays will choose ARMCI or ComEx, based upon the
environment variables selected by the user (see GA documentation for
details). When a native implementation is available and works reliably,
this is the best option for the NWChem user. However, in cases where an
native implementation of ARMCI is not available or is not reliable, the
user should consider using one of the MPI-based implementations.</p>
<p>There are many different ways to use MPI as the communication runtime of
Global Arrays:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">ARMCI_NETWORK</th>
<th style="text-align: left;">Result</th>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>MPI-PR</code></td>
<td style="text-align: left;">ARMCI with progress rank</td>
<td style="text-align: left;">Recommended, except on Blue Gene/Q.</td>
</tr>
<tr>
<td style="text-align: left;"><code>MPI-PT</code></td>
<td style="text-align: left;">ARMCI with progress thread</td>
<td style="text-align: left;">Appropriate for Blue Gene/Q.</td>
</tr>
<tr>
<td style="text-align: left;"><code>MPI-MT</code></td>
<td style="text-align: left;">ARMCI over multi-threaded MPI</td>
<td style="text-align: left;"><a href="https://github.com/open-mpi/ompi/issues/157">Do not use Open-MPI 1.x.</a></td>
</tr>
<tr>
<td style="text-align: left;"><code>MPI-TS</code></td>
<td style="text-align: left;">ARMCI over MPI without data server</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><code>MPI-SPAWN</code></td>
<td style="text-align: left;">ARMCI using MPI dynamic processes</td>
<td style="text-align: left;">Requires MPI_Comm_spawn support.</td>
</tr>
<tr>
<td style="text-align: left;"><code>ARMCI</code></td>
<td style="text-align: left;">Uses ARMCI-MPI</td>
<td style="text-align: left;">See <a href="https://wiki.mpich.org/armci-mpi/index.php/NWChem">the ARMCI-MPI NWChem page</a> for details.</td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;">(please use <em>mpi3rma</em> branch)</td>
<td style="text-align: left;">requires <code>EXTERNAL_ARMCI_PATH</code></td>
</tr>
</tbody>
</table>
<p>It is difficult to provide complete guidance to the user as to which
option to choose. However, we observe the following:</p>
<ul>
<li><code>ARMCI_NETWORK=MPI-PR</code> is stable and performs well on many platforms
    (including Cray XC platforms, e.g. NERSC Cori). This port will use
    one processes on each node for communication, therefore subtracting
    one process (again on each node) for NWChem. Therefore, when
    executing on a single node (i.e. the case of desktop execution) you
    would need to ask for n+1 processes; in other words, a serial
    execution would require the following mpirun invocation <code>mpirun -np 2 ...</code>  </li>
<li>On Intel True Scale and Omni Path systems, <code>MPI-PR</code> is more reliable
    than <code>OPENIB</code> or <code>MPI-SPAWN</code>. <code>ARMCI-MPI</code> with Casper and Intel MPI is
    also recommended. See <a href="https://github.com/jeffhammond/HPCInfo/blob/master/ofi/NWChem-OPA.md">this page</a>
    for details. Contact <a href="mailto:jeff.science@gmail.com&gt;">Jeff Hammond</a>
    for assistance.</li>
<li>On IBM Blue Gene/Q, one must use the <em>mpi2rma</em> branch of <code>ARMCI-MPI</code>
    because MPI-3 is not fully supported. On all other platforms, the
    <code>ARMCI-MPI</code> branch <em>mpi3rma</em> is recommended.</li>
<li>The performance of <code>ARMCI-MPI</code> is greatly enhanced by
    <a href="http://www.mcs.anl.gov/project/casper/">Casper</a>. See <a href="https://pmodels.github.io/casper-www/publication.html">this
    link</a> 
    for design details and <a href="https://wiki.mpich.org/armci-mpi/index.php/Casper">this
    page</a> for
    instructions on how to use it.</li>
</ul>
<p>When using ARMCI-MPI, please make sure to use the most recent version of
MPI (MPICH 3.2+, Cray MPI 7.2+, MVAPICH2 2.0+, Intel MPI 5.1+, Open-MPI
2.0+). Older versions of MPI are known to have bugs in the MPI-3 RMA
features that affect the correctness of NWChem.</p>
<h2 id="support">Support<a class="headerlink" href="#support" title="Permanent link">&para;</a></h2>
<p>Global Arrays, ARMCI and ComEx are developed and supported by PNNL. The
user list for support is <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#104;&#112;&#99;&#116;&#111;&#111;&#108;&#115;&#64;&#103;&#111;&#111;&#103;&#108;&#101;&#103;&#114;&#111;&#117;&#112;&#115;&#46;&#99;&#111;&#109;">&#104;&#112;&#99;&#116;&#111;&#111;&#108;&#115;&#64;&#103;&#111;&#111;&#103;&#108;&#101;&#103;&#114;&#111;&#117;&#112;&#115;&#46;&#99;&#111;&#109;</a>.</p>
<p>ARMCI-MPI is developed by Argonne and Intel. All ARMCI-MPI questions
should be directed to <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#97;&#114;&#109;&#99;&#105;&#45;&#100;&#105;&#115;&#99;&#117;&#115;&#115;&#64;&#108;&#105;&#115;&#116;&#115;&#46;&#109;&#112;&#105;&#99;&#104;&#46;&#111;&#114;&#103;">&#97;&#114;&#109;&#99;&#105;&#45;&#100;&#105;&#115;&#99;&#117;&#115;&#115;&#64;&#108;&#105;&#115;&#116;&#115;&#46;&#109;&#112;&#105;&#99;&#104;&#46;&#111;&#114;&#103;</a>. <em>ARMCI-MPI is not
an Intel product.</em></p>
<h2 id="automated-installation-of-armci-mpi">Automated installation of ARMCI-MPI<a class="headerlink" href="#automated-installation-of-armci-mpi" title="Permanent link">&para;</a></h2>
<p>If you wish to use ARMCI-MPI, a script is available to automatically
install it:</p>
<pre><code>cd $NWCHEM_TOP/tools &amp;&amp; ./install-armci-mpi
</code></pre>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/nwchemgit/nwchem-wiki" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
    
  </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme_extra.js" defer></script>
    <script src="js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
