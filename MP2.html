
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="NWChem Website">
      
      
      
        <link rel="canonical" href="https://nwchemgit.github.io/MP2.html">
      
      
        <link rel="prev" href="TCE.html">
      
      
        <link rel="next" href="CCSD.html">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.2">
    
    
      
        <title>MP2 - NWChem</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.7bf56d0a.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Lato";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mp2" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="NWChem" class="md-header__button md-logo" aria-label="NWChem" data-md-component="logo">
      
  <img src="assets/MS3logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NWChem
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              MP2
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/nwchemgit/nwchem-wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="NWChem" class="md-nav__button md-logo" aria-label="NWChem" data-md-component="logo">
      
  <img src="assets/MS3logo.png" alt="logo">

    </a>
    NWChem
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nwchemgit/nwchem-wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Home.html" class="md-nav__link">
        NWChem Manual
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          How to get NWChem
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          How to get NWChem
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Download.html" class="md-nav__link">
        How to download and install NWChem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Compiling-NWChem.html" class="md-nav__link">
        Compiling NWChem from source
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Introduction 
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Introduction 
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Getting-Started.html" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="NWChem-Architecture.html" class="md-nav__link">
        NWChem Architecture
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Capabilities.html" class="md-nav__link">
        Functionalities
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Top-level.html" class="md-nav__link">
        Top-level Directives
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Geometry.html" class="md-nav__link">
        Geometries
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Basis.html" class="md-nav__link">
        Basis sets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="ECP.html" class="md-nav__link">
        Effective Core Potentials
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Relativistic-All-electron-Approximations.html" class="md-nav__link">
        Relativistic all-electron approximations
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
          Quantum-Mechanical-Methods
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Quantum-Mechanical-Methods
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Hartree-Fock-Theory-for-Molecules.html" class="md-nav__link">
        Hartree-Fock
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Density-Functional-Theory-for-Molecules.html" class="md-nav__link">
        Density Functional Theory (DFT)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Excited-State-Calculations.html" class="md-nav__link">
        CIS, TDHF, TDDFT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="RT-TDDFT.html" class="md-nav__link">
        Real-time TDDFT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Plane-Wave-Density-Functional-Theory.html" class="md-nav__link">
        Plane-Wave Density Functional Theory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="TCE.html" class="md-nav__link">
        Tensor Contraction Engine Module: CI, MBPT, and CC
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          MP2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="MP2.html" class="md-nav__link md-nav__link--active">
        MP2
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#freeze-freezing-orbitals" class="md-nav__link">
    FREEZE: Freezing orbitals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tight-increased-precision" class="md-nav__link">
    TIGHT: Increased precision
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scratchdisk-limiting-io-usage" class="md-nav__link">
    SCRATCHDISK: Limiting I/O usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#print-and-noprint" class="md-nav__link">
    PRINT and NOPRINT
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vectors-mo-vectors" class="md-nav__link">
    VECTORS: MO vectors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ri-mp2-fitting-basis" class="md-nav__link">
    RI-MP2 fitting basis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file3c-ri-mp2-3-center-integral-filename" class="md-nav__link">
    FILE3C: RI-MP2 3-center integral filename
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#riapprox-ri-mp2-approximation" class="md-nav__link">
    RIAPPROX: RI-MP2 Approximation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-options-for-ri-mp2" class="md-nav__link">
    Advanced options for RI-MP2
  </a>
  
    <nav class="md-nav" aria-label="Advanced options for RI-MP2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#control-of-linear-dependence" class="md-nav__link">
    Control of linear dependence
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reference-spin-mapping-for-ri-mp2-calculations" class="md-nav__link">
    Reference Spin Mapping for RI-MP2 Calculations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batch-sizes-for-the-ri-mp2-calculation" class="md-nav__link">
    Batch Sizes for the RI-MP2 Calculation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy-memory-allocation-mode-ri-mp2-calculation" class="md-nav__link">
    Energy Memory Allocation Mode: RI-MP2 Calculation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-memory-usage-in-three-center-transformation" class="md-nav__link">
    Local Memory Usage in Three-Center Transformation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#one-electron-properties-and-natural-orbitals" class="md-nav__link">
    One-electron properties and natural orbitals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scs-mp2-spin-component-scaled-mp2" class="md-nav__link">
    SCS-MP2: Spin-Component Scaled MP2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="CCSD.html" class="md-nav__link">
        Coupled Cluster Calculations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Multiconfiguration_SCF.html" class="md-nav__link">
        MCSCF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="GW.html" class="md-nav__link">
        Molecular GW
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_11" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
          Quantum Molecular Dynamics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Quantum Molecular Dynamics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Plane-Wave-Density-Functional-Theory.html" class="md-nav__link">
        Plane-Wave Density Functional Theory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Gaussian-Basis-AIMD.html" class="md-nav__link">
        Gaussian Basis AIMD
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_12" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
          Hybrid Approaches
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          Hybrid Approaches
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Solvation-Models.html" class="md-nav__link">
        Solvation Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="VEM-Model.html" class="md-nav__link">
        VEM (Vertical Excitation or Emission) Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ONIOM.html" class="md-nav__link">
        Hybrid Calculations with ONIOM
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_12_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_12_4" id="__nav_12_4_label" tabindex="0">
          QMMM
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_12_4">
          <span class="md-nav__icon md-icon"></span>
          QMMM
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="qmmm_introduction.html" class="md-nav__link">
        QMMM Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM.html" class="md-nav__link">
        QMMM table of contents
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_12_4_3" >
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_12_4_3" id="__nav_12_4_3_label" tabindex="0">
          QMMM Restart and Topology Files
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_12_4_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_12_4_3">
          <span class="md-nav__icon md-icon"></span>
          QMMM Restart and Topology Files
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Restart_and_Topology_Files.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Preparation_Prerequisites.html" class="md-nav__link">
        QMMM Preparation Prerequisites
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_preparation_basic.html" class="md-nav__link">
        Qmmm preparation basic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_preparation_solvation.html" class="md-nav__link">
        Qmmm preparation solvation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_preparation_constraints.html" class="md-nav__link">
        Qmmm preparation constraints
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_12_4_4" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_12_4_4" id="__nav_12_4_4_label" tabindex="0">
          QMMM Input File
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_12_4_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_12_4_4">
          <span class="md-nav__icon md-icon"></span>
          QMMM Input File
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Input_File.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_QM_Parameters.html" class="md-nav__link">
        QM_Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_MM_Parameters.html" class="md-nav__link">
        QMMM MM Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_QMMM_Parameters.html" class="md-nav__link">
        QM/MM parameters
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_12_4_5" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_12_4_5" id="__nav_12_4_5_label" tabindex="0">
          QMMMM Single Point Calculations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_12_4_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_12_4_5">
          <span class="md-nav__icon md-icon"></span>
          QMMMM Single Point Calculations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="qmmm_sp_energy.html" class="md-nav__link">
        QMMM Ground State Energy and Gradient
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Excited_States.html" class="md-nav__link">
        QMMM Excited State Energy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="qmmm_sp_property.html" class="md-nav__link">
        QMMM Properties
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_ESP.html" class="md-nav__link">
        QMMM ESP Charge Analysis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_12_4_6" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_12_4_6" id="__nav_12_4_6_label" tabindex="0">
          QMMM Potential Energy Surface Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_12_4_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_12_4_6">
          <span class="md-nav__icon md-icon"></span>
          QMMM Potential Energy Surface Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_optimization.html" class="md-nav__link">
        QMMM Optimization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Transition_States.html" class="md-nav__link">
        QMMM Transition States
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_freq.html" class="md-nav__link">
        QMMM Hessians and Frequency
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_NEB_Calculations.html" class="md-nav__link">
        QMMM Reaction Pathway Calculations with NEB
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Dynamics.html" class="md-nav__link">
        QMMM Dynamics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Free_Energy.html" class="md-nav__link">
        QMMM Free Energy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Appendix.html" class="md-nav__link">
        QMMM Apppendix
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Bq.html" class="md-nav__link">
        Point charges
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="1D-RISM.html" class="md-nav__link">
        1-D RISM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_13" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
          Potential Energy Surface Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          Potential Energy Surface Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Geometry-Optimization.html" class="md-nav__link">
        Geometry Optimization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Hessians-and-Vibrational-Frequencies.html" class="md-nav__link">
        Hessians
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Constraints.html" class="md-nav__link">
        Constraints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Nudged-Elastic-Band-and-Zero-Temperature-String-Methods.html" class="md-nav__link">
        Nudged Elastic Band (NEB) method
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_14" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
          Electronic Structure Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_14">
          <span class="md-nav__icon md-icon"></span>
          Electronic Structure Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Properties.html" class="md-nav__link">
        Properties
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ESP.html" class="md-nav__link">
        Electrostatic potentials
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="DPLOT.html" class="md-nav__link">
        DPLOT
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_15" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
          Other-Capabilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_15">
          <span class="md-nav__icon md-icon"></span>
          Other-Capabilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Electron-Transfer.html" class="md-nav__link">
        Electron Transfer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Python.html" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Quantum.html" class="md-nav__link">
        Quantum
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="VSCF.html" class="md-nav__link">
        Vibrational SCF (VSCF)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="CCCA_method.html" class="md-nav__link">
        Correlation consistent Composite Approach (ccCA)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Interface.html" class="md-nav__link">
        Interfaces to Other Programs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_16" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
          Molecular Mechanics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_16">
          <span class="md-nav__icon md-icon"></span>
          Molecular Mechanics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Prepare.html" class="md-nav__link">
        Prepare
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="MD.html" class="md-nav__link">
        MD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Analysis.html" class="md-nav__link">
        Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Format_of_MD_Files.html" class="md-nav__link">
        Format of MD files
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Python.html" class="md-nav__link">
        Controlling NWChem with Python
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_18" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_18" id="__nav_18_label" tabindex="0">
          NWChem Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_18_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_18">
          <span class="md-nav__icon md-icon"></span>
          NWChem Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Sample.html" class="md-nav__link">
        Sample input files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Geometry-examples.html" class="md-nav__link">
        Examples of geometries using symmetry
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Benchmarks.html" class="md-nav__link">
        Benchmarks performed with NWChem
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Known-Bugs.html" class="md-nav__link">
        Known Bugs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="FAQ.html" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Tutorials.html" class="md-nav__link">
        NWChem Tutorials
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Forum.html" class="md-nav__link">
        Forum
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Archived-Forum.html" class="md-nav__link">
        Archived Forum
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="EMSL_Arrows.html" class="md-nav__link">
        EMSL Arrows
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_26" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_26" id="__nav_26_label" tabindex="0">
          Supplementary Information
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_26_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_26">
          <span class="md-nav__icon md-icon"></span>
          Supplementary Information
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://hpc.pnl.gov/globalarrays/" class="md-nav__link">
        Global Arrays
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ARMCI.html" class="md-nav__link">
        Choosing the ARMCI Library
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Interfaces-with-External-Software.html" class="md-nav__link">
        Interfaces with External Software
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Software-supporting-NWChem.html" class="md-nav__link">
        Software supporting NWChem
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Containers.html" class="md-nav__link">
        Containers
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://nwchemgit.github.io/nwchemusermanual.pdf" class="md-nav__link">
        Documentation in PDF format
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#freeze-freezing-orbitals" class="md-nav__link">
    FREEZE: Freezing orbitals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tight-increased-precision" class="md-nav__link">
    TIGHT: Increased precision
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scratchdisk-limiting-io-usage" class="md-nav__link">
    SCRATCHDISK: Limiting I/O usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#print-and-noprint" class="md-nav__link">
    PRINT and NOPRINT
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vectors-mo-vectors" class="md-nav__link">
    VECTORS: MO vectors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ri-mp2-fitting-basis" class="md-nav__link">
    RI-MP2 fitting basis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file3c-ri-mp2-3-center-integral-filename" class="md-nav__link">
    FILE3C: RI-MP2 3-center integral filename
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#riapprox-ri-mp2-approximation" class="md-nav__link">
    RIAPPROX: RI-MP2 Approximation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-options-for-ri-mp2" class="md-nav__link">
    Advanced options for RI-MP2
  </a>
  
    <nav class="md-nav" aria-label="Advanced options for RI-MP2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#control-of-linear-dependence" class="md-nav__link">
    Control of linear dependence
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reference-spin-mapping-for-ri-mp2-calculations" class="md-nav__link">
    Reference Spin Mapping for RI-MP2 Calculations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batch-sizes-for-the-ri-mp2-calculation" class="md-nav__link">
    Batch Sizes for the RI-MP2 Calculation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy-memory-allocation-mode-ri-mp2-calculation" class="md-nav__link">
    Energy Memory Allocation Mode: RI-MP2 Calculation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-memory-usage-in-three-center-transformation" class="md-nav__link">
    Local Memory Usage in Three-Center Transformation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#one-electron-properties-and-natural-orbitals" class="md-nav__link">
    One-electron properties and natural orbitals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scs-mp2-spin-component-scaled-mp2" class="md-nav__link">
    SCS-MP2: Spin-Component Scaled MP2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/nwchemgit/nwchem-wiki/edit/master/MP2.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/nwchemgit/nwchem-wiki/raw/master/MP2.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5Z"/></svg>
    </a>
  


<h1 id="mp2">MP2<a class="headerlink" href="#mp2" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>There are (at least) three algorithms within NWChem that compute the
Mller-Plesset (or many-body) perturbation theory second-order
correction<sup id="fnref_footnote_1"><a class="footnote-ref" href="#fn_footnote_1">1</a></sup> to the Hartree-Fock energy (MP2). They vary in
capability, the size of system that can be treated and use of other
approximations</p>
<ul>
<li>Semi-direct &ndash; this is recommended for most large applications (up
    to about 2800 basis functions), especially on the IBM SP and other
    machines with significant disk I/O capability. Partially transformed
    integrals are stored on disk, multi-passing as necessary. RHF and
    UHF references may be treated including computation of analytic
    derivatives. This is selected by specifying mp2 on the task
    directive, e.g.</li>
</ul>
<pre><code>TASKMP2
</code></pre>
<ul>
<li>Fully-direct<sup id="fnref_footnote_2"><a class="footnote-ref" href="#fn_footnote_2">2</a></sup> &ndash; this is of utility if only limited I/O
    resources are available (up to about 2800 functions). Only RHF
    references and energies are available. This is selected by
    specifying <code>direct_mp2</code> on the task directive, e.g.</li>
</ul>
<pre><code>TASKDIRECT_MP2
</code></pre>
<ul>
<li>Resolution of the identity (RI) approximation MP2 (RI-MP2)<sup id="fnref_footnote_3"><a class="footnote-ref" href="#fn_footnote_3">3</a></sup> &ndash;
    this uses the RI approximation and is therefore only exact in the
    limit of a complete fitting basis. However, with some care, high
    accuracy may be obtained with relatively modest fitting basis sets.
    An RI-MP2 calculation can cost over 40 times less than the
    corresponding exact MP2 calculation. RHF and UHF references with
    only energies are available. This is selected by specifying rimp2 on
    the task directive, e.g.,</li>
</ul>
<pre><code>TASKRIMP2
</code></pre>
<p>All three MP2 tasks share the same input block.</p>
<pre><code> MP2  
   [FREEZE [[core] (atomic || &lt;integer nfzc default 0&gt;)] \  
           [virtual &lt;integer nfzv default 0&gt;]]  
   [TIGHT]  
   [PRINT]  
   [NOPRINT]  
   [VECTORS &lt;string filename default scf-output-vectors&gt; \  
     [swap [(alpha||beta)] &lt;integer pair-list&gt;] ]  
   [RIAPPROX &lt;string riapprox default V&gt;]  
   [FILE3C &lt;string filename default $file_prefix$.mo3cint&gt;  
   [SCRATCHDISK &lt;integer&gt;] 
 END
</code></pre>
<h2 id="freeze-freezing-orbitals">FREEZE: Freezing orbitals<a class="headerlink" href="#freeze-freezing-orbitals" title="Permanent link">&para;</a></h2>
<p>All MP2 modules support frozen core orbitals, however, only the direct
MP2 and RI-MP2 modules support frozen virtual orbitals.</p>
<p>By default, no orbitals are frozen. The atomic keyword causes orbitals
to be frozen according to the rules in the table below. Note that no
orbitals are frozen on atoms on which the nuclear charge has been
modified either by the user or due to the presence of an ECP. The actual
input would be</p>
<pre><code> freeze atomic
</code></pre>
<p>For example, in a calculation on Si(OH)<sub>2</sub>, by default the lowest
seven orbitals would be frozen (the oxygen 1<em>s</em>, and the silicon
1<em>s</em>, 2<em>s</em> and 2<em>p</em>).</p>
<table>
<thead>
<tr>
<th>Period</th>
<th>Elements</th>
<th>Core Orbitals</th>
<th>Number of Core</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>H - He</td>
<td>-</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>Li - Ne</td>
<td><em>1s</em></td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>Na - Ar</td>
<td><em>1s2s2p</em></td>
<td>5</td>
</tr>
<tr>
<td>3</td>
<td>K - Kr</td>
<td><em>1s2s2p3s3p</em></td>
<td>9</td>
</tr>
<tr>
<td>4</td>
<td>Rb - Xe</td>
<td><em>1s2s2p3s3p4s3d4p</em></td>
<td>18</td>
</tr>
<tr>
<td>5</td>
<td>Cs - Rn</td>
<td><em>1s2s2p3s3p4s3d4p5s4d5p</em></td>
<td>27</td>
</tr>
<tr>
<td>6</td>
<td>Fr - Lr</td>
<td><em>1s2s2p3s3p4s3d4p5s4d5p6s4f5d6p</em></td>
<td>43</td>
</tr>
</tbody>
</table>
<p>Number of orbitals considered &ldquo;core&rdquo; in the &ldquo;freeze by atoms&rdquo; algorithm</p>
<p><strong>Caution:</strong> The rule for freezing orbitals &ldquo;by atoms&rdquo; are rather
unsophisticated since the number of orbitals to be frozen is computed from
the table above by summing the number of core orbitals in each atom
present. Therefore, the corresponding number of lowest-energy orbitals are frozen.
If for some reason the actual core orbitals are not the lowest lying,
then correct results will not be obtained. It is likely that
special attention should be paid to systems including third-
and higher- period atoms.</p>
<p>The user may also specify the number of orbitals to be frozen by atom.
Following the  Si(OH)<sub>2</sub> example, the user could specify</p>
<pre><code>freeze atomic O 1 Si 3
</code></pre>
<p>In this case only the lowest four orbitals would be frozen. If the user
does not specify the orbitals by atom, the rules default to Table 16.1.</p>
<p>Caution: The system does not check for a valid number of orbitals per
atom. If the user specifies to freeze more orbitals then are available
for the atom, the system will not catch the error. The user must specify
a logical number of orbitals to be frozen for the atom.</p>
<p>The FREEZE directive may also be used to specify the number of core
orbitals to freeze. For instance, to freeze the first 10 orbitals</p>
<pre><code> freeze 10
</code></pre>
<p>or equivalently, using the optional keyword core</p>
<pre><code> freeze core 10
</code></pre>
<p>Again, note that if the 10 orbitals to be frozen do not correspond to
the first 10 orbitals, then the swap keyword of the VECTORS directive
must be used to order the input orbitals correctly (<a href="#vectors-mo-vectors">MO
vectors</a>).</p>
<p>To freeze the highest virtual orbitals, use the virtual keyword. For
instance, to freeze the top 5 virtuals</p>
<pre><code> freeze virtual 5
</code></pre>
<p>Again, note that this only works for the direct-MP2 and RI-MP2 energy
codes.</p>
<h2 id="tight-increased-precision">TIGHT: Increased precision<a class="headerlink" href="#tight-increased-precision" title="Permanent link">&para;</a></h2>
<p>The TIGHT directive can be used to increase the precision in the MP2
energy and gradients.</p>
<p>By default the MP2 gradient package should compute energies accurate to
better than a micro-Hartree, and gradients accurate to about five
decimal places (atomic units). However, if there is significant linear
dependence in the basis set the precision might not be this good. Also,
for computing very accurate geometries or numerical frequencies, greater
precision may be desirable.</p>
<p>This option increases the precision to which both the SCF (from
10<sup>-6</sup> to 10<sup>-8</sup> and CPHF 10<sup>-4</sup> to $10<sup>-6</sup>
are solved, and also tightens thresholds for computation of the AO and
MO integrals (from 10<sup>-9</sup> to 10<sup>-11</sup> within the MP2 code.</p>
<h2 id="scratchdisk-limiting-io-usage">SCRATCHDISK: Limiting I/O usage<a class="headerlink" href="#scratchdisk-limiting-io-usage" title="Permanent link">&para;</a></h2>
<p>This directive - used only in the semi-direct algorithm - allows to
limit the per process disk usage. Mandatory argument for this keyword is
the maximum number of MBytes. For example, the following input line</p>
<pre><code> scratchdisk 512
</code></pre>
<p>puts an upper limit of 512 MBytes to the semi-direct MP2 usage of disk
(again, on a per process base).</p>
<h2 id="print-and-noprint">PRINT and NOPRINT<a class="headerlink" href="#print-and-noprint" title="Permanent link">&para;</a></h2>
<p>The standard print control options are recognized. The list of
recognized names are given in the table
below.</p>
<p><center></p>
<table>
<thead>
<tr>
<th>Item</th>
<th>Print Level</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>RI-MP2</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>&ldquo;2/3 ints&rdquo;</td>
<td>debug</td>
<td>Partial 3-center integrals</td>
</tr>
<tr>
<td>&ldquo;3c ints&rdquo;</td>
<td>debug</td>
<td>MO 3-center integrals</td>
</tr>
<tr>
<td>&ldquo;4c ints b&rdquo;</td>
<td>debug</td>
<td>&ldquo;B&rdquo; matrix with approx. 4c integrals</td>
</tr>
<tr>
<td>&ldquo;4c ints&rdquo;</td>
<td>debug</td>
<td>Approximate 4-center integrals</td>
</tr>
<tr>
<td>&ldquo;amplitudes&rdquo;</td>
<td>debug</td>
<td>&ldquo;B&rdquo; matrix with denominators</td>
</tr>
<tr>
<td>&ldquo;basis&rdquo;</td>
<td>high</td>
<td></td>
</tr>
<tr>
<td>&ldquo;fit xf&rdquo;</td>
<td>debug</td>
<td>Transformation for fitting basis</td>
</tr>
<tr>
<td>&ldquo;geombas&rdquo;</td>
<td>debug</td>
<td>Detailed basis map info</td>
</tr>
<tr>
<td>&ldquo;geometry&rdquo;</td>
<td>high</td>
<td></td>
</tr>
<tr>
<td>&ldquo;information&rdquo;</td>
<td>low</td>
<td>General information about calc.</td>
</tr>
<tr>
<td>&ldquo;integral i/o&rdquo;</td>
<td>high</td>
<td>File size information</td>
</tr>
<tr>
<td>&ldquo;mo ints&rdquo;</td>
<td>debug</td>
<td></td>
</tr>
<tr>
<td>&ldquo;pair energies&rdquo;</td>
<td>debug</td>
<td>(working only in <code>direct_mp2</code>)</td>
</tr>
<tr>
<td>&ldquo;partial pair energies&rdquo;</td>
<td>debug</td>
<td>Pair energy matrix each time it is updated</td>
</tr>
<tr>
<td>&ldquo;progress reports&rdquo;</td>
<td>default</td>
<td>Report completion of time-consuming steps</td>
</tr>
<tr>
<td>&ldquo;reference&rdquo;</td>
<td>high</td>
<td>Details about reference wavefunction</td>
</tr>
<tr>
<td>&ldquo;warnings&rdquo;</td>
<td>low</td>
<td>Non-fatal warnings</td>
</tr>
</tbody>
</table>
<p>Printable items in the MP2 modules and their default print levels</p>
<p></center></p>
<h2 id="vectors-mo-vectors">VECTORS: MO vectors<a class="headerlink" href="#vectors-mo-vectors" title="Permanent link">&para;</a></h2>
<p>All of the (supported) MP2 modules require use of converged canonical
SCF (RHF or UHF) orbitals for correct results. The vectors are by
default obtained from the preceding SCF calculation, but it is possible
to specify a different source using the VECTORS directive. For instance,
to obtain vectors from the file /tmp/h2o.movecs, use the directive</p>
<pre><code> vectors /tmp/h2o.movecs
</code></pre>
<p>As noted above (<a href="#freeze-freezing-orbitals">FREEZE</a>) if
the SCF orbitals are not in the correct order, it is necessary to
permute the input orbitals using the swap keyword of the VECTORS
directive. For instance, if it is desired to freeze a total six orbitals
corresponding to the SCF orbitals 1-5, and 7, it is necessary to swap
orbital 7 into the 6th position. This is accomplished by</p>
<pre><code> vectors swap 6 7
</code></pre>
<p>The swap capability is examined in more detail in <a href="Hartree-Fock-Theory-for-Molecules.html#vectors-inputoutput-of-mo-vectors">Input/output of MO
vectors</a>.</p>
<h2 id="ri-mp2-fitting-basis">RI-MP2 fitting basis<a class="headerlink" href="#ri-mp2-fitting-basis" title="Permanent link">&para;</a></h2>
<p>The RI-MP2 method requires a fitting basis, which must be specified with
the name &ldquo;ri-mp2 basis&rdquo; (see <a href="Basis.html">Basis</a>). For instance,</p>
<pre><code> basis &quot;ri-mp2 basis&quot;
   O s; 10000.0 1
   O s;  1000.0 1
   O s;   100.0 1
   ...
 end
</code></pre>
<p>Alternatively, using a standard capability of basis sets
(<a href="Basis.html">Basis</a>) another named basis may be associated with
the fitting basis. For instance, the following input specifies a basis
with the name &ldquo;small fitting basis&rdquo; and then defines this to be the
&ldquo;ri-mp2 basis&rdquo;.</p>
<pre><code> basis &quot;small fitting basis&quot;
   H s; 10    1
   H s;  3    1
   H s;  1    1
   H s;  0.1  1
   H s;  0.01 1
 end
</code></pre>
<pre><code> set &quot;ri-mp2 basis&quot; &quot;small fitting basis&quot;
</code></pre>
<h2 id="file3c-ri-mp2-3-center-integral-filename">FILE3C: RI-MP2 3-center integral filename<a class="headerlink" href="#file3c-ri-mp2-3-center-integral-filename" title="Permanent link">&para;</a></h2>
<p>The default name for the file used to store the transformed 3-center
integrals is &ldquo;file_prefix.mo3cint&rdquo; in the scratch directory. This may
be overridden using the FILE3C directive. For instance, to specify the
file /scratch/h2o.3c, use this directive</p>
<pre><code> file3c /scratch/h2o.3c
</code></pre>
<h2 id="riapprox-ri-mp2-approximation">RIAPPROX: RI-MP2 Approximation<a class="headerlink" href="#riapprox-ri-mp2-approximation" title="Permanent link">&para;</a></h2>
<p>The type of RI approximation used in the RI-MP2 calculation is
controlled by means of the RIAPPROX directive. The two possible values
are V and SVS (case sensitive), which correspond to the approximations
with the same names described by Vahtras et al.<sup id="fnref_footnote_4"><a class="footnote-ref" href="#fn_footnote_4">4</a></sup>. The default is V.</p>
<h2 id="advanced-options-for-ri-mp2">Advanced options for RI-MP2<a class="headerlink" href="#advanced-options-for-ri-mp2" title="Permanent link">&para;</a></h2>
<p>These options, which functioned at the time of writing, are not
currently supported.</p>
<h3 id="control-of-linear-dependence">Control of linear dependence<a class="headerlink" href="#control-of-linear-dependence" title="Permanent link">&para;</a></h3>
<p>Construction of the RI fit requires the inversion of a matrix of fitting
basis integrals which is carried out via diagonalization. If the fitting
basis includes near linear dependencies, there will be small eigenvalues
which can ultimately lead to non-physical RI-MP2 correlation energies.
Eigenvectors of the fitting matrix are discarded if the corresponding
eigenvalue is less than <code>min eval</code> which defaults to 10<sup>-8</sup>. This
parameter may be changed by setting the a parameter in the database. For
instance, to set it to 10<sup>-10</sup></p>
<pre><code> set &quot;mp2:fit min eval&quot; 1e-10
</code></pre>
<h3 id="reference-spin-mapping-for-ri-mp2-calculations">Reference Spin Mapping for RI-MP2 Calculations<a class="headerlink" href="#reference-spin-mapping-for-ri-mp2-calculations" title="Permanent link">&para;</a></h3>
<p>The user has the option of specifying that the RI-MP2 calculations are
to be done with variations of the SCF reference wavefunction. This is
accomplished with a SET directive of the form,</p>
<pre><code> set &quot;mp2:reference spin mapping&quot; &lt;integer array default 0&gt;
</code></pre>
<p>Each element specified for array is the SCF spin case to be used for the
corresponding spin case of the correlated calculation. The number of
elements set determines the overall type of correlated calculation to be
performed. The default is to use the unadulterated SCF reference
wavefunction.</p>
<p>For example, to perform a spin-unrestricted calculation (two elements)
using the alpha spin orbitals (spin case 1) from the reference for both
of the correlated reference spin cases, the SET directive would be as
follows,</p>
<pre><code> set &quot;mp2:reference spin mapping&quot; 1 1
</code></pre>
<p>The SCF calculation to produce the reference wavefunction could be
either RHF or UHF in this case.</p>
<p>The SET directive for a similar case, but this time using the beta-spin
SCF orbitals for both correlated spin cases, is as follows,</p>
<pre><code> set &quot;mp2:reference spin mapping&quot; 2 2
</code></pre>
<p>The SCF reference calculation must be UHF in this case.</p>
<p>The SET directive for a spin-restricted calculation (one element) from
the beta-spin SCF orbitals using this option is as follows,</p>
<pre><code> set &quot;mp2:reference spin mapping&quot; 2
</code></pre>
<p>The SET directive for a spin-unrestricted calculation with the spins
flipped from the original SCF reference wavefunction is as follows,</p>
<pre><code> set &quot;mp2:reference spin mapping&quot; 2 1
</code></pre>
<h3 id="batch-sizes-for-the-ri-mp2-calculation">Batch Sizes for the RI-MP2 Calculation<a class="headerlink" href="#batch-sizes-for-the-ri-mp2-calculation" title="Permanent link">&para;</a></h3>
<p>The user can control the size of each batch in the transformation and
energy evaluation in the MP2 calculation, and consequently the memory
requirements and number of passes required. This is done using two SET
directives of the following form,</p>
<pre><code> set &quot;mp2:transformation batch size&quot; &lt;integer size default -1&gt;
 set &quot;mp2:energy batch size&quot; &lt;integer isize jsize default -1 -1&gt;
</code></pre>
<p>The default is for the code to determine the batch size based on the
available memory. Should there be problems with the program-determined
batch sizes, these variables allow the user to override them. The
program will always use the smaller of the user&rsquo;s value of these entries
and the internally computed batch size.</p>
<p>The transformation batch size computed in the code is the number of
occupied orbitals in the <em>(occ vir|fit)</em> three-center integrals to be
produced at a time. If this entry is less than the number of occupied
orbitals in the system, the transformation will require multiple passes
through the two-electron integrals. The memory requirements of this
stage are two global arrays of dimension <em><code>batch size</code> x vir x fit</em> with
the &ldquo;fit&rdquo; dimension distributed across all processors (on shell-block
boundaries). The compromise here is memory space versus multiple
integral evaluations.</p>
<p>The energy evaluation batch sizes are computed in the code from the
number of occupied orbitals in the two sets of three-center integrals to
be multiplied together to produce a matrix of approximate four-center
integrals. Two blocks of integrals of dimension <em>(<code>batch isize</code> x vir)</em>
and <em>(<code>batch jsize</code> x vir)</em> by fit are read in from disk and multiplied
together to produce <em><code>batch isize</code> <code>batch jsize</code> vir^2</em> approximate
integrals. The compromise here is performance of the distributed matrix
multiplication (which requires large matrices) versus memory space.</p>
<h3 id="energy-memory-allocation-mode-ri-mp2-calculation">Energy Memory Allocation Mode: RI-MP2 Calculation<a class="headerlink" href="#energy-memory-allocation-mode-ri-mp2-calculation" title="Permanent link">&para;</a></h3>
<p>The user must choose a strategy for the memory allocation in the energy
evaluation phase of the RI-MP2 calculation, either by minimizing the
amount of I/O, or minimizing the amount of computation. This can be
accomplished using a SET directive of the form,</p>
<pre><code> set &quot;mp2:energy mem minimize&quot; &lt;string mem_opt default I&gt;
</code></pre>
<p>A value of I entered for the string <code>mem_opt</code> means that a strategy to
minimize I/O will be employed. A value of C tells the code to use a
strategy that minimizes computation.</p>
<p>When the option to minimize I/O is selected, the block sizes are made as
large as possible so that the total number of passes through the
integral files is as small as possible. When the option to minimize
computation is selected, the blocks are chosen as close to square as
possible so that permutational symmetry in the energy evaluation can be
used most effectively.</p>
<h3 id="local-memory-usage-in-three-center-transformation">Local Memory Usage in Three-Center Transformation<a class="headerlink" href="#local-memory-usage-in-three-center-transformation" title="Permanent link">&para;</a></h3>
<p>For most applications, the code will be able to size the blocks without
help from the user. Therefore, it is unlikely that users will have any
reason to specify values for these entries except when doing very
particular performance measurements.</p>
<p>The size of <code>xf3ci:AO 1 batch size</code> is the most important of the three, in
terms of the effect on performance.</p>
<p>Local memory usage in the first two steps of the transformation is
controlled in the RI-MP2 calculation using the following SET directives,</p>
<pre><code> set &quot;xf3ci:AO 1 batch size&quot; &lt;integer max&gt;
 set &quot;xf3ci:AO 2 batch size&quot; &lt;integer max&gt;
 set &quot;xf3ci:fit batch size&quot; &lt;integer max&gt;
</code></pre>
<p>The size of the local arrays determines the sizes of the two matrix
multiplications. These entries set limits on the size of blocks to be
used in each index. The listing above is in order of importance of the
parameters to performance, with xf3ci:AO 1 batch size being most
important.</p>
<p>Note that these entries are only upper bounds and that the program will
size the blocks according to what it determines as the best usage of the
available local memory. The absolute maximum for a block size is the
number of functions in the AO basis, or the number of fitting basis
functions on a node. The absolute minimum value for block size is the
size of the largest shell in the appropriate basis. Batch size entries
specified for max that are larger than these limits are automatically
reset to an appropriate value.</p>
<h2 id="one-electron-properties-and-natural-orbitals">One-electron properties and natural orbitals<a class="headerlink" href="#one-electron-properties-and-natural-orbitals" title="Permanent link">&para;</a></h2>
<p>If an MP2 energy gradient is computed, all contributions are available
to form the MP2 linear-response density. This is the density that when
contracted with any spin-free, one-electron operator yields the
associated property defined as the derivative of the energy. Thus, the
reported MP2 dipole moment is the derivative of the energy w.r.t. an
external electric field and is not the expectation value of the operator
over the wavefunction. It has been shown that evaluating the MP2 density
through a derivative provides more accurate results, presumably because
this matches the way experiments probe the electron density more
closely[raghavachari1981]<sup id="fnref_footnote_5"><a class="footnote-ref" href="#fn_footnote_5">5</a></sup><sup id="fnref_footnote_6"><a class="footnote-ref" href="#fn_footnote_6">6</a></sup><sup id="fnref_footnote_7"><a class="footnote-ref" href="#fn_footnote_7">7</a></sup>.</p>
<p>Only dipole moments are printed by the MP2 gradient code, but natural
orbitals are produced and stored in the permanent directory with a file
extension of &ldquo;.mp2nos&rdquo;. These may be fed into the <a href="Properties.html">property
package</a> to compute more general properties as in the following example.</p>
<pre><code>start h2o
geometry
   O        2.15950        0.88132        0.00000
   H        3.12950        0.88132        0.00000
   H        1.83617        0.89369       -0.91444
end

basis spherical
  * library aug-cc-pVDZ
end

mp2
  freeze atomic
end

task mp2 gradient

property
  vectors  h2o.mp2nos
  mulliken
end

task mp2 property
</code></pre>
<p>Note that the MP2 linear response density matrix is not necessarily positive
definite so it is not unusual to see a few small negative natural
orbital occupation numbers. Significant negative occupation numbers have
been argued to be a sign that the system might be near degenerate<sup id="fnref_footnote_8"><a class="footnote-ref" href="#fn_footnote_8">8</a></sup>.</p>
<h2 id="scs-mp2-spin-component-scaled-mp2">SCS-MP2: Spin-Component Scaled MP2<a class="headerlink" href="#scs-mp2-spin-component-scaled-mp2" title="Permanent link">&para;</a></h2>
<p>Each MP2 output contains the calculation of the SCS-MP2 correlation
energies as suggested by S.Grimme<sup id="fnref_footnote_9"><a class="footnote-ref" href="#fn_footnote_9">9</a></sup></p>
<p>The SCS keyword is only required for gradients calculations:</p>
<pre><code> MP2  
   [SCS]  
 END
</code></pre>
<p>Scaling factors for the two components (parallel and opposite spin) can
be defined by using the keywords FSS (same spin factor) and FOS
(opposite spin factor):</p>
<pre><code>mp2  
   scs  
   fss   1.13  
   fos   0.56  
end
</code></pre>
<p>Default values are FSS=0.333333333, FOS=1.2 for MP2, and FSS=1.13, FOS=1.27 for
CCSD.</p>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<div class="footnote">
<hr />
<ol>
<li id="fn_footnote_1">
<p>Mller, Chr.; Plesset, M. S. Note on an Approximation Treatment for Many-Electron Systems. <em>Physical Review</em> <strong>1934</strong>, <em>46</em> (7), 618622. <a href="https://doi.org/10.1103/PhysRev.46.618">https://doi.org/10.1103/PhysRev.46.618</a>.&#160;<a class="footnote-backref" href="#fnref_footnote_1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn_footnote_2">
<p>Wong, A. T.; Harrison, R. J.; Rendell, A. P. Parallel Direct Four-Index Transformations. <em>Theoretica Chimica Acta</em> <strong>1996</strong>, <em>93</em> (6), 317331. <a href="https://doi.org/10.1007/BF01129213">https://doi.org/10.1007/BF01129213</a>.&#160;<a class="footnote-backref" href="#fnref_footnote_2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn_footnote_3">
<p>Bernholdt, D. E.; Harrison, R. J. Large-Scale Correlated Electronic Structure Calculations: The RI-MP2 Method on Parallel Computers. <em>Chemical Physics Letters</em> <strong>1996</strong>, <em>250</em> (5-6), 477484. <a href="https://doi.org/10.1016/0009-2614(96)00054-1">https://doi.org/10.1016/0009-2614(96)00054-1</a>.&#160;<a class="footnote-backref" href="#fnref_footnote_3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn_footnote_4">
<p>Vahtras, O.; Almlf, J.; Feyereisen, M. W. Integral Approximations for LCAO-SCF Calculations. <em>Chemical Physics Letters</em> <strong>1993</strong>, <em>213</em> (5-6), 514518. <a href="https://doi.org/10.1016/0009-2614(93)89151-7">https://doi.org/10.1016/0009-2614(93)89151-7</a>.&#160;<a class="footnote-backref" href="#fnref_footnote_4" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn_footnote_5">
<p>Diercksen, G. H. F.; Roos, B. O.; Sadlej, A. J. Legitimate Calculation of First-Order Molecular Properties in the Case of Limited CI Functions. Dipole Moments. <em>Chemical Physics</em> <strong>1981</strong>, <em>59</em> (1-2), 2939. <a href="https://doi.org/10.1016/0301-0104(81)80082-1">https://doi.org/10.1016/0301-0104(81)80082-1</a>.&#160;<a class="footnote-backref" href="#fnref_footnote_5" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn_footnote_6">
<p>Rice, J. E.; Amos, R. D. On the Efficient Evaluation of Analytic Energy Gradients. <em>Chemical Physics Letters</em> <strong>1985</strong>, <em>122</em> (6), 585590. <a href="https://doi.org/10.1016/0009-2614(85)87275-4">https://doi.org/10.1016/0009-2614(85)87275-4</a>.&#160;<a class="footnote-backref" href="#fnref_footnote_6" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
<li id="fn_footnote_7">
<p>Wiberg, K. B.; Hadad, C. M.; LePage, T. J.; Breneman, C. M.; Frisch, M. J. Analysis of the Effect of Electron Correlation on Charge Density Distributions. <em>The Journal of Physical Chemistry</em> <strong>1992</strong>, <em>96</em> (2), 671679. <a href="https://doi.org/10.1021/j100181a030">https://doi.org/10.1021/j100181a030</a>.&#160;<a class="footnote-backref" href="#fnref_footnote_7" title="Jump back to footnote 7 in the text">&#8617;</a></p>
</li>
<li id="fn_footnote_8">
<p>Gordon, M. S.; Schmidt, M. W.; Chaban, G. M.; Glaesemann, K. R.; Stevens, W. J.; Gonzalez, C. A Natural Orbital Diagnostic for Multiconfigurational Character in Correlated Wave Functions. <em>The Journal of Chemical Physics</em> <strong>1999</strong>, <em>110</em> (9), 41994207. <a href="https://doi.org/10.1063/1.478301">https://doi.org/10.1063/1.478301</a>.&#160;<a class="footnote-backref" href="#fnref_footnote_8" title="Jump back to footnote 8 in the text">&#8617;</a></p>
</li>
<li id="fn_footnote_9">
<p>Grimme, S. Improved Second-Order Mller-Plesset Perturbation Theory by Separate Scaling of Parallel- and Antiparallel-Spin Pair Correlation Energies. <em>The Journal of Chemical Physics</em> <strong>2003</strong>, <em>118</em> (20), 90959102. <a href="https://doi.org/10.1063/1.1569242">https://doi.org/10.1063/1.1569242</a>.&#160;<a class="footnote-backref" href="#fnref_footnote_9" title="Jump back to footnote 9 in the text">&#8617;</a></p>
</li>
</ol>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="TCE.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Tensor Contraction Engine Module: CI, MBPT, and CC" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Previous
                </span>
                Tensor Contraction Engine Module: CI, MBPT, and CC
              </div>
            </div>
          </a>
        
        
          
          <a href="CCSD.html" class="md-footer__link md-footer__link--next" aria-label="Next: Coupled Cluster Calculations" rel="next">
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Next
                </span>
                Coupled Cluster Calculations
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.expand", "navigation.top", "navigation.instant", "navigation.tracking", "navigation.indexes", "navigation.footer", "search.highlight", "search.share", "content.action.edit", "content.action.view", "content.code.copy"], "search": "assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.fc8c2696.min.js"></script>
      
        <script src="js/print-site.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
      
    
  </body>
</html>