<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	
<!-- Mirrored from /index.php/Special:AWCforum/st/id642/Wilson-Amos-Handy_method_for_cal....html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 04 Jun 2020 03:21:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="generator" content="MediaWiki 1.16.4" />
<meta name="keywords" content="Wilson-Amos-Handy method for calculation of NMR shifts Viewed 4287 times, With a total of 14 Posts" />
<link rel="shortcut icon" href="../../../../favicon.html" />
<link rel="search" type="application/opensearchdescription+xml" href="../../../../opensearch_desc.php" title="NWChem (en)" />
<link rel="alternate" type="application/atom+xml" title="NWChem Atom feed" href="../../../../index890f.php?title=Special:RecentChanges&amp;feed=atom" />		<title>Wilson-Amos-Handy method for calculation of NMR shifts - NWChem</title>
		<link rel="stylesheet" href="../../../../skins/common/shared3905.css?270" media="screen" />
<link rel="stylesheet" href="../../../../skins/common/commonPrint3905.css?270" media="print" />
<link rel="stylesheet" href="../../../../skins/gumax/gumax_main3905.css?270" media="screen" />
<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins/gumax/IE50Fixes.css?270" media="screen" /><![endif]-->
<!--[if IE 5.5000]><link rel="stylesheet" href="/skins/gumax/IE55Fixes.css?270" media="screen" /><![endif]-->
<!--[if IE 6]><link rel="stylesheet" href="/skins/gumax/IE60Fixes.css?270" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/skins/gumax/IE70Fixes.css?270" media="screen" /><![endif]-->
<link rel="stylesheet" href="../../../../skins/gumax/gumax_print3905.css?270" media="print" />
<link rel="stylesheet" href="../../../../index31a6.css?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" />
<link rel="stylesheet" href="../../../../index663f.css?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" media="print" />
<link rel="stylesheet" href="../../../../indexb76e.css?title=MediaWiki:Gumax.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" />
<link rel="stylesheet" href="../../../../indexd70f.css?title=-&amp;action=raw&amp;maxage=18000&amp;gen=css" />
		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?270"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script>
var skin="gumax",
stylepath="/skins",
wgUrlProtocols="http.html\\:\\/\\/|https\\:\\/\\/|ftp\\:\\/\\/|irc\\:\\/\\/|gopher\\:\\/\\/|telnet\\:\\/\\/|nntp\\:\\/\\/|worldwind\\:\\/\\/|mailto\\:|news\\:|svn\\:\\/\\/",
wgArticlePath="/index.php/$1",
wgScriptPath="",
wgScriptExtension=".php",
wgScript="../../../Main_Page.html",
wgVariantArticlePath=false,
wgActionPaths={},
wgServer="../../../../index.html",
wgCanonicalNamespace="Special",
wgCanonicalSpecialPageName="AWCforum",
wgNamespaceNumber=-1,
wgPageName="Special:AWCforum",
wgTitle="AWCforum",
wgAction="view",
wgArticleId=0,
wgIsArticle=true,
wgUserName=null,
wgUserGroups=null,
wgUserLanguage="en",
wgContentLanguage="en",
wgBreakFrames=true,
wgCurRevisionId=0,
wgVersion="1.16.4",
wgEnableAPI=true,
wgEnableWriteAPI=true,
wgSeparatorTransformTable=["", ""],
wgDigitTransformTable=["", ""],
wgMainPageTitle="Main Page",
wgFormattedNamespaces={"-2": "Media", "-1": "Special", "0": "", "1": "Talk", "2": "User", "3": "User talk", "4": "NWChem", "5": "NWChem talk", "6": "File", "7": "File talk", "8": "MediaWiki", "9": "MediaWiki talk", "10": "Template", "11": "Template talk", "12": "Help", "13": "Help talk", "14": "Category", "15": "Category talk", "500": "Release-60", "501": "Release-60 talk", "502": "Release61", "503": "Release61 talk", "504": "Release62", "505": "Release62 talk", "506": "Release64", "507": "Release64 talk", "508": "Release65", "509": "Release65 talk", "510": "Development", "511": "Development talk", "512": "Release66", "513": "Release66 talk", "121707": "Forum"},
wgNamespaceIds={"media": -2, "special": -1, "": 0, "talk": 1, "user": 2, "user_talk": 3, "nwchem": 4, "nwchem_talk": 5, "file": 6, "file_talk": 7, "mediawiki": 8, "mediawiki_talk": 9, "template": 10, "template_talk": 11, "help": 12, "help_talk": 13, "category": 14, "category_talk": 15, "release-60": 500, "release-60_talk": 501, "release61": 502, "release61_talk": 503, "release62": 504, "release62_talk": 505, "release64": 506, "release64_talk": 507, "release65": 508, "release65_talk": 509, "development": 510, "development_talk": 511, "release66": 512, "release66_talk": 513, "forum": 121707, "ns_reldoc64": "NS_RELDOC65", "ns_reldoc64_talk": "NS_RELDOC65_TALK", "image": 6, "image_talk": 7},
wgSiteName="NWChem",
wgCategories=[],
wgRestrictionEdit=[],
wgRestrictionMove=[];
</script>
		<script type="text/javascript" src="../../../../skins/common/wikibits3905.js?270"><!-- wikibits js --></script>
		<!-- Head Scripts -->
<style type="text/css">
#bodyContent a[href ^="http://"] {
background: none;
    padding-right: 0px;
}

#bodyContent a.external {
background: none;
	padding-right: 0px;
}

#p-cactions li a {
text-transform: capitalize;
}

#contentSub {
margin: 0;
padding: 2px;
padding-bottom: 6px;
}

pre {
margin:0px; 
    padding:5px;
    padding-bottom:20px;  
    
    width: 600px;
    overflow:auto;
    overflow-y: visible;
    line-height: 100%;
}

.top_user_links {
margin: 0;
    padding: 0;
    border-bottom: 1px solid #aaa;
    text-align: right;
}

#TopMenuLinksHolder li a:hover {

}

#TopMenuLinksHolder li a {

}

#TopMenuLinksHolder li {
margin-top: 4px;   
    margin-left: 4px;
    margin-bottom: 0px;
    
    padding: 3px;
    
    list-style: none;
    float: right;
    display: block;
    
    width: auto;
    white-space: nowrap;
    
    border: 1px solid #aaa;
    border-bottom: 0px;
    
    color: #000;
    text-decoration: none;
    font: 11px Verdana;
    text-align: left;
    z-index: 3;
}

#TopMenuLinksHolder a:visited {

}

#TopMenuLinksHolder div a:hover {
background: #FFF;
    color: #000;
}

#TopMenuLinksHolder div a {
position: relative;
        display: block;
        margin: 0;
        padding: 5px;
        width: auto;
        white-space: nowrap;
        text-align: left;
        text-decoration: none;
        font: 11px arial;
}

#TopMenuLinksHolder div {
position: absolute;
    visibility: hidden;
    margin: 0;
    padding: 0;
    background: #DDDDDD;
    border: 1px solid #AAAAAA;
}

#TopMenuLinksHolder {
margin: 0;
    padding: 0;
    z-index: 3;
}

.UserNameOptions {

}

#UserNameOptions a:visited {

}

#UserNameOptions li a:hover {

}

#UserNameOptions li a {
font: 11px Verdana;
}

#UserNameOptions li {
list-style: none;
    display: block;
    white-space: nowrap;
    border: 0px;
    color: #000;
    text-align: left;
    text-decoration: none;
}

#UserNameOptions div a:hover {
color: #FFF;
}

#UserNameOptions div a {
position: relative;
        display: block;
        margin: 0;
        padding: 5px;
        
        width: 500px;
        
        white-space: nowrap; 
        text-align: left;
        text-decoration: none;
        font: 11px arial;
}

#UserNameOptions div {
position: absolute;
    display: block;
    visibility: hidden;
    margin: 0;
    padding: 5px;
    background: #DDDDDD;
    border: 1px solid #AAAAAA;
    white-space: nowrap; 
    font: 12px arial;
    line-height: 100%;
}

#UserNameOptions {
margin: 0;
    padding: 0;
    z-index: 2;
}

.group_text {
font-size: 84%;
    width: auto;
    padding: 0px;
}

.edited_on {
border-top: 1px solid #aaa;
    margin: 0px;
    margin-bottom: 0px;
    padding-left: 5px;
    font-size: 12px;
}

.post_title {

}

.post_date {
border-bottom: 1px solid #aaa;
    font-size: 90%;
    padding-left: 2px;
}

.post_td {
background-color: #f9f9f9;
    border-left: 1px solid #aaa;
    margin: .0em;
    padding: .0em;
}

.post_body {
padding: .5em;
    padding-top: 0px;
}

.post0 {
background-color: #E5E5E5;
    border-left: 1px solid #aaa;
    padding: .0em;
}

.post1 {
background-color: #f9f9f9;
    border-left: 1px solid #aaa;
    padding-bottom: .0em;
}

.post_footer {
/* post, quote, edit buttons */
    margin: 0;
    padding: .7em;
    padding-bottom: 0em;
}

.post_box {
margin-top: 5px;
    margin-left: 5px;
    margin-right: 2px;
    width: auto;
}

.mem_name {
border-bottom: 1px solid #aaa;
    margin: 0;
    padding: .4em;
}

.adv {
border: 0px;
    margin: 0em;
    padding: 0em;
}

.thread_sig {
border-top: 2px solid #aaa;
    margin: 3px;
    padding-left: 5px;
}

#subscribe_menu {
position: absolute;
    background: #ccc ;
    border: 1px solid #aaa;
    border-top: 0px;
    margin: 0em;
    padding: 5px;
    padding-top: 0px;
    top:auto;
    right:65px;
    z-index: 2;
}

.drop_down_buttons:hover {
background: #ccc ;
}

.drop_down_buttons {
margin: 0em;
    white-space: nowrap;
    border-bottom: 1px solid #aaa;
    border-top: 0px;
    padding: 5px;
    color: #000;
    text-align: center;
    background: #fff ;
}

.mod_menu_row {
text-align: left;
}

.post_buttons:hover {
background: #fff ;
}

.post_buttons {
white-space: nowrap;
    float: right;
    margin-top: .5em;
    margin-right: 5px;
    border: 1px solid #aaa;
    border-bottom: 0em;
    padding-left: 5px;
    padding-right: 5px;
    padding-bottom: 0px;
    color: #000;
}

.quote_title {
border: 1px dashed #aaa;
	padding: 5px;
	background-color: #f9f9f9;
	font-family:"Courier New", Courier, mono;
}

.quote {
border-top: 1px solid #000;
	background-color: #fff;
	padding: 10px;
	font-size: 95%;
}

.user_options_row {
border: 1px solid #aaa;
    background: #fff ;
    padding: .3em;
}

.t_userinfo {
white-space:nowrap;
    text-align: left;
    margin: 0;
    padding: .7em;
    padding-bottom: 0em;
}

.ThreadOtions {
margin: 0;
    padding: 0;
    text-align: right;
}

#ThreadOtions a:visited {

}

#ThreadOtions li a:hover {

}

#ThreadOtions li a {
border: 1px solid #aaa;
    border-bottom: 0em;
    padding: 4px;
}

#ThreadOtions li {
list-style: none;
    display: block;
    white-space: nowrap;
    
    border: 0px;
    color: #000;
    
    text-decoration: none;
    z-index: 3;
}

#ThreadOtions div a:hover {
background: #FFF;
    color: #000;
}

#ThreadOtions div a {
position: relative;
        display: block;
        margin: 0;
        padding: 2px;
        border: 0em;
        
        white-space: nowrap; 
        text-align: left;
        text-decoration: none;
        font: 11px arial;
}

#ThreadOtions div {
position: absolute; 
    right: 50px;
    visibility: hidden;
    margin: 0;
    padding: 5px;
    background: #DDDDDD;
    border: 1px solid #AAAAAA;
    white-space: nowrap; 
    text-align: left;
}

#ThreadOtions {
margin-top: 3px;
    padding: 0;
    z-index: 3;
}

.forum_posts {
border: 1px solid #aaa;
    margin: 0em;
    padding: 0em;
    width: 100%;

 width: 100%;
}

.post {
background-color: #f9f9f9;
    border-left: 1px solid #aaa;
    padding: .0em;
}

#search_box {
white-space:nowrap;
    text-align: right; 
    margin: .0em;
    padding: 0px;
}

.search_box {
float: right;
    font-size: 97%;
    margin: .0em;
    color: #000;
    background: #fff;
    border: 1px solid #000;
    margin-left: 5px;
    padding: 0px;
}

.highlightsearchword {
color: #FF0000;
}

.poll_display_table {
border: 1px solid #aaa;
    
    padding: 1px;
}

.poll_displayheader {
border-bottom: 1px dashed #aaa;
    padding: 4px;
    background-color: #DDDDDD;
    font-family:"Courier New", Courier, mono;
}

.poll_display_row {
border-bottom: 1px solid #aaa;
    background-color: #f9f9f9;
    padding: 2px;
}

.poll_display_vote_total {
border-top: 1px solid #aaa;
    padding: 4px;
    background-color: #DDDDDD;
    font-family:"Courier New", Courier, mono;
}

.poll_display_vote_numbers_header {
border: 1px solid #aaa;
border-bottom: 0;
}

.poll_display_vote_percent_header {
border-top: 1px solid #aaa;
    padding: 1px;
}

.poll_display_vote_option_header {
border: 1px solid #aaa;
    border-bottom: 0;
    padding: 1px;
}

.poll_display_vote_numbers {
border: 1px solid #aaa;
    border-bottom: 0;
    padding: 1px;
}

.poll_display_vote_percent {
border-top: 1px solid #aaa;
    padding: 1px;
}

.poll_display_vote_option {
border: 1px solid #aaa;
    border-bottom: 0;
    padding: 1px;
}

.poll_percent_color_op10 {
background-color: #7FFF00;
}

.poll_percent_color_op1 {
background-color: #CD5555;
}

.poll_percent_color_op2 {
background-color: #5CACEE;
}

.poll_percent_color_op3 {
background-color: #FFCC11;
}

.poll_percent_color_op4 {
background-color: #668014;
}

.poll_percent_color_op5 {
background-color: #A0522D;
}

.poll_percent_color_op6 {
background-color: #9F79EE;
}

.poll_percent_color_op7 {
background-color: #EE00EE;
}

.poll_percent_color_op8 {
background-color: #DC143C;
}

.poll_percent_color_op9 {
background-color: #551011;
}

.page_jumps_top:hover {
background: #ccc ;
}

.page_jumps_top {
white-space: nowrap;
    display: inline;
    
    margin: 0px; 
    margin-right: 2px;
    
    border: 1px solid #aaa;
    border-bottom: 0px;
    
    padding-left: 5px;
    padding-right: 5px;
    padding-bottom: 4px;
    
    color: #000;
}

.page_jumps_bot:hover {
background: #ccc ;
}

.page_jumps_bot {
border: 1px solid #aaa;
    border-top: 0px;
    padding-top: 2px;
    margin-left: 2px;
    font-size: 100%;
    padding-left: 5px;
    padding-right: 5px;
    padding-bottom: 2px;
}

.main_memtable {
border: 1px solid #aaa;
}

.main_leftmenu {
border-right: 1px solid #aaa;
     background-color: #f9f9f9;
     width: 175px;
}

.leftmenuheaders {
border: 1px dashed #aaa;
    padding: 2px;
    font-family:"Courier New", Courier, mono;
}

.leftmenu {
background-color: #f9f9f9;
}

.right_body {
padding: 2px;
}

.mem_pm_table {
border: 1px solid #aaa;
    padding: 2px;
    margin: 7px;
}

.pm_header_new {
background-color: #aaa;
    border: 1px solid #000;
    padding: 2px;
    width:5%;
}

.pm_header_title {
background-color: #aaa;
    border: 1px solid #000;
    padding: 2px;
    width:85%;
}

.pm_header_sender {
background-color: #aaa;
    border: 1px solid #000;
    padding: 2px;
    width:5%;
}

.pm_header_date {
background-color: #aaa;
    border: 1px solid #000;
    padding: 2px;
    width:5%;
}

.pm_row {
background-color: #f9f9f9;
    border: 1px solid #000;
    padding: 3px;
}

#cat_list_lastaction_user {
font-size: 90%;
    color: #7d7d7d;
    text-align: right;
    margin-right: 10px;
    line-height: 100%;
}

#cat_list_lastaction_date {
font-size: 90%;
    color: #7d7d7d;
    text-align: right;
    margin-right: 10px;
    line-height: 105%;
}

#cat_list_lastaction_title {
font-size: 90%;
    color: #7d7d7d;
    text-align: right;
    margin-right: 10px;
    line-height: 105%;
}

#small_desc {
font-size: 84%;
    color: #7d7d7d;
	margin-left: 10px;
    width: auto;
}

#cat_forumdisc {
font-size: 84%;
    color: #7d7d7d;
    margin-left: 10px;
    width: auto;
}

.cat_forumrows {
border: 1px solid #aaa;
    background-color: #f9f9f9;
    padding: 5px;
    font-size: 95%;
}

.thread_col_head {
border: 1px solid #aaa;
    margin: 0px;
    padding: 5px;
    white-space: nowrap;
}

.bread_crumbs {
border-bottom: 1px solid #aaa;
    border-top: 0px;
    padding: 2px;
    text-align: left;
}

.dl_maintable_head {
border-right: 1px solid #aaa;
    border-bottom: 1px solid #aaa;
    background-color: #fff;
    padding: 2px;
}

.dl_maintable {
border: 1px solid #aaa;
    margin: 1px;
    padding: 1px;
}

.right_float {
float: right;
	margin-top: 8px;
	padding-left: 5px;
	padding-right: 5px;
	margin-right: 10px;
	margin-left: 10px;
}

.right {
float: right;
	padding-left: 5px;
	padding-right: 5px;
	margin-right: 10px;
	margin-left: 10px;
}

.spacer {
background-color: #aaa;
}

.whos_here_header {
border-bottom: 1px dashed #aaa;
            padding: 4px;
            font-family:"Courier New", Courier, mono;
}

.whos_here_row {
border-bottom: 1px solid #aaa;
            background-color: #f9f9f9;
            padding: 2px;
}

.whos_here {
border: 1px solid #aaa;
            border-bottom: 0;
}

.nothing {
font-size: 0%;
            margin: .0em;
            border: 0;
            margin: 0;
            padding: 0;
            width: 0;
}

.forum_stats {
border: 1px solid #aaa;
            border-bottom: 0;
}

.forum_stats_leftcol {
border-bottom: 1px solid #aaa;
                background-color: #f9f9f9;
                padding: 2px;
}

.forum_stats_rightcol {
background-color: #f9f9f9;
                border-bottom: 1px solid #aaa;
                padding: 2px;
}

.forum_stats_header {
border-bottom: 1px dashed #aaa;
                padding: 4px;
                font-family:"Courier New", Courier, mono;
}

.thread_rows0 {
background-color: #E5E5E5;
    border: 1px solid #aaa;
    border-top: 0px ;
    padding: 2px;
    font-size: 95%;
}

.thread_rows1 {
background-color: #f3f3f3;
    border: 1px solid #aaa;
    border-top: 0px ;
    padding: 2px;
    font-size: 95%;
}

.thread_rows {
background-color: #f9f9f9;
    border: 1px solid #aaa;
    border-top: 0px ;
    padding: 2px;
    font-size: 95%;
}

#annc {
border: 1px solid #000;
	background-color: red;
	padding: 0px;
}

.sticky {
font-style: italic;
    border: 1px solid #aaa;
    border-top: 0px;
    background-color:  #ffa; /* #ffa; e2ffe2 */
    padding: 2px;
    font-size: 95%;
}

.thread_lastaction {
font-size: 84%;
    text-align: right;
    white-space: nowrap;
    display: inline;
}

.pagejumps_PostOnForumPage:hover {
background: #ccc ;
}

.pagejumps_PostOnForumPage {
border: 1px solid #aaa;
    margin-left: 3px;
    font-size: 100%;
    padding-left: 3px;
    padding-right: 3px;
    padding-bottom: 0px;
}

.new_thread_button:hover {
background: #ccc ;
}

.new_thread_button {
white-space: nowrap;
    float: right;
    display: inline; /*fixes IE float bug*/
    margin-top: 0px; 
    margin-bottom: 0px; 
    margin-left: 10px;
   /* margin-left: -4px; */
    border: 1px solid #aaa;
    border-bottom: 0px;
    padding-left: 5px;
    padding-right: 5px;
    padding-bottom: 3px;
    text-align: left; /* 2.4.1 */
    color: #000;
}

#row_info td {
border: 1px solid #aaa;
	border-top: 0px;
	background-color: #f9f9f9;
	padding: 5px;
	font-size: 95%;
}

.page_jumps_holder_thread_bot {
border-bottom: 1px solid #aaa;
}

.page_jumps_holderBot {

}

.poll_thread_listing {
border: 1px solid #aaa;
    border-top: 0px;
    background-color:  #FFCC00;
    padding: 2px;
    font-size: 95%;
}

.locked_thread {
font-style: italic;
    border: 1px solid #aaa;
    border-top: 0px;
    background-color:  #e2ffe2; /* #ffa; e2ffe2 */
    padding: 2px;
    font-size: 95%;
}

#ajax_pmname {
text-align: left;
}

#ajax_pmname ul {
list-style: none;
margin: 0;
}

#ajax_pmname li {
padding: 2px 5px;
	white-space: nowrap;
	text-align: left;
}

#ajax_pmname li:hover {
background: #f9f9f9;
	margin-left: .1em;
	text-decoration: underline;
}

#ajax_pmname li {
padding: 2px 5px;
	white-space: nowrap;
	text-align: left;
}

#ajax_pmname li {
padding: 2px 5px;
	white-space: nowrap;
	text-align: left;
}

#ajax_pmname li {
padding: 2px 5px;
	white-space: nowrap;
	text-align: left;
}

</style>
<script type="text/javascript" src="../../../../extensions/awc/forums/awc.js"></script><script src="../../../../skins/common/ajax3905.js?270"></script>
		<script type="text/javascript" src="../../../../indexb492.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=gumax"><!-- site js --></script>


		<!-- gumax customized style -->

					<style type="text/css">
				#gumax-content-actions li#ca-talk,
				#gumax-content-actions li#ca-history,
				#gumax-content-actions li#ca-edit,
				#gumax-personal-tools
				{ display: none; }
			</style>
		
		<!--[if lt IE 7]>
			<script type="text/javascript" src="/skins/gumax/js/ieunitpngfix-tag.js"></script>
		<![endif]-->

		<!-- end of gumax customized style -->
</head>


<body class="mediawiki ltr ns--1 ns-special page-Special_AWCforum_st_id642_Wilson-Amos-Handy_method_for_cal_html skin-gumax">

<!-- ##### gumax-wrapper ##### -->
<div id="gumax-wrapper">

<table border="0" id="gumax-page-table"><tr><td id="gumax-page-table-left"><img src="../../../../skins/gumax/blank.gif" alt="" /></td><td width="100%" valign="top" style="padding: 0; margin: 0" id="gumax-page-table-content">


<!-- ===== gumax-page ===== -->
<div class="gumax-page">

	<!-- ///// gumax-header ///// -->
	<div id="gumax-header">
		<a name="top" id="contentTop"></a>

		<!-- gumax-p-logo -->
	<div id="gumax-p-logo">
		<div id="p-logo">
			<a style="background-image: url(../../../../images/MS3_NWChem.logo3.png);" href="../../../Main_Page.html" title="Main Page"></a>
		</div>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<!-- end of gumax-p-logo -->

		<!-- Login -->
	<div id="gumax-p-login">
		<ul>
		</ul>
	</div>
	<!-- end of Login -->

		<!-- Search -->
	<div id="gumax-p-search" class="gumax-portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="gumax-searchBody" class="gumax-pBody">
			<form action="http:///index.php/Special:Search" id="searchform"><div>
				<input id="searchInput" name="search" type="text" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton" value="Go" title="Go to a page with this exact name if exists" />
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" />
			</div></form>
		</div>
	</div>
	<!-- end of Search -->

	</div>
	<!-- ///// end of gumax-header ///// -->


		<!-- Navigation Menu -->
	<div id="gumax-p-navigation">
			<div class="gumax-portlet gumax-p-navigation">
				<h5>Navigation</h5>
						<ul>
								<li id="n-Home"><a href="../../../Main_Page.html">Home</a></li>
								<li id="n-Science"><a href="../../../Science.html">Science</a></li>
								<li id="n-Benchmarks"><a href="../../../Benchmarks.html">Benchmarks</a></li>
								<li id="n-Download.C2.A0"><a href="../../../Download.html">Download </a></li>
								<li id="n-Documentation"><a href="../../../Release66_NWChem_Documentation.html">Documentation</a></li>
								<li id="n-Projects"><a href="../../../Ongoing_Projects.html">Projects</a></li>
								<li id="n-News"><a href="../../../NWChem_Current_events.html">News</a></li>
								<li id="n-Forum"><a href="../../../Special_AWCforum.html">Forum</a></li>
								<li id="n-FAQ"><a href="../../../FAQ.html">FAQ</a></li>
								<li id="n-Other-Software"><a href="../../../Software_supporting_NWChem.html">Other Software</a></li>
								<li id="n-Development"><a href="../../../Developer.html">Development</a></li>
						</ul>
			</div>
			<div class="gumax-portlet gumax-p-navigation">
				<h5>SEARCH</h5>
			</div>
			<div class="gumax-portlet gumax-p-navigation">
				<h5>TOOLBOX</h5>
			</div>
			<div class="gumax-portlet gumax-p-navigation">
				<h5>LANGUAGES</h5>
			</div>
			<div class="gumax-portlet gumax-p-navigation">
				<h5>Forum Menu</h5>
			</div>
	</div>
	<!-- end of Navigation Menu -->
	<div class="gumax-p-navigation-spacer"></div>

		<!-- gumax-content-actions -->
		<div id="gumax-content-actions">
		<ul>
		</ul>
		<div class="gumax-message"></div>
	</div>
		<!-- end of gumax-content-actions -->

		<!-- gumax-content-body -->
		<div id="gumax-column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 id="firstHeading" class="firstHeading gumax-firstHeading" >Wilson-Amos-Handy method for calculation of NMR shifts</h1>
		<div id="bodyContent" class="gumax-bodyContent">
			<h3 id="siteSub">From NWChem</h3>
			<div id="contentSub"><form id="search_box" action="http:///index.php/Special:AWCforum/search/s" method="post"  enctype="multipart/form-data">
	<input class="search_box" type="submit" value="Search">
        <input name="tID" type="hidden" value="642">
        <input name="fID" type="hidden" value="6">
        <input name="cID" type="hidden" value="2">
        <select class="search_box" name="search_what"> <option value="all">All</option>
        <option value="c">Current Category</option>
        <option value="f">Current Forum</option>
        <option value="t">Current Thread</option>
        </select>
	<input class="search_box" name="kw" type="text" size="20">
</form>Viewed 4287 times, With a total of 14 Posts</div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<table width="100%" cellpadding="0" cellspacing="0">
	<tr>
		<td class="top_user_links">
                	<ul id="TopMenuLinksHolder">
                               <li><a href="../../credits.html">Credits</a></li>
        			<li><a href="../../search.html">Search</a></li>
            <li><a href="../../search/todate.html">Today's Posts</a></li>
        			
        			
    			</ul>
		</td>
	</tr>
</table><table width="100%" cellpadding="0" cellspacing="0" class="bread_crumbs">
	<tr>
		<td width="99%" valign="bottom"><a href="../../index.html">Forum</a> &gt;&gt; <a href="../../sc/id2.html">NWChem's corner</a> &gt;&gt; <a href="../../sf/id6.html">NWChem functionality</a></td>
	</tr>
</table>
<br />    <table width="100%" cellpadding="0" cellspacing="0">
        <tr>
            <td width="65%" align="left" nowrap="nowrap"></td>                                         
            <td width="35%" class='ThreadOtions' nowrap></td>    
        </tr>
    </table>       <a name="post_2315"></a>       
        <table class="forum_posts" cellpadding="0" cellspacing="0" id="fullheight">
            <tr>
                <td width="100%" align="left" colspan="2" valign="top" class="mem_name" id="name_2315" nowrap>
                    <table width="100%" cellpadding="0" cellspacing="0">
                        <tr>
                            <td class="UserNameOptions" width="100%">
                                <ul id="UserNameOptions">
                                  <li>
                                     <a href="../../mem_profile/Ohlincha/1364.html" onmouseover="mopen('mem1')" onmouseout="mclosetime()">Ohlincha</a>  <font class="group_text">Member</font>
                                    <div id="mem1" onmouseover="mcancelclosetime()" onmouseout="mclosetime()">
                                        <a href="../../mem_profile/Ohlincha/1364.html"><b>Profile</b></a><br />
                                        
                                        Send <a href="../../member_options/pmnew/Ohlincha/2315.html">PM</a>
                                    </div>
                                  </li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td align="left" nowrap valign="top" width="20">
                    <table cellpadding="0" cellspacing="0" width="20">
                        <tr>
                            <td class="t_userinfo" width="20" nowrap>
                <!-- member_title --><div class="">Gets Around</div><!-- /member_title -->
                <DIV align="center"><img class="adv" src="../../../../extensions/awc/forums/images/avatars/avatar_default.gif" border="0" height="0" width="0" align="middle"/></div>
                                
                                Threads <a href="../../search/memtopics/Ohlincha/1364.html">16</a><br />
                                Posts <a href="../../search/memposts/Ohlincha/1364.html">115</a>                              
                            </td>
                        </tr>
                    </table>
                </td>
                        
            		<td align="left" width="100%" valign="top" id="fullheight">
		                <table width="100%" cellpadding="0" cellspacing="0" class="post0" height="75">
		                    <tr>
		                        <td class="post_date" valign="bottom" height="1px"  width="100%" colspan="2"  nowrap><a target="blank" href="../../sp/id2315.html">5:15:21 PM PST - Thu, Nov 8th 2012 </a></td>
		                            <td class="post_date" valign="bottom" height="1px" width="100%" nowrap></td>

		                    </tr>
		                                     
		                    <tr>
		                        <td valign="top" class="post_body" height="65" colspan="2">Dear all,<br />
My, probably naive, question is this: is it possible to use NWChem in its current state for the Wilson-Amos-Handy method to calculating NMR shifts?<br />
<br />
The approach is described in Chem. Phys. Letters 1999, 312, 475-484 and J. Chem. Phys, 2000, 113(8), 2983-2989 and 'excludes the exact exchange from the calculation of the first-order perturbed wave function so that the coupled-perturbed  KS can be diagonalized and doesn't need to be iteratively solved' (paraphrasing Magyarfalvi and Pulay's description on page 1351 in J. Chem. Phys. 2003, 119, 1350-1356).<br />
<br />
At a first glance it may look like the method only involves a slight re-parametrisation (xc HFexch 0.05 slater 0.95 becke88 nonlocal 0.72 perdew91 0.81 wvn_5 1), but the functional alone performs as poorly as b3lyp, acm etc. and there are more significant changes in the approach.<br />
<br />
To my knowledge this has only been implemented in PQS so far.<br />
<br />
I'm interested in the method given the reported excellent accuracy in the prediction of the 17O NMR shifts ('simple' test cases like CO and H2CO are not handled well by giao/b3lyp) for at least first and second row elements.<br />
<br />
Is it possible to reproduce the Wilson-Amos-Handy method in the current version of NWChem, or would it involve non-trivial changes/additions to the code? <br />
<br />
Best regards,<br />
Andy<br />
<br />
EDIT: fixed the sloppily type exchange correlation functional definition
</td>
		                    </tr>
		                                
		                    <tr>
	<td class="edited_on" align="left" colspan="2">
		<b><a href="../../post/edithistory/2315.html">Edited On</a></b> 11:04:41 PM PST - Thu, Nov 8th 2012 <b>by</b> Ohlincha
	</td>
</tr>
		                    
		                </table>
		            </td>
        </tr> 
           
        <tr><td class="thread_sig" align="left" colspan="2"></td></tr>
        	
        </table>
<br />       <a name="post_2316"></a>       
        <table class="forum_posts" cellpadding="0" cellspacing="0" id="fullheight">
            <tr>
                <td width="100%" align="left" colspan="2" valign="top" class="mem_name" id="name_2316" nowrap>
                    <table width="100%" cellpadding="0" cellspacing="0">
                        <tr>
                            <td class="UserNameOptions" width="100%">
                                <ul id="UserNameOptions">
                                  <li>
                                     <a href="../../mem_profile/Bert/12.html" onmouseover="mopen('mem2')" onmouseout="mclosetime()">Bert</a>  <font class="group_text">Forum:Admin, Forum:Mod, NWChemDeveloper, bureaucrat, sysop</font>
                                    <div id="mem2" onmouseover="mcancelclosetime()" onmouseout="mclosetime()">
                                        <a href="../../mem_profile/Bert/12.html"><b>Profile</b></a><br />
                                        
                                        Send <a href="../../member_options/pmnew/Bert/2316.html">PM</a>
                                    </div>
                                  </li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td align="left" nowrap valign="top" width="20">
                    <table cellpadding="0" cellspacing="0" width="20">
                        <tr>
                            <td class="t_userinfo" width="20" nowrap>
                <!-- member_title --><div class="">Forum Vet</div><!-- /member_title -->
                <DIV align="center"><img class="adv" src="../../../../extensions/awc/forums/images/avatars/avatar_default.gif" border="0" height="0" width="0" align="middle"/></div>
                                
                                Threads <a href="../../search/memtopics/Bert/12.html">4</a><br />
                                Posts <a href="../../search/memposts/Bert/12.html">597</a>                              
                            </td>
                        </tr>
                    </table>
                </td>
                        
            		<td align="left" width="100%" valign="top" id="fullheight">
		                <table width="100%" cellpadding="0" cellspacing="0" class="post1" height="75">
		                    <tr>
		                        <td class="post_date" valign="bottom" height="1px"  width="100%" colspan="2"  nowrap><a target="blank" href="../../sp/id2316.html">6:08:51 PM PST - Thu, Nov 8th 2012 </a></td>
		                            <td class="post_date" valign="bottom" height="1px" width="100%" nowrap></td>

		                    </tr>
		                                     
		                    <tr>
		                        <td valign="top" class="post_body" height="65" colspan="2">If I read the papers correctly, for B3LYP the functional woudl have the following form:<br />
<br />

<pre>    XC HFexch 0.05 slater 0.95 vwn_1_rpa 0.19 lyp 0.81  becke88 nonlocal 0.72<br />
</pre>
<br />
Explicitly not including the HFexch in the NMR response calculation would require some minor modifications to make it feasible. <br />
<br />
Bert<br />
<br />
<br />
<br />
<br />
<div class='quote_title'>Quote:Ohlincha <a target='blank' href="../../sp/id2315.html" title="Special:AWCforum/sp/id2315">Nov 9th 12:15 am</a><div class='quote'>Dear all,<br />
My, probably naive, question is this: is it possible to use NWChem in its current state for the Wilson-Amos-Handy method to calculating NMR shifts?<br />
<br />
The approach is described in Chem. Phys. Letters 1999, 312, 475-484 and J. Chem. Phys, 2000, 113(8), 2983-2989 and 'excludes the exact exchange from the calculation of the first-order perturbed wave function so that the coupled-perturbed  KS can be diagonalized and doesn't need to be iteratively solved' (paraphrasing Magyarfalvi and Pulay's description on page 1351 in J. Chem. Phys. 2003, 119, 1350-1356).<br />
<br />
At a first glance it may look like the method only involves a slight re-parametrisation (xc HFexch 0.05 slater 0.95 becke88 0.72 perdew 91 wvn_5 1), but the functional alone performs as poorly as b3lyp, acm etc. and there are more significant changes in the approach.<br />
<br />
To my knowledge this has only been implemented in PQS so far.<br />
<br />
I'm interested in the method given the reported excellent accuracy in the prediction of the 17O NMR shifts ('simple' test cases like CO and H2CO are not handled well by giao/b3lyp) for at least first and second row elements.<br />
<br />
Is it possible to reproduce the Wilson-Amos-Handy method in the current version of NWChem, or would it involve non-trivial changes/additions to the code? <br />
<br />
Best regards,<br />
Andy</div id="quote"></div id="quote">
</td>
		                    </tr>
		                                
		                    
		                    
		                </table>
		            </td>
        </tr> 
           
        <tr><td class="thread_sig" align="left" colspan="2"></td></tr>
        	
        </table>
<br />       <a name="post_2319"></a>       
        <table class="forum_posts" cellpadding="0" cellspacing="0" id="fullheight">
            <tr>
                <td width="100%" align="left" colspan="2" valign="top" class="mem_name" id="name_2319" nowrap>
                    <table width="100%" cellpadding="0" cellspacing="0">
                        <tr>
                            <td class="UserNameOptions" width="100%">
                                <ul id="UserNameOptions">
                                  <li>
                                     <a href="../../mem_profile/Ohlincha/1364.html" onmouseover="mopen('mem3')" onmouseout="mclosetime()">Ohlincha</a>  <font class="group_text">Member</font>
                                    <div id="mem3" onmouseover="mcancelclosetime()" onmouseout="mclosetime()">
                                        <a href="../../mem_profile/Ohlincha/1364.html"><b>Profile</b></a><br />
                                        
                                        Send <a href="../../member_options/pmnew/Ohlincha/2319.html">PM</a>
                                    </div>
                                  </li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td align="left" nowrap valign="top" width="20">
                    <table cellpadding="0" cellspacing="0" width="20">
                        <tr>
                            <td class="t_userinfo" width="20" nowrap>
                <!-- member_title --><div class="">Gets Around</div><!-- /member_title -->
                <DIV align="center"><img class="adv" src="../../../../extensions/awc/forums/images/avatars/avatar_default.gif" border="0" height="0" width="0" align="middle"/></div>
                                
                                Threads <a href="../../search/memtopics/Ohlincha/1364.html">16</a><br />
                                Posts <a href="../../search/memposts/Ohlincha/1364.html">115</a>                              
                            </td>
                        </tr>
                    </table>
                </td>
                        
            		<td align="left" width="100%" valign="top" id="fullheight">
		                <table width="100%" cellpadding="0" cellspacing="0" class="post0" height="75">
		                    <tr>
		                        <td class="post_date" valign="bottom" height="1px"  width="100%" colspan="2"  nowrap><a target="blank" href="../../sp/id2319.html">11:03:18 PM PST - Thu, Nov 8th 2012 </a></td>
		                            <td class="post_date" valign="bottom" height="1px" width="100%" nowrap></td>

		                    </tr>
		                                     
		                    <tr>
		                        <td valign="top" class="post_body" height="65" colspan="2">Bert, <br />
The PQS energies and the remarks of Pulay (which is probably a bit more relevant) point towards the original authors using the form defined by Becke in J . Chem. Phys. 1993, 98(7), 5648-5652 (i.e. what's included in NWChem as the 'acm' functional) instead of the Gaussian '92 version (what's included as b3lyp in NWChem and most other programmes), so they most likely used VWN_5 and PW91 instead of VWN_1_RPA and (LYP-VWN_1_RPA).<br />
<br />
Anyway, thank you for your prompt response. Perhaps this is something that may be incorporated somewhere down the line?<br />
/Andy
</td>
		                    </tr>
		                                
		                    
		                    
		                </table>
		            </td>
        </tr> 
           
        <tr><td class="thread_sig" align="left" colspan="2"></td></tr>
        	
        </table>
<br />       <a name="post_2324"></a>       
        <table class="forum_posts" cellpadding="0" cellspacing="0" id="fullheight">
            <tr>
                <td width="100%" align="left" colspan="2" valign="top" class="mem_name" id="name_2324" nowrap>
                    <table width="100%" cellpadding="0" cellspacing="0">
                        <tr>
                            <td class="UserNameOptions" width="100%">
                                <ul id="UserNameOptions">
                                  <li>
                                     <a href="../../mem_profile/Bert/12.html" onmouseover="mopen('mem4')" onmouseout="mclosetime()">Bert</a>  <font class="group_text">Forum:Admin, Forum:Mod, NWChemDeveloper, bureaucrat, sysop</font>
                                    <div id="mem4" onmouseover="mcancelclosetime()" onmouseout="mclosetime()">
                                        <a href="../../mem_profile/Bert/12.html"><b>Profile</b></a><br />
                                        
                                        Send <a href="../../member_options/pmnew/Bert/2324.html">PM</a>
                                    </div>
                                  </li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td align="left" nowrap valign="top" width="20">
                    <table cellpadding="0" cellspacing="0" width="20">
                        <tr>
                            <td class="t_userinfo" width="20" nowrap>
                <!-- member_title --><div class="">Forum Vet</div><!-- /member_title -->
                <DIV align="center"><img class="adv" src="../../../../extensions/awc/forums/images/avatars/avatar_default.gif" border="0" height="0" width="0" align="middle"/></div>
                                
                                Threads <a href="../../search/memtopics/Bert/12.html">4</a><br />
                                Posts <a href="../../search/memposts/Bert/12.html">597</a>                              
                            </td>
                        </tr>
                    </table>
                </td>
                        
            		<td align="left" width="100%" valign="top" id="fullheight">
		                <table width="100%" cellpadding="0" cellspacing="0" class="post1" height="75">
		                    <tr>
		                        <td class="post_date" valign="bottom" height="1px"  width="100%" colspan="2"  nowrap><a target="blank" href="../../sp/id2324.html">10:55:44 AM PST - Fri, Nov 9th 2012 </a></td>
		                            <td class="post_date" valign="bottom" height="1px" width="100%" nowrap></td>

		                    </tr>
		                                     
		                    <tr>
		                        <td valign="top" class="post_body" height="65" colspan="2">We'll put adding a keyword and functionality to exclude exact exchange from the response calculation on our list.<br />
<br />
Thanks,<br />
<br />
Bert<br />
<br />
<br />
<div class='quote_title'>Quote:Ohlincha <a target='blank' href="../../sp/id2319.html" title="Special:AWCforum/sp/id2319">Nov 9th 6:03 am</a><div class='quote'>Bert, <br />
The PQS energies and the remarks of Pulay (which is probably a bit more relevant) point towards the original authors using the form defined by Becke in J . Chem. Phys. 1993, 98(7), 5648-5652 (i.e. what's included in NWChem as the 'acm' functional) instead of the Gaussian '92 version (what's included as b3lyp in NWChem and most other programmes), so they most likely used VWN_5 and PW91 instead of VWN_1_RPA and (LYP-VWN_1_RPA).<br />
<br />
Anyway, thank you for your prompt response. Perhaps this is something that may be incorporated somewhere down the line?<br />
/Andy</div id="quote"></div id="quote">
</td>
		                    </tr>
		                                
		                    
		                    
		                </table>
		            </td>
        </tr> 
           
        <tr><td class="thread_sig" align="left" colspan="2"></td></tr>
        	
        </table>
<br />       <a name="post_2366"></a>       
        <table class="forum_posts" cellpadding="0" cellspacing="0" id="fullheight">
            <tr>
                <td width="100%" align="left" colspan="2" valign="top" class="mem_name" id="name_2366" nowrap>
                    <table width="100%" cellpadding="0" cellspacing="0">
                        <tr>
                            <td class="UserNameOptions" width="100%">
                                <ul id="UserNameOptions">
                                  <li>
                                     <a href="../../mem_profile/Ohlincha/1364.html" onmouseover="mopen('mem5')" onmouseout="mclosetime()">Ohlincha</a>  <font class="group_text">Member</font>
                                    <div id="mem5" onmouseover="mcancelclosetime()" onmouseout="mclosetime()">
                                        <a href="../../mem_profile/Ohlincha/1364.html"><b>Profile</b></a><br />
                                        
                                        Send <a href="../../member_options/pmnew/Ohlincha/2366.html">PM</a>
                                    </div>
                                  </li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td align="left" nowrap valign="top" width="20">
                    <table cellpadding="0" cellspacing="0" width="20">
                        <tr>
                            <td class="t_userinfo" width="20" nowrap>
                <!-- member_title --><div class="">Gets Around</div><!-- /member_title -->
                <DIV align="center"><img class="adv" src="../../../../extensions/awc/forums/images/avatars/avatar_default.gif" border="0" height="0" width="0" align="middle"/></div>
                                
                                Threads <a href="../../search/memtopics/Ohlincha/1364.html">16</a><br />
                                Posts <a href="../../search/memposts/Ohlincha/1364.html">115</a>                              
                            </td>
                        </tr>
                    </table>
                </td>
                        
            		<td align="left" width="100%" valign="top" id="fullheight">
		                <table width="100%" cellpadding="0" cellspacing="0" class="post0" height="75">
		                    <tr>
		                        <td class="post_date" valign="bottom" height="1px"  width="100%" colspan="2"  nowrap><a target="blank" href="../../sp/id2366.html">6:38:27 PM PST - Wed, Nov 14th 2012 </a></td>
		                            <td class="post_date" valign="bottom" height="1px" width="100%" nowrap></td>

		                    </tr>
		                                     
		                    <tr>
		                        <td valign="top" class="post_body" height="65" colspan="2">Cheers Bert. <br />
Let me know if/when it makes it into the development version and I'll be happy to test it against the published data set.<br />
<br />
Hopefully such a switch will be enough to make it work - I tried editing (in NWChem 6.1) a number of files in src/property: <br />
aoresponse_giao_rhs.F, giao_b1_movecs.F, giaofock.F, hnd_giaox.F, hnd_giaox_zora.F, int_giao_1ega.F<br />
<br />
and changing to <br />
<br />

<pre>
        xfac = 0.0d0
c      if (use_theory.eq.'dft') xfac = bgj_kfac()
</pre><br />
<br />
but then again I would claim to know what I'm doing and it obviously still iteratively solves the matrix rather than diagonalise it.<br />
<br />
/Andy
</td>
		                    </tr>
		                                
		                    <tr>
	<td class="edited_on" align="left" colspan="2">
		<b><a href="../../post/edithistory/2366.html">Edited On</a></b> 6:39:15 PM PST - Wed, Nov 14th 2012 <b>by</b> Ohlincha
	</td>
</tr>
		                    
		                </table>
		            </td>
        </tr> 
           
        <tr><td class="thread_sig" align="left" colspan="2"></td></tr>
        	
        </table>
<br />       <a name="post_2370"></a>       
        <table class="forum_posts" cellpadding="0" cellspacing="0" id="fullheight">
            <tr>
                <td width="100%" align="left" colspan="2" valign="top" class="mem_name" id="name_2370" nowrap>
                    <table width="100%" cellpadding="0" cellspacing="0">
                        <tr>
                            <td class="UserNameOptions" width="100%">
                                <ul id="UserNameOptions">
                                  <li>
                                     <a href="../../mem_profile/Bert/12.html" onmouseover="mopen('mem6')" onmouseout="mclosetime()">Bert</a>  <font class="group_text">Forum:Admin, Forum:Mod, NWChemDeveloper, bureaucrat, sysop</font>
                                    <div id="mem6" onmouseover="mcancelclosetime()" onmouseout="mclosetime()">
                                        <a href="../../mem_profile/Bert/12.html"><b>Profile</b></a><br />
                                        
                                        Send <a href="../../member_options/pmnew/Bert/2370.html">PM</a>
                                    </div>
                                  </li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td align="left" nowrap valign="top" width="20">
                    <table cellpadding="0" cellspacing="0" width="20">
                        <tr>
                            <td class="t_userinfo" width="20" nowrap>
                <!-- member_title --><div class="">Forum Vet</div><!-- /member_title -->
                <DIV align="center"><img class="adv" src="../../../../extensions/awc/forums/images/avatars/avatar_default.gif" border="0" height="0" width="0" align="middle"/></div>
                                
                                Threads <a href="../../search/memtopics/Bert/12.html">4</a><br />
                                Posts <a href="../../search/memposts/Bert/12.html">597</a>                              
                            </td>
                        </tr>
                    </table>
                </td>
                        
            		<td align="left" width="100%" valign="top" id="fullheight">
		                <table width="100%" cellpadding="0" cellspacing="0" class="post1" height="75">
		                    <tr>
		                        <td class="post_date" valign="bottom" height="1px"  width="100%" colspan="2"  nowrap><a target="blank" href="../../sp/id2370.html">9:45:38 AM PST - Thu, Nov 15th 2012 </a></td>
		                            <td class="post_date" valign="bottom" height="1px" width="100%" nowrap></td>

		                    </tr>
		                                     
		                    <tr>
		                        <td valign="top" class="post_body" height="65" colspan="2">Yes, it would still do it iteratively, but using only one iteration as the linear equation would be now uncoupled. Effectively, it diagonalizes it in one iteration. Hence, if that's what you see when you try it, you may have created a solution for yourself.<br />
<br />
Bert<br />
<br />
<br />
<div class='quote_title'>Quote:Ohlincha <a target='blank' href="../../sp/id2366.html" title="Special:AWCforum/sp/id2366">Nov 15th 1:38 am</a><div class='quote'>Cheers Bert. <br />
Let me know if/when it makes it into the development version and I'll be happy to test it against the published data set.<br />
<br />
Hopefully such a switch will be enough to make it work - I tried editing (in NWChem 6.1) a number of files in src/property: <br />
aoresponse_giao_rhs.F, giao_b1_movecs.F, giaofock.F, hnd_giaox.F, hnd_giaox_zora.F, int_giao_1ega.F<br />
<br />
and changing to <br />
<br />

<pre>
        xfac = 0.0d0
c      if (use_theory.eq.'dft') xfac = bgj_kfac()
</pre><br />
<br />
but then again I would claim to know what I'm doing and it obviously still iteratively solves the matrix rather than diagonalise it.<br />
<br />
/Andy</div id="quote"></div id="quote">
</td>
		                    </tr>
		                                
		                    
		                    
		                </table>
		            </td>
        </tr> 
           
        <tr><td class="thread_sig" align="left" colspan="2"></td></tr>
        	
        </table>
<br />       <a name="post_2380"></a>       
        <table class="forum_posts" cellpadding="0" cellspacing="0" id="fullheight">
            <tr>
                <td width="100%" align="left" colspan="2" valign="top" class="mem_name" id="name_2380" nowrap>
                    <table width="100%" cellpadding="0" cellspacing="0">
                        <tr>
                            <td class="UserNameOptions" width="100%">
                                <ul id="UserNameOptions">
                                  <li>
                                     <a href="../../mem_profile/Ohlincha/1364.html" onmouseover="mopen('mem7')" onmouseout="mclosetime()">Ohlincha</a>  <font class="group_text">Member</font>
                                    <div id="mem7" onmouseover="mcancelclosetime()" onmouseout="mclosetime()">
                                        <a href="../../mem_profile/Ohlincha/1364.html"><b>Profile</b></a><br />
                                        
                                        Send <a href="../../member_options/pmnew/Ohlincha/2380.html">PM</a>
                                    </div>
                                  </li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td align="left" nowrap valign="top" width="20">
                    <table cellpadding="0" cellspacing="0" width="20">
                        <tr>
                            <td class="t_userinfo" width="20" nowrap>
                <!-- member_title --><div class="">Gets Around</div><!-- /member_title -->
                <DIV align="center"><img class="adv" src="../../../../extensions/awc/forums/images/avatars/avatar_default.gif" border="0" height="0" width="0" align="middle"/></div>
                                
                                Threads <a href="../../search/memtopics/Ohlincha/1364.html">16</a><br />
                                Posts <a href="../../search/memposts/Ohlincha/1364.html">115</a>                              
                            </td>
                        </tr>
                    </table>
                </td>
                        
            		<td align="left" width="100%" valign="top" id="fullheight">
		                <table width="100%" cellpadding="0" cellspacing="0" class="post0" height="75">
		                    <tr>
		                        <td class="post_date" valign="bottom" height="1px"  width="100%" colspan="2"  nowrap><a target="blank" href="../../sp/id2380.html">10:07:28 PM PST - Thu, Nov 15th 2012 </a></td>
		                            <td class="post_date" valign="bottom" height="1px" width="100%" nowrap></td>

		                    </tr>
		                                     
		                    <tr>
		                        <td valign="top" class="post_body" height="65" colspan="2">Bert,<br />
I don't see much difference between the original 6.1 and my modified 6.1 code.<br />
<br />
The number of iterations are the same, and while there's a small change in the computed shift, it's small relative what should be obtained if the WIlson-Amos-Handy method has been successfully implemented (isotropic shifts -- C: 4.7 ppm and O: -44 ppm; see first post for references)<br />
<br />
Here's my test case<br />

<pre>
title &quot;co nmr&quot;
echo

geometry
c   0   0   0
o   0   0   1.13
end

basis 
    * library &quot;dzp (dunning)&quot;
end

property
    shielding
end

dft
 direct
 grid fine
 mult 1
 xc HFexch 0.05 slater 0.95 becke88 nonlocal 0.72 vwn_5 1 perdew91 0.81
end

task dft property
</pre><br />
<br />
Running it using my modified binary (v6.1) I get:<br />

<pre>
600    iter   nsub   residual    time
601    ----  ------  --------  ---------
602      1      3    1.70D-01       4.9
603      2      6    1.70D-03       5.6
604      3      9    2.93D-05       6.3
</pre><br />
<br />
For C I get<br />

<pre>
621            isotropic =      -2.8388$
622           anisotropy =     413.3050$
</pre><br />
and for O I get<br />

<pre>
650            isotropic =     -64.1336$
651           anisotropy =     711.1241$
</pre><br />
<br />
and with the original binary I see<br />

<pre>
600    iter   nsub   residual    time$
601    ----  ------  --------  ---------$
602      1      3    1.69D-01       5.0$
603      2      6    1.84D-03       5.8$
604      3      9    2.47D-05       6.5$
</pre><br />
<br />
For C I get<br />

<pre>
621            isotropic =       5.1483$
622           anisotropy =     401.3242$
</pre><br />
and for O I get<br />

<pre>
650            isotropic =     -60.6964$
651           anisotropy =     705.9682$
</pre><br />
<br />
when I do <br />

<pre>
cat *|grep &quot;xfac =&quot;
</pre><br />
I can't find any unedited examples -- i.e. I've already changed them all to 0 and have commented out "if (use_theory.eq.'dft') xfac = bgj_kfac()"<br />
<br />
I guess the most plausible explanation would be that there's more to these NMR calculations than it at first appears to be -- but then again, as you point out there should be a change in the number of iterations and there isn't.
</td>
		                    </tr>
		                                
		                    <tr>
	<td class="edited_on" align="left" colspan="2">
		<b><a href="../../post/edithistory/2380.html">Edited On</a></b> 10:09:16 PM PST - Thu, Nov 15th 2012 <b>by</b> Ohlincha
	</td>
</tr>
		                    
		                </table>
		            </td>
        </tr> 
           
        <tr><td class="thread_sig" align="left" colspan="2"></td></tr>
        	
        </table>
<br />       <a name="post_2397"></a>       
        <table class="forum_posts" cellpadding="0" cellspacing="0" id="fullheight">
            <tr>
                <td width="100%" align="left" colspan="2" valign="top" class="mem_name" id="name_2397" nowrap>
                    <table width="100%" cellpadding="0" cellspacing="0">
                        <tr>
                            <td class="UserNameOptions" width="100%">
                                <ul id="UserNameOptions">
                                  <li>
                                     <a href="../../mem_profile/Bert/12.html" onmouseover="mopen('mem8')" onmouseout="mclosetime()">Bert</a>  <font class="group_text">Forum:Admin, Forum:Mod, NWChemDeveloper, bureaucrat, sysop</font>
                                    <div id="mem8" onmouseover="mcancelclosetime()" onmouseout="mclosetime()">
                                        <a href="../../mem_profile/Bert/12.html"><b>Profile</b></a><br />
                                        
                                        Send <a href="../../member_options/pmnew/Bert/2397.html">PM</a>
                                    </div>
                                  </li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td align="left" nowrap valign="top" width="20">
                    <table cellpadding="0" cellspacing="0" width="20">
                        <tr>
                            <td class="t_userinfo" width="20" nowrap>
                <!-- member_title --><div class="">Forum Vet</div><!-- /member_title -->
                <DIV align="center"><img class="adv" src="../../../../extensions/awc/forums/images/avatars/avatar_default.gif" border="0" height="0" width="0" align="middle"/></div>
                                
                                Threads <a href="../../search/memtopics/Bert/12.html">4</a><br />
                                Posts <a href="../../search/memposts/Bert/12.html">597</a>                              
                            </td>
                        </tr>
                    </table>
                </td>
                        
            		<td align="left" width="100%" valign="top" id="fullheight">
		                <table width="100%" cellpadding="0" cellspacing="0" class="post1" height="75">
		                    <tr>
		                        <td class="post_date" valign="bottom" height="1px"  width="100%" colspan="2"  nowrap><a target="blank" href="../../sp/id2397.html">3:40:13 PM PST - Sat, Nov 17th 2012 </a></td>
		                            <td class="post_date" valign="bottom" height="1px" width="100%" nowrap></td>

		                    </tr>
		                                     
		                    <tr>
		                        <td valign="top" class="post_body" height="65" colspan="2">Yeah, because you're only taking the HF exchange out of the RHS, it's still included in the CPHF calculations later on. Try the attached <a target='blank' href="../../../../images/Hnd_giaox.F" class="internal" title="Hnd giaox.F">hnd_giaox.F</a>. I'm doing this while on travel. I think this may work, but I have not tested it.<br />
<br />
Bert<br />
<br />
<br />

<pre>[QUOTE=Ohlincha <a href="../../sp/id2380.html" title="Special:AWCforum/sp/id2380">Nov 16th 5:07 am</a>]Bert,<br />
</pre>
I don't see much difference between the original 6.1 and my modified 6.1 code.<br />
<br />
The number of iterations are the same, and while there's a small change in the computed shift, it's small relative what should be obtained if the WIlson-Amos-Handy method has been successfully implemented (isotropic shifts -- C: 4.7 ppm and O: -44 ppm; see first post for references)<br />
<br />
Here's my test case<br />

<pre>
title &quot;co nmr&quot;
echo

geometry
c   0   0   0
o   0   0   1.13
end

basis 
    * library &quot;dzp (dunning)&quot;
end

property
    shielding
end

dft
 direct
 grid fine
 mult 1
 xc HFexch 0.05 slater 0.95 becke88 nonlocal 0.72 vwn_5 1 perdew91 0.81
end

task dft property
</pre><br />
<br />
Running it using my modified binary (v6.1) I get:<br />

<pre>
600    iter   nsub   residual    time
601    ----  ------  --------  ---------
602      1      3    1.70D-01       4.9
603      2      6    1.70D-03       5.6
604      3      9    2.93D-05       6.3
</pre><br />
<br />
For C I get<br />

<pre>
621            isotropic =      -2.8388$
622           anisotropy =     413.3050$
</pre><br />
and for O I get<br />

<pre>
650            isotropic =     -64.1336$
651           anisotropy =     711.1241$
</pre><br />
<br />
and with the original binary I see<br />

<pre>
600    iter   nsub   residual    time$
601    ----  ------  --------  ---------$
602      1      3    1.69D-01       5.0$
603      2      6    1.84D-03       5.8$
604      3      9    2.47D-05       6.5$
</pre><br />
<br />
For C I get<br />

<pre>
621            isotropic =       5.1483$
622           anisotropy =     401.3242$
</pre><br />
and for O I get<br />

<pre>
650            isotropic =     -60.6964$
651           anisotropy =     705.9682$
</pre><br />
<br />
when I do <br />

<pre>
cat *|grep &quot;xfac =&quot;
</pre><br />
I can't find any unedited examples -- i.e. I've already changed them all to 0 and have commented out "if (use_theory.eq.'dft') xfac = bgj_kfac()"<br />
<br />
I guess the most plausible explanation would be that there's more to these NMR calculations than it at first appears to be -- but then again, as you point out there should be a change in the number of iterations and there isn't.</div id="quote"></div id="quote">
</td>
		                    </tr>
		                                
		                    <tr>
	<td class="edited_on" align="left" colspan="2">
		<b><a href="../../post/edithistory/2397.html">Edited On</a></b> 3:44:34 PM PST - Sat, Nov 17th 2012 <b>by</b> Bert
	</td>
</tr>
		                    
		                </table>
		            </td>
        </tr> 
           
        <tr><td class="thread_sig" align="left" colspan="2"></td></tr>
        	
        </table>
<br />       <a name="post_2418"></a>       
        <table class="forum_posts" cellpadding="0" cellspacing="0" id="fullheight">
            <tr>
                <td width="100%" align="left" colspan="2" valign="top" class="mem_name" id="name_2418" nowrap>
                    <table width="100%" cellpadding="0" cellspacing="0">
                        <tr>
                            <td class="UserNameOptions" width="100%">
                                <ul id="UserNameOptions">
                                  <li>
                                     <a href="../../mem_profile/Ohlincha/1364.html" onmouseover="mopen('mem9')" onmouseout="mclosetime()">Ohlincha</a>  <font class="group_text">Member</font>
                                    <div id="mem9" onmouseover="mcancelclosetime()" onmouseout="mclosetime()">
                                        <a href="../../mem_profile/Ohlincha/1364.html"><b>Profile</b></a><br />
                                        
                                        Send <a href="../../member_options/pmnew/Ohlincha/2418.html">PM</a>
                                    </div>
                                  </li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td align="left" nowrap valign="top" width="20">
                    <table cellpadding="0" cellspacing="0" width="20">
                        <tr>
                            <td class="t_userinfo" width="20" nowrap>
                <!-- member_title --><div class="">Gets Around</div><!-- /member_title -->
                <DIV align="center"><img class="adv" src="../../../../extensions/awc/forums/images/avatars/avatar_default.gif" border="0" height="0" width="0" align="middle"/></div>
                                
                                Threads <a href="../../search/memtopics/Ohlincha/1364.html">16</a><br />
                                Posts <a href="../../search/memposts/Ohlincha/1364.html">115</a>                              
                            </td>
                        </tr>
                    </table>
                </td>
                        
            		<td align="left" width="100%" valign="top" id="fullheight">
		                <table width="100%" cellpadding="0" cellspacing="0" class="post0" height="75">
		                    <tr>
		                        <td class="post_date" valign="bottom" height="1px"  width="100%" colspan="2"  nowrap><a target="blank" href="../../sp/id2418.html">2:58:49 PM PST - Mon, Nov 19th 2012 </a></td>
		                            <td class="post_date" valign="bottom" height="1px" width="100%" nowrap></td>

		                    </tr>
		                                     
		                    <tr>
		                        <td valign="top" class="post_body" height="65" colspan="2">Bert,<br />
I couldn't kompile with the file you provided (debian, gcc 4.7),but with the following modifications it worked fine:<br />

<pre>
16c16
&lt; c#include &quot;../nwdft/include/cdft.fh&quot;
---
&gt; #include &quot;../nwdft/include/cdft.fh&quot;
33c33
&lt;       double precision jfac(3),kfac(3),a(6),axs(3,3),eig(3),xfac(1)
---
&gt;       double precision jfac(3),kfac(3),a(6),axs(3,3),eig(3)
42d41
&lt;       logical do_wah
</pre><br />
<br />
To my nwchem input I added<br />

<pre>
set dft:wah true
</pre><br />
which I guess should be right:<br />

<pre>
cat co.db|strings|grep dft
   dft:wah
  &nbsp;!rtdb!dft:wah
</pre><br />
but the shifts are the same as for the unmodified code (see below), and the number of iterations are not affected.<br />
<br />
This is the case both when I modify xfac in the other files in src/property, and when I don't.<br />
<br />
I also tried forcing wah by removing the if construct (i.e. same as if do_wah is true every time)<br />

<pre>
16c16
&lt; c#include &quot;../nwdft/include/cdft.fh&quot;
---
&gt; #include &quot;../nwdft/include/cdft.fh&quot;
33c33
&lt;       double precision jfac(3),kfac(3),a(6),axs(3,3),eig(3),xfac(1)
---
&gt;       double precision jfac(3),kfac(3),a(6),axs(3,3),eig(3)
76,78c76,78
&lt; c      if (.not. rtdb_get(rtdb, 'dft:wah', mt_log, 1, do_wah))
&lt; c     $   do_wah = .false.
&lt; c      if (do_wah) then
---
&gt;       if (.not. rtdb_get(rtdb, 'dft:wah', mt_log, 1, do_wah))
&gt;      $   do_wah = .false.
&gt;       if (do_wah) then
81c81
&lt; c      endif
---
&gt;       endif
872c872
&lt; c      if (do_wah) then
---
&gt;       if (do_wah) then
874c874
&lt; c      endif
---
&gt;       endif
</pre><br />
But it didn't make any difference.<br />
<br />
For either version of the code I get<br />
<br />
For Carbon:<br />

<pre>
           isotropic =       5.1483
          anisotropy =     401.3242
</pre><br />
For Oxygen:<br />

<pre>
           isotropic =     -60.6964
          anisotropy =     705.9682
</pre><br />
<br />
I've tried a number of permutations but with little luck in terms of isotopic shift changes.<br />
<br />
PS It's also become more difficult to post on the forum in the past week or two owing to the 'The specified URL cannot be found" issue.
</td>
		                    </tr>
		                                
		                    <tr>
	<td class="edited_on" align="left" colspan="2">
		<b><a href="../../post/edithistory/2418.html">Edited On</a></b> 11:05:29 PM PST - Tue, Nov 20th 2012 <b>by</b> Ohlincha
	</td>
</tr>
		                    
		                </table>
		            </td>
        </tr> 
           
        <tr><td class="thread_sig" align="left" colspan="2"></td></tr>
        	
        </table>
<br />       <a name="post_2442"></a>       
        <table class="forum_posts" cellpadding="0" cellspacing="0" id="fullheight">
            <tr>
                <td width="100%" align="left" colspan="2" valign="top" class="mem_name" id="name_2442" nowrap>
                    <table width="100%" cellpadding="0" cellspacing="0">
                        <tr>
                            <td class="UserNameOptions" width="100%">
                                <ul id="UserNameOptions">
                                  <li>
                                     <a href="../../mem_profile/Bert/12.html" onmouseover="mopen('mem10')" onmouseout="mclosetime()">Bert</a>  <font class="group_text">Forum:Admin, Forum:Mod, NWChemDeveloper, bureaucrat, sysop</font>
                                    <div id="mem10" onmouseover="mcancelclosetime()" onmouseout="mclosetime()">
                                        <a href="../../mem_profile/Bert/12.html"><b>Profile</b></a><br />
                                        
                                        Send <a href="../../member_options/pmnew/Bert/2442.html">PM</a>
                                    </div>
                                  </li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td align="left" nowrap valign="top" width="20">
                    <table cellpadding="0" cellspacing="0" width="20">
                        <tr>
                            <td class="t_userinfo" width="20" nowrap>
                <!-- member_title --><div class="">Forum Vet</div><!-- /member_title -->
                <DIV align="center"><img class="adv" src="../../../../extensions/awc/forums/images/avatars/avatar_default.gif" border="0" height="0" width="0" align="middle"/></div>
                                
                                Threads <a href="../../search/memtopics/Bert/12.html">4</a><br />
                                Posts <a href="../../search/memposts/Bert/12.html">597</a>                              
                            </td>
                        </tr>
                    </table>
                </td>
                        
            		<td align="left" width="100%" valign="top" id="fullheight">
		                <table width="100%" cellpadding="0" cellspacing="0" class="post1" height="75">
		                    <tr>
		                        <td class="post_date" valign="bottom" height="1px"  width="100%" colspan="2"  nowrap><a target="blank" href="../../sp/id2442.html">10:13:05 AM PST - Wed, Nov 21st 2012 </a></td>
		                            <td class="post_date" valign="bottom" height="1px" width="100%" nowrap></td>

		                    </tr>
		                                     
		                    <tr>
		                        <td valign="top" class="post_body" height="65" colspan="2">Your fixing is never ever going to work. Key is the modification of xfac in the data block that is in cdft.fh . This is what is used by the CPHF routine and outside of hnd_giaox.F. You cannot simply fix this within this one routine. CPHF does the response calculation using the RHS constructed in hnd_giaox.F. There it also uses the HF Exchange.<br />
<br />
I can see why it may not have compiled, forgot to define do_wah as a logical.<br />
<br />
Hence, in the hnd_giaox.F file I provided, add somewhere at the top where all the variables are defined:<br />
<br />

<pre>     logical  do_wah<br />
</pre>
<br />
Also, in the input add the following (as you already figured out):<br />
<br />

<pre>     set dft:wah  .true.<br />
</pre>
<br />
If it doesn't compile, get me the error message.<br />
<br />
Bert<br />
<br />
<br />
<br />
<div class='quote_title'>Quote:Bert <a target='blank' href="../../sp/id2397.html" title="Special:AWCforum/sp/id2397">Nov 17th 10:40 pm</a><div class='quote'>Yeah, because you're only taking the HF exchange out of the RHS, it's still included in the CPHF calculations later on. Try the attached <a target='blank' href="../../../../images/Hnd_giaox.F" class="internal" title="Hnd giaox.F">hnd_giaox.F</a>. I'm doing this while on travel. I think this may work, but I have not tested it.<br />
<br />
Bert<br />
<br />
<br />

<pre>[QUOTE=Ohlincha <a href="../../sp/id2380.html" title="Special:AWCforum/sp/id2380">Nov 16th 5:07 am</a>]Bert,<br />
</pre>
I don't see much difference between the original 6.1 and my modified 6.1 code.<br />
<br />
The number of iterations are the same, and while there's a small change in the computed shift, it's small relative what should be obtained if the WIlson-Amos-Handy method has been successfully implemented (isotropic shifts -- C: 4.7 ppm and O: -44 ppm; see first post for references)<br />
<br />
Here's my test case<br />

<pre>
title &quot;co nmr&quot;
echo

geometry
c   0   0   0
o   0   0   1.13
end

basis 
    * library &quot;dzp (dunning)&quot;
end

property
    shielding
end

dft
 direct
 grid fine
 mult 1
 xc HFexch 0.05 slater 0.95 becke88 nonlocal 0.72 vwn_5 1 perdew91 0.81
end

task dft property
</pre><br />
<br />
Running it using my modified binary (v6.1) I get:<br />

<pre>
600    iter   nsub   residual    time
601    ----  ------  --------  ---------
602      1      3    1.70D-01       4.9
603      2      6    1.70D-03       5.6
604      3      9    2.93D-05       6.3
</pre><br />
<br />
For C I get<br />

<pre>
621            isotropic =      -2.8388$
622           anisotropy =     413.3050$
</pre><br />
and for O I get<br />

<pre>
650            isotropic =     -64.1336$
651           anisotropy =     711.1241$
</pre><br />
<br />
and with the original binary I see<br />

<pre>
600    iter   nsub   residual    time$
601    ----  ------  --------  ---------$
602      1      3    1.69D-01       5.0$
603      2      6    1.84D-03       5.8$
604      3      9    2.47D-05       6.5$
</pre><br />
<br />
For C I get<br />

<pre>
621            isotropic =       5.1483$
622           anisotropy =     401.3242$
</pre><br />
and for O I get<br />

<pre>
650            isotropic =     -60.6964$
651           anisotropy =     705.9682$
</pre><br />
<br />
when I do <br />

<pre>
cat *|grep &quot;xfac =&quot;
</pre><br />
I can't find any unedited examples -- i.e. I've already changed them all to 0 and have commented out "if (use_theory.eq.'dft') xfac = bgj_kfac()"<br />
<br />
I guess the most plausible explanation would be that there's more to these NMR calculations than it at first appears to be -- but then again, as you point out there should be a change in the number of iterations and there isn't.</div id="quote"></div id="quote"></div id="quote"></div id="quote">
</td>
		                    </tr>
		                                
		                    
		                    
		                </table>
		            </td>
        </tr> 
           
        <tr><td class="thread_sig" align="left" colspan="2"></td></tr>
        	
        </table>
<br />       <a name="post_2447"></a>       
        <table class="forum_posts" cellpadding="0" cellspacing="0" id="fullheight">
            <tr>
                <td width="100%" align="left" colspan="2" valign="top" class="mem_name" id="name_2447" nowrap>
                    <table width="100%" cellpadding="0" cellspacing="0">
                        <tr>
                            <td class="UserNameOptions" width="100%">
                                <ul id="UserNameOptions">
                                  <li>
                                     <a href="../../mem_profile/Ohlincha/1364.html" onmouseover="mopen('mem11')" onmouseout="mclosetime()">Ohlincha</a>  <font class="group_text">Member</font>
                                    <div id="mem11" onmouseover="mcancelclosetime()" onmouseout="mclosetime()">
                                        <a href="../../mem_profile/Ohlincha/1364.html"><b>Profile</b></a><br />
                                        
                                        Send <a href="../../member_options/pmnew/Ohlincha/2447.html">PM</a>
                                    </div>
                                  </li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td align="left" nowrap valign="top" width="20">
                    <table cellpadding="0" cellspacing="0" width="20">
                        <tr>
                            <td class="t_userinfo" width="20" nowrap>
                <!-- member_title --><div class="">Gets Around</div><!-- /member_title -->
                <DIV align="center"><img class="adv" src="../../../../extensions/awc/forums/images/avatars/avatar_default.gif" border="0" height="0" width="0" align="middle"/></div>
                                
                                Threads <a href="../../search/memtopics/Ohlincha/1364.html">16</a><br />
                                Posts <a href="../../search/memposts/Ohlincha/1364.html">115</a>                              
                            </td>
                        </tr>
                    </table>
                </td>
                        
            		<td align="left" width="100%" valign="top" id="fullheight">
		                <table width="100%" cellpadding="0" cellspacing="0" class="post0" height="75">
		                    <tr>
		                        <td class="post_date" valign="bottom" height="1px"  width="100%" colspan="2"  nowrap><a target="blank" href="../../sp/id2447.html">2:58:48 PM PST - Wed, Nov 21st 2012 </a></td>
		                            <td class="post_date" valign="bottom" height="1px" width="100%" nowrap></td>

		                    </tr>
		                                     
		                    <tr>
		                        <td valign="top" class="post_body" height="65" colspan="2"><pre>
giaofock.F:371:0: warning: ‘ntot’ may be used uninitialized in this function [-Wmaybe-uninitialized]
giaofock.F:508:0: warning: ‘factor_cam’ may be used uninitialized in this function [-Wmaybe-uninitialized]
../nwdft/include/cdft.fh:82.29:
    Included at hnd_giaox.F:17:

     &amp;     nrinc, nrmax, geom, ncenters, nbf, nradpts, nang_leb_pts,
                               1
Error: COMMON attribute conflicts with DUMMY attribute in 'geom' at (1)
hnd_giaox.F:20.18:

      integer geom   &nbsp;! [input] geometry handle                         
                  1
Error: Symbol 'geom' at (1) already has basic type of INTEGER
hnd_giaox.F:22.56:

      integer nclosed(2), nopen(2), nvirt(2), ndens, nbf, nmo           
                                                        1
Error: Symbol 'nbf' at (1) already has basic type of INTEGER
hnd_giaox.F:45.23:

      logical     oskel, status, debug                                  
                       1
Error: Symbol 'oskel' at (1) already has basic type of LOGICAL
hnd_giaox.F:81.13:

         xfac(1) = 0.0d0                                                
             1
Error: 'xfac' at (1) is not a variable
hnd_giaox.F:874.13:

         xfac(1) = kfac_org                                             
             1
Error: 'xfac' at (1) is not a variable
hnd_giaox.F:66.11:

      debug = .false. .and. (ga_nodeid().eq.0)&nbsp;! special debugging      
           1
Error: Symbol debug at (1) has no IMPLICIT type
hnd_giaox.F:144.56:

      call hnd_prp_get_dens(rtdb,geom,basis,g_dens,ndens,scftyp,        
                                                        1
Error: Symbol ndens at (1) has no IMPLICIT type
hnd_giaox.F:140.46:

     &amp;                      dbl_mb(k_eval),nmo)                         
                                              1
Error: Symbol nmo at (1) has no IMPLICIT type
hnd_giaox.F:138.61:

      call hnd_prp_vec_read(rtdb,geom,basis,nbf,nclosed,nopen,          
                                                             1
Error: Symbol nopen at (1) has no IMPLICIT type
hnd_giaox.F:101.12:

      status = rtdb_parallel(.true.)                                    
            1
Error: Symbol status at (1) has no IMPLICIT type
hnd_giaox.F:138.55:

      call hnd_prp_vec_read(rtdb,geom,basis,nbf,nclosed,nopen,          
                                                       1
Error: Symbol nclosed at (1) has no IMPLICIT type
hnd_giaox.F:161.15:

      ahi(2) = nclosed(1)                                               
               1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:170.47:

      if(.not.ga_create(MT_DBL,nclosed(1)*nvirt(1),3,RHS,-1,-1,g_rhs))
                                               1
Error: Function nvirt at (1) has no IMPLICIT type
hnd_giaox.F:180.31:

      bhi(1) = nclosed(1)*nvirt(1)                                      
                               1
Error: Function nvirt at (1) has no IMPLICIT type
hnd_giaox.F:202.15:

      alo(1) = nclosed(1)+1                                             
               1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:206.18:

      do iocc = 1, nclosed(1)                                           
                  1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:220.15:

      ahi(2) = nclosed(1)                                               
               1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:230.15:

      ahi(1) = nclosed(1)                                               
               1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:264.15:

      dhi(2) = nclosed(1)                                               
               1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:278.18:

         ahi(2) = nclosed(1)                                            
                  1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:283.18:

         ahi(1) = nclosed(1)                                            
                  1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:284.18:

         bhi(2) = nclosed(1)                                            
                  1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:328.15:

      ahi(2) = nclosed(1)                                               
               1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:340.15:

      clo(2) = nclosed(1)+1                                             
               1
Error: Function nclosed at (1) has no IMPLICIT type
Fatal Error: Error count reached limit of 25.
</pre><br />
<br />
Im building the development version from October using the following script on debian (gcc 4.7):<br />

<pre>
export LARGE_FILES=TRUE
export TCGRSH=/usr/bin/ssh
export NWCHEM_TOP=`pwd`
export NWCHEM_TARGET=LINUX64
export NWCHEM_MODULES=&quot;all&quot;
export BLASOPT=&quot;-L/opt/openblas/lib -lopenblas&quot;
export USE_MPI=y
export USE_MPIF=y
export USE_MPIF4=y
export MPI_LOC=/usr/lib/openmpi/lib
export MPI_INCLUDE=/usr/lib/openmpi/include
export LIBRARY_PATH=$LIBRARY_PATH:/usr/lib/openmpi/lib:/opt/openblas/lib
export LIBMPI=&quot;-lmpi -lopen-rte -lopen-pal -ldl -lmpi_f77 -lpthread&quot;
cd $NWCHEM_TOP/src
export FC=gfortran
make clean
make nwchem_config
make FC=gfortran 1&gt; make.log 2&gt;make.err
cd ../contrib
./getmem.nwchem
</pre><br />
<br />
It builds the unmodified code without any issues.<br />
<br />
<br />
(The "URL cannot be found" is apparently also triggered by too many apostrofes in a code bracket environment)
</td>
		                    </tr>
		                                
		                    
		                    
		                </table>
		            </td>
        </tr> 
           
        <tr><td class="thread_sig" align="left" colspan="2"></td></tr>
        	
        </table>
<br />       <a name="post_2449"></a>       
        <table class="forum_posts" cellpadding="0" cellspacing="0" id="fullheight">
            <tr>
                <td width="100%" align="left" colspan="2" valign="top" class="mem_name" id="name_2449" nowrap>
                    <table width="100%" cellpadding="0" cellspacing="0">
                        <tr>
                            <td class="UserNameOptions" width="100%">
                                <ul id="UserNameOptions">
                                  <li>
                                     <a href="../../mem_profile/Bert/12.html" onmouseover="mopen('mem12')" onmouseout="mclosetime()">Bert</a>  <font class="group_text">Forum:Admin, Forum:Mod, NWChemDeveloper, bureaucrat, sysop</font>
                                    <div id="mem12" onmouseover="mcancelclosetime()" onmouseout="mclosetime()">
                                        <a href="../../mem_profile/Bert/12.html"><b>Profile</b></a><br />
                                        
                                        Send <a href="../../member_options/pmnew/Bert/2449.html">PM</a>
                                    </div>
                                  </li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td align="left" nowrap valign="top" width="20">
                    <table cellpadding="0" cellspacing="0" width="20">
                        <tr>
                            <td class="t_userinfo" width="20" nowrap>
                <!-- member_title --><div class="">Forum Vet</div><!-- /member_title -->
                <DIV align="center"><img class="adv" src="../../../../extensions/awc/forums/images/avatars/avatar_default.gif" border="0" height="0" width="0" align="middle"/></div>
                                
                                Threads <a href="../../search/memtopics/Bert/12.html">4</a><br />
                                Posts <a href="../../search/memposts/Bert/12.html">597</a>                              
                            </td>
                        </tr>
                    </table>
                </td>
                        
            		<td align="left" width="100%" valign="top" id="fullheight">
		                <table width="100%" cellpadding="0" cellspacing="0" class="post1" height="75">
		                    <tr>
		                        <td class="post_date" valign="bottom" height="1px"  width="100%" colspan="2"  nowrap><a target="blank" href="../../sp/id2449.html">5:55:52 PM PST - Wed, Nov 21st 2012 </a></td>
		                            <td class="post_date" valign="bottom" height="1px" width="100%" nowrap></td>

		                    </tr>
		                                     
		                    <tr>
		                        <td valign="top" class="post_body" height="65" colspan="2">OK. As I said, I gave you a possible solution but I had no chance to compile it remotely. Back home now, I made some changes. Try the attached <a target='blank' href="../../../../images/Hnd_giaox.F" class="internal" title="Hnd giaox.F">hnd_giaox.F</a>.<br />
<br />
Bert<br />
<br />
<br />

<div class='quote_title'>Quote:Ohlincha <a target='blank' href="../../sp/id2447.html" title="Special:AWCforum/sp/id2447">Nov 21st 9:58 pm</a><div class='quote'><pre>
giaofock.F:371:0: warning: ‘ntot’ may be used uninitialized in this function [-Wmaybe-uninitialized]
giaofock.F:508:0: warning: ‘factor_cam’ may be used uninitialized in this function [-Wmaybe-uninitialized]
../nwdft/include/cdft.fh:82.29:
    Included at hnd_giaox.F:17:

     &amp;     nrinc, nrmax, geom, ncenters, nbf, nradpts, nang_leb_pts,
                               1
Error: COMMON attribute conflicts with DUMMY attribute in 'geom' at (1)
hnd_giaox.F:20.18:

      integer geom   &nbsp;! [input] geometry handle                         
                  1
Error: Symbol 'geom' at (1) already has basic type of INTEGER
hnd_giaox.F:22.56:

      integer nclosed(2), nopen(2), nvirt(2), ndens, nbf, nmo           
                                                        1
Error: Symbol 'nbf' at (1) already has basic type of INTEGER
hnd_giaox.F:45.23:

      logical     oskel, status, debug                                  
                       1
Error: Symbol 'oskel' at (1) already has basic type of LOGICAL
hnd_giaox.F:81.13:

         xfac(1) = 0.0d0                                                
             1
Error: 'xfac' at (1) is not a variable
hnd_giaox.F:874.13:

         xfac(1) = kfac_org                                             
             1
Error: 'xfac' at (1) is not a variable
hnd_giaox.F:66.11:

      debug = .false. .and. (ga_nodeid().eq.0)&nbsp;! special debugging      
           1
Error: Symbol debug at (1) has no IMPLICIT type
hnd_giaox.F:144.56:

      call hnd_prp_get_dens(rtdb,geom,basis,g_dens,ndens,scftyp,        
                                                        1
Error: Symbol ndens at (1) has no IMPLICIT type
hnd_giaox.F:140.46:

     &amp;                      dbl_mb(k_eval),nmo)                         
                                              1
Error: Symbol nmo at (1) has no IMPLICIT type
hnd_giaox.F:138.61:

      call hnd_prp_vec_read(rtdb,geom,basis,nbf,nclosed,nopen,          
                                                             1
Error: Symbol nopen at (1) has no IMPLICIT type
hnd_giaox.F:101.12:

      status = rtdb_parallel(.true.)                                    
            1
Error: Symbol status at (1) has no IMPLICIT type
hnd_giaox.F:138.55:

      call hnd_prp_vec_read(rtdb,geom,basis,nbf,nclosed,nopen,          
                                                       1
Error: Symbol nclosed at (1) has no IMPLICIT type
hnd_giaox.F:161.15:

      ahi(2) = nclosed(1)                                               
               1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:170.47:

      if(.not.ga_create(MT_DBL,nclosed(1)*nvirt(1),3,RHS,-1,-1,g_rhs))
                                               1
Error: Function nvirt at (1) has no IMPLICIT type
hnd_giaox.F:180.31:

      bhi(1) = nclosed(1)*nvirt(1)                                      
                               1
Error: Function nvirt at (1) has no IMPLICIT type
hnd_giaox.F:202.15:

      alo(1) = nclosed(1)+1                                             
               1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:206.18:

      do iocc = 1, nclosed(1)                                           
                  1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:220.15:

      ahi(2) = nclosed(1)                                               
               1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:230.15:

      ahi(1) = nclosed(1)                                               
               1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:264.15:

      dhi(2) = nclosed(1)                                               
               1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:278.18:

         ahi(2) = nclosed(1)                                            
                  1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:283.18:

         ahi(1) = nclosed(1)                                            
                  1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:284.18:

         bhi(2) = nclosed(1)                                            
                  1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:328.15:

      ahi(2) = nclosed(1)                                               
               1
Error: Function nclosed at (1) has no IMPLICIT type
hnd_giaox.F:340.15:

      clo(2) = nclosed(1)+1                                             
               1
Error: Function nclosed at (1) has no IMPLICIT type
Fatal Error: Error count reached limit of 25.
</pre><br />
<br />
Im building the development version from October using the following script on debian (gcc 4.7):<br />

<pre>
export LARGE_FILES=TRUE
export TCGRSH=/usr/bin/ssh
export NWCHEM_TOP=`pwd`
export NWCHEM_TARGET=LINUX64
export NWCHEM_MODULES=&quot;all&quot;
export BLASOPT=&quot;-L/opt/openblas/lib -lopenblas&quot;
export USE_MPI=y
export USE_MPIF=y
export USE_MPIF4=y
export MPI_LOC=/usr/lib/openmpi/lib
export MPI_INCLUDE=/usr/lib/openmpi/include
export LIBRARY_PATH=$LIBRARY_PATH:/usr/lib/openmpi/lib:/opt/openblas/lib
export LIBMPI=&quot;-lmpi -lopen-rte -lopen-pal -ldl -lmpi_f77 -lpthread&quot;
cd $NWCHEM_TOP/src
export FC=gfortran
make clean
make nwchem_config
make FC=gfortran 1&gt; make.log 2&gt;make.err
cd ../contrib
./getmem.nwchem
</pre><br />
<br />
It builds the unmodified code without any issues.<br />
<br />
<br />
(The "URL cannot be found" is apparently also triggered by too many apostrofes in a code bracket environment)</div id="quote"></div id="quote">
</td>
		                    </tr>
		                                
		                    
		                    
		                </table>
		            </td>
        </tr> 
           
        <tr><td class="thread_sig" align="left" colspan="2"></td></tr>
        	
        </table>
<br />       <a name="post_2451"></a>       
        <table class="forum_posts" cellpadding="0" cellspacing="0" id="fullheight">
            <tr>
                <td width="100%" align="left" colspan="2" valign="top" class="mem_name" id="name_2451" nowrap>
                    <table width="100%" cellpadding="0" cellspacing="0">
                        <tr>
                            <td class="UserNameOptions" width="100%">
                                <ul id="UserNameOptions">
                                  <li>
                                     <a href="../../mem_profile/Ohlincha/1364.html" onmouseover="mopen('mem13')" onmouseout="mclosetime()">Ohlincha</a>  <font class="group_text">Member</font>
                                    <div id="mem13" onmouseover="mcancelclosetime()" onmouseout="mclosetime()">
                                        <a href="../../mem_profile/Ohlincha/1364.html"><b>Profile</b></a><br />
                                        
                                        Send <a href="../../member_options/pmnew/Ohlincha/2451.html">PM</a>
                                    </div>
                                  </li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td align="left" nowrap valign="top" width="20">
                    <table cellpadding="0" cellspacing="0" width="20">
                        <tr>
                            <td class="t_userinfo" width="20" nowrap>
                <!-- member_title --><div class="">Gets Around</div><!-- /member_title -->
                <DIV align="center"><img class="adv" src="../../../../extensions/awc/forums/images/avatars/avatar_default.gif" border="0" height="0" width="0" align="middle"/></div>
                                
                                Threads <a href="../../search/memtopics/Ohlincha/1364.html">16</a><br />
                                Posts <a href="../../search/memposts/Ohlincha/1364.html">115</a>                              
                            </td>
                        </tr>
                    </table>
                </td>
                        
            		<td align="left" width="100%" valign="top" id="fullheight">
		                <table width="100%" cellpadding="0" cellspacing="0" class="post0" height="75">
		                    <tr>
		                        <td class="post_date" valign="bottom" height="1px"  width="100%" colspan="2"  nowrap><a target="blank" href="../../sp/id2451.html">9:58:04 PM PST - Wed, Nov 21st 2012 </a></td>
		                            <td class="post_date" valign="bottom" height="1px" width="100%" nowrap></td>

		                    </tr>
		                                     
		                    <tr>
		                        <td valign="top" class="post_body" height="65" colspan="2">Bert,<br />
Thank you for putting all this effort into this.<br />
<br />
NWChem now compiles fine and without any other modification.<br />
<br />
Running a normal calculation works fine and gives the expected results.<br />
<br />
Running a calculation with<br />

<pre>
set dft:wah .true.
</pre><br />
<br />
however gives a fatak error<br />

<pre>
                               NWChem CPHF Module
                                ------------------


  scftype          =     RHF 
  nclosed          =        7
  nopen            =        0
  variables        =      175
  # of vectors     =        3
  tolerance        = 0.10D-03
  level shift      = 0.00D+00
  max iterations   =       50
  max subspace     =       30

 SCF residual:   0.36977616114820894     
 ------------------------------------------------------------------------
 cphf_solve2:SCF residual greater than 1d-2        0
 ------------------------------------------------------------------------
 This error has not yet been assigned to a category
 ------------------------------------------------------------------------
 For more information see the NWChem manual at http://www.nwchem-sw.org/index.php/NWChem_Documentation


 For further details see manual section: No section for this category                                                                                                                                                                                                                                   
0:0:cphf_solve2:SCF residual greater than 1d-2:: 0
(rank:0 hostname:beryllium pid:1125):ARMCI DASSERT fail. ../../ga-5-1/armci/src/common/armci.c:ARMCI_Error():208 cond:0
</pre><br />
<br />
I presume that the residual will somehow corresponds to the HF exchange and that there's an additional modification which is needed somewhere.
</td>
		                    </tr>
		                                
		                    <tr>
	<td class="edited_on" align="left" colspan="2">
		<b><a href="../../post/edithistory/2451.html">Edited On</a></b> 3:34:00 PM PST - Sat, Nov 24th 2012 <b>by</b> Ohlincha
	</td>
</tr>
		                    
		                </table>
		            </td>
        </tr> 
           
        <tr><td class="thread_sig" align="left" colspan="2"></td></tr>
        	
        </table>
<br />       <a name="post_2467"></a>       
        <table class="forum_posts" cellpadding="0" cellspacing="0" id="fullheight">
            <tr>
                <td width="100%" align="left" colspan="2" valign="top" class="mem_name" id="name_2467" nowrap>
                    <table width="100%" cellpadding="0" cellspacing="0">
                        <tr>
                            <td class="UserNameOptions" width="100%">
                                <ul id="UserNameOptions">
                                  <li>
                                     <a href="../../mem_profile/Bert/12.html" onmouseover="mopen('mem14')" onmouseout="mclosetime()">Bert</a>  <font class="group_text">Forum:Admin, Forum:Mod, NWChemDeveloper, bureaucrat, sysop</font>
                                    <div id="mem14" onmouseover="mcancelclosetime()" onmouseout="mclosetime()">
                                        <a href="../../mem_profile/Bert/12.html"><b>Profile</b></a><br />
                                        
                                        Send <a href="../../member_options/pmnew/Bert/2467.html">PM</a>
                                    </div>
                                  </li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td align="left" nowrap valign="top" width="20">
                    <table cellpadding="0" cellspacing="0" width="20">
                        <tr>
                            <td class="t_userinfo" width="20" nowrap>
                <!-- member_title --><div class="">Forum Vet</div><!-- /member_title -->
                <DIV align="center"><img class="adv" src="../../../../extensions/awc/forums/images/avatars/avatar_default.gif" border="0" height="0" width="0" align="middle"/></div>
                                
                                Threads <a href="../../search/memtopics/Bert/12.html">4</a><br />
                                Posts <a href="../../search/memposts/Bert/12.html">597</a>                              
                            </td>
                        </tr>
                    </table>
                </td>
                        
            		<td align="left" width="100%" valign="top" id="fullheight">
		                <table width="100%" cellpadding="0" cellspacing="0" class="post1" height="75">
		                    <tr>
		                        <td class="post_date" valign="bottom" height="1px"  width="100%" colspan="2"  nowrap><a target="blank" href="../../sp/id2467.html">10:29:30 AM PST - Mon, Nov 26th 2012 </a></td>
		                            <td class="post_date" valign="bottom" height="1px" width="100%" nowrap></td>

		                    </tr>
		                                     
		                    <tr>
		                        <td valign="top" class="post_body" height="65" colspan="2">Searching for the error message you would have been able to find where this is happening. Try fixing it in cphf/cphf_solve2.F. Don't know if it will work as it should but worth a short. After that, I have to give up on finding quick solution.<br />
<br />
Bert<br />
<br />
<br />
<div class='quote_title'>Quote:Ohlincha <a target='blank' href="../../sp/id2451.html" title="Special:AWCforum/sp/id2451">Nov 22nd 4:58 am</a><div class='quote'>Bert,<br />
Thank you for putting all this effort into this.<br />
<br />
NWChem now compiles fine and without any other modification.<br />
<br />
Running a normal calculation works fine and gives the expected results.<br />
<br />
Running a calculation with<br />

<pre>
set dft:wah .true.
</pre><br />
<br />
however gives a fatak error<br />

<pre>
                               NWChem CPHF Module
                                ------------------


  scftype          =     RHF 
  nclosed          =        7
  nopen            =        0
  variables        =      175
  # of vectors     =        3
  tolerance        = 0.10D-03
  level shift      = 0.00D+00
  max iterations   =       50
  max subspace     =       30

 SCF residual:   0.36977616114820894     
 ------------------------------------------------------------------------
 cphf_solve2:SCF residual greater than 1d-2        0
 ------------------------------------------------------------------------
 This error has not yet been assigned to a category
 ------------------------------------------------------------------------
 For more information see the NWChem manual at http://www.nwchem-sw.org/index.php/NWChem_Documentation


 For further details see manual section: No section for this category                                                                                                                                                                                                                                   
0:0:cphf_solve2:SCF residual greater than 1d-2:: 0
(rank:0 hostname:beryllium pid:1125):ARMCI DASSERT fail. ../../ga-5-1/armci/src/common/armci.c:ARMCI_Error():208 cond:0
</pre><br />
<br />
I presume that the residual will somehow corresponds to the HF exchange and that there's an additional modification which is needed somewhere.</div id="quote"></div id="quote">
</td>
		                    </tr>
		                                
		                    
		                    
		                </table>
		            </td>
        </tr> 
           
        <tr><td class="thread_sig" align="left" colspan="2"></td></tr>
        	
        </table>
<br />       <a name="post_2477"></a>       
        <table class="forum_posts" cellpadding="0" cellspacing="0" id="fullheight">
            <tr>
                <td width="100%" align="left" colspan="2" valign="top" class="mem_name" id="name_2477" nowrap>
                    <table width="100%" cellpadding="0" cellspacing="0">
                        <tr>
                            <td class="UserNameOptions" width="100%">
                                <ul id="UserNameOptions">
                                  <li>
                                     <a href="../../mem_profile/Ohlincha/1364.html" onmouseover="mopen('mem15')" onmouseout="mclosetime()">Ohlincha</a>  <font class="group_text">Member</font>
                                    <div id="mem15" onmouseover="mcancelclosetime()" onmouseout="mclosetime()">
                                        <a href="../../mem_profile/Ohlincha/1364.html"><b>Profile</b></a><br />
                                        
                                        Send <a href="../../member_options/pmnew/Ohlincha/2477.html">PM</a>
                                    </div>
                                  </li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td align="left" nowrap valign="top" width="20">
                    <table cellpadding="0" cellspacing="0" width="20">
                        <tr>
                            <td class="t_userinfo" width="20" nowrap>
                <!-- member_title --><div class="">Gets Around</div><!-- /member_title -->
                <DIV align="center"><img class="adv" src="../../../../extensions/awc/forums/images/avatars/avatar_default.gif" border="0" height="0" width="0" align="middle"/></div>
                                
                                Threads <a href="../../search/memtopics/Ohlincha/1364.html">16</a><br />
                                Posts <a href="../../search/memposts/Ohlincha/1364.html">115</a>                              
                            </td>
                        </tr>
                    </table>
                </td>
                        
            		<td align="left" width="100%" valign="top" id="fullheight">
		                <table width="100%" cellpadding="0" cellspacing="0" class="post0" height="75">
		                    <tr>
		                        <td class="post_date" valign="bottom" height="1px"  width="100%" colspan="2"  nowrap><a target="blank" href="../../sp/id2477.html">8:48:12 PM PST - Mon, Nov 26th 2012 </a></td>
		                            <td class="post_date" valign="bottom" height="1px" width="100%" nowrap></td>

		                    </tr>
		                                     
		                    <tr>
		                        <td valign="top" class="post_body" height="65" colspan="2">Bert,<br />
I can get it to run by simply suppressing the error as shown below, but that didn't solve the issue. I guess it's time to sit down and figure out what's executed and in what order.<br />
<br />

<pre>
52d51
&lt;       logical do_wah
58,60d56
&lt; 
&lt; 
&lt; 
244,248d239
&lt;        
&lt; c     check for Wilson-Amos-Handy NMR computation request
&lt;       if (.not. rtdb_get(rtdb, 'dft:wah', mt_log, 1, do_wah)) 
&lt;      $  do_wah=.false.
&lt;       if (.not. (do_wah)) then
250,251c241,242
&lt;           call ga_sync()
&lt;           call errquit('cphf_solve2:SCF residual greater than 1d-2',
---
&gt;          call ga_sync()
&gt;          call errquit('cphf_solve2:SCF residual greater than 1d-2',
253,254c244
&lt;        endif
&lt;        endif
---
&gt;       endif
</pre><br />
Execution of the carbon monoxide job results in<br />

<pre>
 SCF residual:   0.36977288699976185     


Iterative solution of linear equations
  No. of variables      175
  No. of equations        3
  Maximum subspace       30
        Iterations       50
       Convergence  1.0D-04
        Start time      3.4


   iter   nsub   residual    time
   ----  ------  --------  ---------
     1      3    4.20D-02       4.1
     2      6    7.11D-04       4.8
     3      9    1.72D-05       5.5
</pre><br />
which gives for O<br />

<pre>

           isotropic =      -2.5674
          anisotropy =     412.8978

</pre><br />
and for C<br />

<pre>
           isotropic =     -63.0277
          anisotropy =     709.465
</pre>
</td>
		                    </tr>
		                                
		                    
		                    
		                </table>
		            </td>
        </tr> 
           
        <tr><td class="thread_sig" align="left" colspan="2"></td></tr>
        	
        </table>
<br /><br />
<table width="100%" cellpadding="0" cellspacing="0" class="bot_breadcrumbs_and_pagejump">
	<tr>
		<td width="100%" class="bot_breadcrumbs"><a href="../../index.html">Forum</a> &gt;&gt; <a href="../../sc/id2.html">NWChem's corner</a> &gt;&gt; <a href="../../sf/id6.html">NWChem functionality</a></td>
	</tr>
	<tr>
		<td width="100%" class="bot_pagejumps"></td>
	</tr>
</table>
<br /><br />      <br />
        	<table class="whos_here" width="100%" cellpadding="0" cellspacing="0">
        			<tr>
                  <td width="100%" class="whos_here_header">
                        <a href="../../whoshere.html">Who's here now</a> 
                        Members 0
                        Guests 1
                        Bots/Crawler 0
                   </td>
         				</tr>
        				<tr>
        					<td class="whos_here_row"></td>
        				</tr>
        </table><br /><hr>
            <center>
                <a href="http://wiki.anotherwebcom.com/" target="_blank" title="PHP, Visual Basic  scripts and programs">AWC's</a>:
                 <b>2.5.10</b> MediaWiki - Stand Alone Forum Extension<br />Forum theme style by: <a target='blank' href='wiki.anotherwebcom.html'>AWC</a></center><div class="printfooter">
Retrieved from "<a href="Wilson-Amos-Handy_method_for_cal....html">http:///index.php/Special:AWCforum/st/id642/Wilson-Amos-Handy_method_for_cal....html</a>"</div>
			<div id='catlinks' class='catlinks catlinks-allhidden'></div>			<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
	<!-- end of gumax-content-body -->


	<!-- ///// gumax-footer ///// -->
	<div id="gumax-footer">

			<!-- personal tools  -->
	<div id="gumax-personal-tools">
		<h5>Toolbox</h5>
		<ul>
<li id="t-specialpages"><a href="../../../Special_SpecialPages.html" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
		</ul>
	</div>
	<!-- end of personal tools  -->

		<div class="gumax-footer-spacer"></div>

			<!-- gumax-f-list -->
	<div id="gumax-f-list">
		<ul>
							<li id="privacy"><a href="../../../NWChem_Privacy_policy.html" title="NWChem:Privacy policy">Privacy policy</a></li>
							<li>/</li>							<li id="about"><a href="../../../NWChem_About.html" title="NWChem:About">About NWChem</a></li>
							<li>/</li>							<li id="disclaimer"><a href="../../../NWChem_General_disclaimer.html" title="NWChem:General disclaimer">Disclaimers</a></li>
							<li>/</li>						<li id="f-poweredby"><a href="http://mediawiki.org/" target="_blank">Powered by MediaWiki</a></li>
			<li>&#47;</li>
			<li id="f-designedby"><a href="http://paulgu.com/" target="_blank">Designed by Paul Gu</a></li>
		</ul>
	</div>
	<!-- end of gumax-f-list -->

	</div>
	<!-- ///// end of gumax-footer ///// -->


</div>
<!-- ===== end of gumax-page ===== -->

	</td><td id="gumax-page-table-right"><img src="../../../../skins/gumax/blank.gif" alt="" /></td></tr></table>
	<!--[if lt IE 7]>
		<script type="text/javascript">pngfix('td');</script>
	<![endif]-->

</div>
<!-- ##### end of gumax-wrapper ##### -->



<script>if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.964 secs. --></body>
<!-- Mirrored from /index.php/Special:AWCforum/st/id642/Wilson-Amos-Handy_method_for_cal....html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 04 Jun 2020 03:21:43 GMT -->
</html>





