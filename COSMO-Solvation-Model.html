<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://nwchemgit.github.io/COSMO-Solvation-Model.html">
  <link rel="shortcut icon" href="img/favicon.ico">
  <title>COSMO Solvation Model - NWChem</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="css/theme.css" />
  <link rel="stylesheet" href="css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "COSMO Solvation Model";
    var mkdocs_page_input_path = "COSMO-Solvation-Model.md";
    var mkdocs_page_url = "/COSMO-Solvation-Model.html";
  </script>
  
  <script src="js/jquery-2.1.1.min.js" defer></script>
  <script src="js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="." class="icon icon-home"> NWChem</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Home.html">Documentation</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Download.html">Download</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Quantum-Mechanical-Methods.html">Quantum Mechanical Methods</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Quantum-Molecular-Dynamics.html">Quantum Molecular Dynamics</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Other-Capabilities.html">Other Capabilities</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Examples.html">Examples</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Supplementary-Information.html">Supplementary Information</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Compiling-NWChem.html">Compiling NWChem from source</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Benchmarks.html">Benchmarks performed with NWChem</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Tutorials.html">Tutorials</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Forum.html">Forum</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Archived-Forum.html">Archived Forum</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href=".">NWChem</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".">Docs</a> &raquo;</li>
    
      
    
    <li>COSMO Solvation Model</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/nwchemgit/nwchem-wiki/blob/master/COSMO-Solvation-Model.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="cosmo-solvation-model">COSMO Solvation Model<a class="headerlink" href="#cosmo-solvation-model" title="Permanent link">&para;</a></h1>
<p>COSMO is the continuum solvation &lsquo;COnductor-like Screening MOdel&rsquo; of A.
Klamt and G. Schüürmann to describe dielectric screening effects in
solvents<script type="math/tex; mode=display">1</script>. This model has been enhanced by D.M. York and M.
Karplus<script type="math/tex; mode=display">2</script> to create a smooth potential energy surface. The latter
facilitates geometry optimization and dynamics and the implementation
has been adapted to take advantage of those ideas.</p>
<p>The NWChem COSMO module implements algorithm for calculation of the
energy for the following methods:</p>
<ol>
<li>Restricted Hartree-Fock (RHF),</li>
<li>Restricted open-shell Hartree-Fock (ROHF),</li>
<li>Restricted Kohn-Sham DFT (DFT),</li>
<li>Unrestricted Kohn-Sham DFT (ODFT),</li>
</ol>
<p>by determining the solvent reaction field self-consistently with the
solute charge distribution from the respective methods. Note that COSMO
for unrestricted Hartree-Fock (UHF) method can also be performed by
invoking the DFT module with appropriate keywords.</p>
<p>Correlation energy of solvent molecules may also be evaluated at</p>
<ol>
<li>MP2,</li>
<li>CCSD,</li>
<li>CCSD+T(CCSD),</li>
<li>CCSD(T),</li>
</ol>
<p>levels of theory. It is cautioned, however, that these correlated COSMO
calculations determine the solvent reaction field using the HF charge
distribution of the solute rather than the charge distribution of the
correlation theory and are not entirely self consistent in that respect.
In other words, these calculations assume that the correlation effect
and solvation effect are largely additive, and the combination effect
thereof is neglected. COSMO for MCSCF has not been implemented yet.</p>
<p>In the current implementation the code calculates the gas-phase energy
of the system followed by the solution-phase energy, and returns the
electrostatic contribution to the solvation free energy. At the present
gradients are calculated analytically, but frequencies are calculated by
finite difference of the gradients. Known problems include that the code
does not work with spherical basis functions. The non-electrostatic
contributions can be calculated by turning on the SMD model. It should
be noted that one must in general take into account the standard state
correction besides the electrostatic and cavitation/dispersion
contribution to the solvation free energy, when a comparison to
experimental data is made.</p>
<p>Invoking the COSMO solvation model is done by specifying the input COSMO
input block with the input options as:</p>
<pre><code>cosmo  
  [off]  
  [dielec  &lt;real dielec default 78.4&gt;]  
  [parameters &lt;filename&gt;]  
  [radius  &lt;real atom1&gt;  
           &lt;real atom2&gt;  
      . . .  
           &lt;real atomN&gt;]  
  [iscren  &lt;integer iscren default 0&gt;]  
  [minbem  &lt;integer minbem default 2&gt;]  
  [ificos  &lt;integer ificos default 0&gt;]  
  [lineq   &lt;integer lineq default 1&gt;]  
  [zeta &lt;real zeta default 0.98&gt;]  
  [gamma_s &lt;real gammas default 1.0&gt;]  
  [sw_tol &lt;real swtol default 1.0e-4&gt;]  
  [do_gasphase  &lt;logical do_gasphase default True&gt;] 
  [do_cosmo_ks]  
end
</code></pre>

<p>followed by the task directive specifying the wavefunction and type of
calculation, e.g., &ldquo;task scf energy&rdquo;, &ldquo;task mp2 energy&rdquo;, &ldquo;task dft
optimize&rdquo;, etc.</p>
<p>&ldquo;off&rsquo; can be used to turn off COSMO in a compound (multiple task) run.
By default, once the COSMO solvation model has been defined it will be
used in subsequent calculations. Add the keyword &ldquo;off&rdquo; if COSMO is not
needed in subsequent calculations.</p>
<p>&ldquo;Dielec&rdquo; is the value of the dielectric constant of the medium, with a
default value of 78.4 (the dielectric constant for water).</p>
<p>&ldquo;parameters&rdquo; specifies COSMO radii parameters file that stores custom
setting for COSMO parameters. The format for such file consists of the
atom or element name followed by the radii. The program will first
attempt to match based on atom name and only then the element name.
Otherwise radius will be set based on default parameters. The file has
to present in one of the three location ( in the order of preference) -
directory specified by the environmental variable
NWCHEM_COSMO_LIBRARY, permanent directory, and run directory. This
directive is replacing previous facility of loading COSMO radii
parameters through &ldquo;set cosmo:map cosmo.par&rdquo; directive. See example at
the end of this section.</p>
<p>&ldquo;Radius&rdquo; is an array that specifies the radius of the spheres associated
with each atom and that make up the molecule-shaped cavity. These values
will override default radii setting including those specified in the
COSMO parameter file (if any) Default values are Van der Waals radii.
Values are in units of angstroms. The codes uses the following Van der
Waals radii by default:</p>
<p>Default radii provided by Andreas Klamt (Cosmologic)</p>
<p>vdw radii: 1.17 (+/- 0.02) * Bondi radius<script type="math/tex; mode=display">3</script>
</p>
<p>optimal vdw radii for H, C, N, O, F, S, Cl, Br, I<script type="math/tex; mode=display">4</script>
</p>
<p>for heavy elements: 1.17*1.9</p>
<pre><code>     data (vander(i),i=1,102)  
    1 / 1.300,1.638,1.404,1.053,2.0475,2.00,  
    2   1.830,1.720,1.720,1.8018,1.755,1.638,  
    3   1.404,2.457,2.106,2.160,2.05,2.223,  
    4   2.223,2.223,2.223,2.223,2.223,2.223,  
    5   2.223,2.223,2.223,2.223,2.223,2.223,  
    6   2.223,2.223,2.223,2.223,2.160,2.223,  
    7   2.223,2.223,2.223,2.223,2.223,2.223,  
    8   2.223,2.223,2.223,2.223,2.223,2.223,  
    9   2.223,2.223,2.223,2.223,2.320,2.223,  
    1   2.223,2.223,2.223,2.223,2.223,2.223,  
    2   2.223,2.223,2.223,2.223,2.223,2.223,  
    3   2.223,2.223,2.223,2.223,2.223,2.223,  
    4   2.223,2.223,2.223,2.223,2.223,2.223,  
    5   2.223,2.223,2.223,2.223,2.223,2.223,  
    6   2.223,2.223,2.223,2.223,2.223,2.223,  
    7   2.223,2.223,2.223,2.223,2.223,2.223,  
    7   2.223,2.223,2.223,2.223,2.223,2.223/
</code></pre>

<p>For examples see Stefanovich et al.<script type="math/tex; mode=display">5</script> and Barone et al.<script type="math/tex; mode=display">6</script>
</p>
<p>&ldquo;Rsolv&rdquo; is no longer used.</p>
<p>&ldquo;Iscren&rdquo; is a flag to define the dielectric charge scaling option.
&ldquo;iscren 1&rdquo; implies the original scaling from Klamt and Schüürmann,
mainly &ldquo;(&epsilon;-1)/(&epsilon;+1/2)&rdquo;, where &epsilon; is the
dielectric constant. &ldquo;iscren 0&rdquo; implies the modified scaling suggested
by Stefanovich and Truong<script type="math/tex; mode=display">7</script>, mainly &ldquo;(&epsilon;-1)/&epsilon;&ldquo;.
Default is to use the modified scaling. For high dielectric the
difference between the scaling is not significant.</p>
<p>The next two parameters define the tesselation of the unit sphere. The
approach still follows the original proposal by Klamt and Schüürmann to
some degree. Basically a tesselation is generated from &ldquo;minbem&rdquo; refining
passes starting from either an octahedron or an icosahedron. Each level
of refinement partitions the triangles of the current tesselation into
four triangles. This procedure is repeated recursively until the desired
granularity of the tesselation is reached. The induced point charges
from the polarization of the medium are assigned to the centers of the
tesselation. The default value is &ldquo;minbem 2&rdquo;. The flag +ificos+ serves
to select the original tesselation, &ldquo;ificos 0&rdquo; for an octahedron
(default) and &ldquo;ificos 1&rdquo; for an icoshedron. Starting from an icosahedron
yields a somewhat finer tesselation that converges somewhat faster.
Solvation energies are not really sensitive to this choice for
sufficiently fine tesselations. The old &ldquo;maxbem&rdquo; directive is no longer
used.</p>
<p>The &ldquo;lineq&rdquo; parameter serves to select the numerical algorithm to solve
the linear equations yielding the effective charges that represent the
polarization of the medium. &ldquo;lineq 0&rdquo; selects an iterative method
(default), &ldquo;lineq 1&rdquo; selects a dense matrix linear equation solver. For
large molecules where the number of effective charges is large, the
codes selects the iterative method.</p>
<p>&ldquo;zeta&rdquo; sets the width of the Gaussian charge distributions that were
suggested by York and Karplus to avoid singularities when two surface
charges coincide. The default value is &ldquo;zeta 0.98&rdquo; this value was chosen
to ensure that the results of the current implementation are as close as
possible to those of the original Klamt and Schuurmann based
implementation.</p>
<p>&ldquo;gamma_s&rdquo; modifies the width of the smooth switching function that
eliminates surface charges when their positions move into the sphere of
a neighboring atom. &ldquo;gamma_s 0.0&rdquo; leads to a heavyside or abrupt
switching function, whereas &ldquo;gamma_s 1.0&rdquo; maximizes the width of the
switching function. The default value is &ldquo;gamma_s 1.0&rdquo;.</p>
<p>&ldquo;sw_tol&rdquo; specifies the cutoff of the switching function below which a
surface charge at a particular point is eliminated. The values of the
switching function lie in the domain from 0 to 1. This value should not
be set too small as that leads to instabilities in the linear system
solvers. The default value is &ldquo;sw_tol 1.0e-4&rdquo;.</p>
<p>&ldquo;do_gasphase&rdquo; is a flag to control whether the calculation of the
solvation energy is preceded by a gas phase calculation. The default is
to always perform a gas phase calculation first and then calculate the
solvation starting from the converged gas phase electron density.
However, in geometry optimizations this approach can double the cost. In
such a case setting &ldquo;do_gasphase false&rdquo; suppresses the gas phase
calculations and only the solvated system calculations are performed.
This option needs to be used with care as in some cases starting the
COSMO solvation from an unconverged electron density can generate
unphysical charges that lock the calculation into strange electron
distributions.</p>
<p>&ldquo;do_cosmo_ks&rdquo; is a flag to turn on the Klamt-Schuurmann model</p>
<p>&ldquo;do_cosmo_yk&rdquo; is a flag to turn on the York-Karplus model (default)</p>
<p>The following example is for a water molecule in `water&rsquo;, using the
HF/6-31G** level of
theory:</p>
<pre><code>start  
echo  
 title &quot;h2o&quot;  
geometry  
 o                  .0000000000         .0000000000        -.0486020332  
 h                  .7545655371         .0000000000         .5243010666  
 h                 -.7545655371         .0000000000         .5243010666  
end  
basis segment cartesian  
 o library 6-31g**  
 h library 6-31g**  
end  
cosmo  
 dielec 78.0  
 radius 1.40  
        1.16  
        1.16  
 lineq  0  
end  
task scf energy
</code></pre>

<p>Alternatively, instead of listing COSMO radii parameters in the input,
the former can be loaded using an external file through the &ldquo;parameters&rdquo;
directive</p>
<pre><code>start  
echo  
 title &quot;h2o&quot;  
geometry  
 ow                  .0000000000         .0000000000        -.0486020332  
 hw                  .7545655371         .0000000000         .5243010666  
 h                  -.7545655371         .0000000000         .5243010666  
end  
basis segment cartesian  
 * library 6-31g**  
end

cosmo  
 dielec 78.0  
 lineq  0  
 parameters water.par  
end

task scf energy
</code></pre>

<p>where &ldquo;water.par&rdquo; may the following form:</p>
<pre><code>O 1.40
H 1.16
</code></pre>

<p>This will set radii of all oxygen atoms to 1.4 and all hydrogen atoms to
1.16. More fine grained control may be achieved using specific atom
names. For example, the following parameter file</p>
<pre><code>O    1.40
H    1.16
HW  1.06
</code></pre>

<p>will set a different radii of 1.06 to hydrogen atoms named HW. Note
that, as per general rule in NWChem, all names are case insensitive.</p>
<p>and placed in one of the these locations - directory specified by the
environmental variable NWCHEM_COSMO_LIBRARY, permanent directory, or
run directory.</p>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<p><references/></p>
<ol>
<li>Klamt, A; Schuurmann, G (1993). &ldquo;COSMO: A new approach to dielectric screening in solvents with explicit expressions for the screening energy and its gradient&rdquo;. Journal of the Chemical Society, Perkin Transactions 2: 799-805. doi:10.1039/P29930000799. </li>
<li>York, D.M.; Karplus, M. (1999). &ldquo;A smooth solvation potential based on the conductor-like screening model&rdquo;. Journal of physical chemistry A 103: 11060-11079. doi:10.1021/jp992097l. </li>
<li>A. Bondi (1964). &ldquo;van der Waals volums and radii&rdquo;. Journal of Physical Chemistry 68: 441-451. doi:10.1021/j100785a001. </li>
<li>A. Klamt, V. Jonas (1998). &ldquo;Refinement and parametrization of COSMO-RS&rdquo;. Journal of physical chemistry A 102: 5074-5085. doi:10.1021/jp980017s. </li>
<li>E. V. Stefanovich, T. N. Truong (1995). &ldquo;Optimized atomic radii for quantum dielectric continuum solvation models&rdquo;. Chemical Physics Letters 244: 65-74. doi:10.1016/0009-2614(95)00898-E. </li>
<li>V. Barone, M. Cossi (1997). &ldquo;A new definition of cavities for the computation of solvation free energies by the polarizable continuum model&rdquo;. Journal of Chemical Physics 107: 3210-3221. doi:10.1063/1.474671. </li>
<li>E. V. Stefanovich, T. N. Truong (1995). &ldquo;Optimized atomic radii for quantum dielectric continuum solvation models&rdquo;. Chemical Physics Letters 244: 65-74. doi:10.1016/0009-2614(95)00898-E. </li>
</ol>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/nwchemgit/nwchem-wiki/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
      
    </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme.js" defer></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
