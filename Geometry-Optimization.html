
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="NWChem Website">
      
      
      
        <link rel="canonical" href="https://nwchemgit.github.io/Geometry-Optimization.html">
      
      
        <link rel="prev" href="1D-RISM.html">
      
      
        <link rel="next" href="Hessians-and-Vibrational-Frequencies.html">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.25">
    
    
      
        <title>Geometry Optimization - NWChem</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#geometry-optimization" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="NWChem" class="md-header__button md-logo" aria-label="NWChem" data-md-component="logo">
      
  <img src="assets/MS3logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NWChem
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Geometry Optimization
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/nwchemgit/nwchem-wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="NWChem" class="md-nav__button md-logo" aria-label="NWChem" data-md-component="logo">
      
  <img src="assets/MS3logo.png" alt="logo">

    </a>
    NWChem
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nwchemgit/nwchem-wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NWChem Homepage
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Home.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NWChem Manual
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    How to get NWChem
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            How to get NWChem
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Download.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to download and install NWChem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Compiling-NWChem.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compiling NWChem from source
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction 
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Introduction 
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Getting-Started.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="NWChem-Architecture.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NWChem Architecture
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Capabilities.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functionalities
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Top-level.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Top-level Directives
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Geometry.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometries
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Basis.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basis sets
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="ECP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Effective Core Potentials
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Relativistic-All-electron-Approximations.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Relativistic all-electron approximations
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Quantum-Mechanical-Methods
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Quantum-Mechanical-Methods
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Hartree-Fock-Theory-for-Molecules.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hartree-Fock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Density-Functional-Theory-for-Molecules.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Density Functional Theory (DFT)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Excited-State-Calculations.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CIS, TDHF, TDDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="RT-TDDFT.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Real-time TDDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Plane-Wave-Density-Functional-Theory.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plane-Wave Density Functional Theory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="TCE.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tensor Contraction Engine Module: CI, MBPT, and CC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="MP2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MP2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CCSD.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coupled Cluster Calculations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Multiconfiguration_SCF.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MCSCF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="GW.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Molecular GW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="XTB.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XTB
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Quantum Molecular Dynamics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Quantum Molecular Dynamics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Plane-Wave-Density-Functional-Theory.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plane-Wave Density Functional Theory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Gaussian-Basis-AIMD.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gaussian Basis AIMD
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Hybrid Approaches
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Hybrid Approaches
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Solvation-Models.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solvation Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="VEM-Model.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VEM (Vertical Excitation or Emission) Model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ONIOM.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hybrid Calculations with ONIOM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_4" >
        
          
          <label class="md-nav__link" for="__nav_13_4" id="__nav_13_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    QMMM
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_13_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13_4">
            <span class="md-nav__icon md-icon"></span>
            QMMM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="qmmm_introduction.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QMMM Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="QMMM.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QMMM table of contents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_4_3" >
        
          
          <label class="md-nav__link" for="__nav_13_4_3" id="__nav_13_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    QMMM Restart and Topology Files
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_13_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13_4_3">
            <span class="md-nav__icon md-icon"></span>
            QMMM Restart and Topology Files
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Restart_and_Topology_Files.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Preparation_Prerequisites.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QMMM Preparation Prerequisites
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_preparation_basic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Qmmm preparation basic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_preparation_solvation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Qmmm preparation solvation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_preparation_constraints.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Qmmm preparation constraints
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_4_4" >
        
          
          <label class="md-nav__link" for="__nav_13_4_4" id="__nav_13_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    QMMM Input File
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_13_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13_4_4">
            <span class="md-nav__icon md-icon"></span>
            QMMM Input File
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Input_File.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_QM_Parameters.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QM_Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_MM_Parameters.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QMMM MM Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_QMMM_Parameters.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QM/MM parameters
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_4_5" >
        
          
          <label class="md-nav__link" for="__nav_13_4_5" id="__nav_13_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    QMMMM Single Point Calculations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_13_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13_4_5">
            <span class="md-nav__icon md-icon"></span>
            QMMMM Single Point Calculations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="qmmm_sp_energy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QMMM Ground State Energy and Gradient
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Excited_States.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QMMM Excited State Energy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="qmmm_sp_property.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QMMM Properties
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_ESP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QMMM ESP Charge Analysis
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_4_6" >
        
          
          <label class="md-nav__link" for="__nav_13_4_6" id="__nav_13_4_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    QMMM Potential Energy Surface Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_13_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13_4_6">
            <span class="md-nav__icon md-icon"></span>
            QMMM Potential Energy Surface Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_optimization.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QMMM Optimization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Transition_States.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QMMM Transition States
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_freq.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QMMM Hessians and Frequency
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_NEB_Calculations.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QMMM Reaction Pathway Calculations with NEB
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Dynamics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QMMM Dynamics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Free_Energy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QMMM Free Energy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Appendix.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QMMM Apppendix
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Bq.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Point charges
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="1D-RISM.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1-D RISM
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" checked>
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Potential Energy Surface Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            Potential Energy Surface Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Geometry Optimization
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="Geometry-Optimization.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Geometry Optimization
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#geometry-optimization-with-driver" class="md-nav__link">
    <span class="md-ellipsis">
      Geometry Optimization with DRIVER
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Geometry Optimization with DRIVER">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#convergence-criteria" class="md-nav__link">
    <span class="md-ellipsis">
      Convergence criteria
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#available-precision" class="md-nav__link">
    <span class="md-ellipsis">
      Available precision
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controlling-the-step-length" class="md-nav__link">
    <span class="md-ellipsis">
      Controlling the step length
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maximum-number-of-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Maximum number of steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#discard-restart-information" class="md-nav__link">
    <span class="md-ellipsis">
      Discard restart information
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regenerate-internal-coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      Regenerate internal coordinates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initial-hessian" class="md-nav__link">
    <span class="md-ellipsis">
      Initial Hessian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mode-or-variable-to-follow-to-saddle-point" class="md-nav__link">
    <span class="md-ellipsis">
      Mode or variable to follow to saddle point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimization-history-as-xyz-files" class="md-nav__link">
    <span class="md-ellipsis">
      Optimization history as XYZ files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#i-pi-socket-communication" class="md-nav__link">
    <span class="md-ellipsis">
      i-PI Socket communication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#print-options" class="md-nav__link">
    <span class="md-ellipsis">
      Print options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geometry-optimization-with-stepper" class="md-nav__link">
    <span class="md-ellipsis">
      Geometry Optimization with STEPPER
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Geometry Optimization with STEPPER">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#min-and-ts-minimum-or-transition-state-search" class="md-nav__link">
    <span class="md-ellipsis">
      MIN and TS: Minimum or transition state search
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#track-mode-selection" class="md-nav__link">
    <span class="md-ellipsis">
      TRACK: Mode selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maxiter-maximum-number-of-steps" class="md-nav__link">
    <span class="md-ellipsis">
      MAXITER: Maximum number of steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trust-trust-radius" class="md-nav__link">
    <span class="md-ellipsis">
      TRUST: Trust radius
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convggm-convgg-and-convge-convergence-criteria" class="md-nav__link">
    <span class="md-ellipsis">
      CONVGGM, CONVGG and CONVGE: Convergence criteria
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backstepping-in-stepper" class="md-nav__link">
    <span class="md-ellipsis">
      Backstepping in STEPPER
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initial-nuclear-hessian-options" class="md-nav__link">
    <span class="md-ellipsis">
      Initial Nuclear Hessian Options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Hessians-and-Vibrational-Frequencies.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hessians
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Constraints.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constraints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Nudged-Elastic-Band-and-Zero-Temperature-String-Methods.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nudged Elastic Band (NEB) method
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
        
          
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Electronic Structure Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            Electronic Structure Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Properties.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Properties
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ESP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Electrostatic potentials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DPLOT.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DPLOT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="FCIDUMP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FCIDUMP
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
        
          
          <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Other-Capabilities
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_16">
            <span class="md-nav__icon md-icon"></span>
            Other-Capabilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Electron-Transfer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Electron Transfer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Python.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Controlling NWChem with Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Quantum.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quantum
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="VSCF.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vibrational SCF (VSCF)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CCCA_method.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Correlation consistent Composite Approach (ccCA)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Interface.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interfaces to Other Programs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_17" >
        
          
          <label class="md-nav__link" for="__nav_17" id="__nav_17_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Molecular Mechanics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_17">
            <span class="md-nav__icon md-icon"></span>
            Molecular Mechanics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Prepare.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prepare
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="MD.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Molecular dynamics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Analysis.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Format_of_MD_Files.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Format of MD files
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Python.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Controlling NWChem with Python
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_19" >
        
          
          <label class="md-nav__link" for="__nav_19" id="__nav_19_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    NWChem Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_19_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_19">
            <span class="md-nav__icon md-icon"></span>
            NWChem Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Sample.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sample input files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Geometry-examples.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples of geometries using symmetry
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Benchmarks.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Benchmarks performed with NWChem
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Known-Bugs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Known Bugs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="FAQ.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Tutorials.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NWChem Tutorials
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Forum.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forum
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Archived-Forum.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Archived Forum
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="EMSL_Arrows.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EMSL Arrows
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_27" >
        
          
          <label class="md-nav__link" for="__nav_27" id="__nav_27_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Supplementary Information
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_27_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_27">
            <span class="md-nav__icon md-icon"></span>
            Supplementary Information
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://hpc.pnl.gov/globalarrays/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Global Arrays
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ARMCI.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Choosing the ARMCI Library
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Interfaces-with-External-Software.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interfaces with External Software
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Software-supporting-NWChem.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software supporting NWChem
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Containers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Containers
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://nwchemgit.github.io/nwchemusermanual.pdf" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documentation in PDF format
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#geometry-optimization-with-driver" class="md-nav__link">
    <span class="md-ellipsis">
      Geometry Optimization with DRIVER
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Geometry Optimization with DRIVER">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#convergence-criteria" class="md-nav__link">
    <span class="md-ellipsis">
      Convergence criteria
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#available-precision" class="md-nav__link">
    <span class="md-ellipsis">
      Available precision
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controlling-the-step-length" class="md-nav__link">
    <span class="md-ellipsis">
      Controlling the step length
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maximum-number-of-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Maximum number of steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#discard-restart-information" class="md-nav__link">
    <span class="md-ellipsis">
      Discard restart information
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regenerate-internal-coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      Regenerate internal coordinates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initial-hessian" class="md-nav__link">
    <span class="md-ellipsis">
      Initial Hessian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mode-or-variable-to-follow-to-saddle-point" class="md-nav__link">
    <span class="md-ellipsis">
      Mode or variable to follow to saddle point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimization-history-as-xyz-files" class="md-nav__link">
    <span class="md-ellipsis">
      Optimization history as XYZ files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#i-pi-socket-communication" class="md-nav__link">
    <span class="md-ellipsis">
      i-PI Socket communication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#print-options" class="md-nav__link">
    <span class="md-ellipsis">
      Print options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geometry-optimization-with-stepper" class="md-nav__link">
    <span class="md-ellipsis">
      Geometry Optimization with STEPPER
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Geometry Optimization with STEPPER">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#min-and-ts-minimum-or-transition-state-search" class="md-nav__link">
    <span class="md-ellipsis">
      MIN and TS: Minimum or transition state search
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#track-mode-selection" class="md-nav__link">
    <span class="md-ellipsis">
      TRACK: Mode selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maxiter-maximum-number-of-steps" class="md-nav__link">
    <span class="md-ellipsis">
      MAXITER: Maximum number of steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trust-trust-radius" class="md-nav__link">
    <span class="md-ellipsis">
      TRUST: Trust radius
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convggm-convgg-and-convge-convergence-criteria" class="md-nav__link">
    <span class="md-ellipsis">
      CONVGGM, CONVGG and CONVGE: Convergence criteria
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backstepping-in-stepper" class="md-nav__link">
    <span class="md-ellipsis">
      Backstepping in STEPPER
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initial-nuclear-hessian-options" class="md-nav__link">
    <span class="md-ellipsis">
      Initial Nuclear Hessian Options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/nwchemgit/nwchem-wiki/edit/master/Geometry-Optimization.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/nwchemgit/nwchem-wiki/raw/master/Geometry-Optimization.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5Z"/></svg>
    </a>
  


<h1 id="geometry-optimization">Geometry Optimization<a class="headerlink" href="#geometry-optimization" title="Permanent link">&para;</a></h1>
<h2 id="geometry-optimization-with-driver">Geometry Optimization with DRIVER<a class="headerlink" href="#geometry-optimization-with-driver" title="Permanent link">&para;</a></h2>
<p>The DRIVER module is one of two drivers (also see documentation on
<a href="#geometry-optimization-with-stepper">STEPPER</a>)
to perform a geometry optimization function on the molecule defined by
input using the <a href="Geometry.html">GEOMETRY</a> directive.
Geometry optimization is either an energy minimization or a transition
state optimization. The algorithm programmed in DRIVER is a quasi-newton
optimization with line searches and approximate energy Hessian updates.</p>
<p>DRIVER is selected by default out of the two available modules to
perform geometry optimization. In order to force use of DRIVER (e.g.,
because a previous optimization used STEPPER) provide a DRIVER input
block (below) &ndash; even an empty block will force use of DRIVER.</p>
<p>Optional input for this module is specified within the compound
directive,</p>
<pre><code> DRIVER   
   (LOOSE || DEFAULT || TIGHT)  
   GMAX &lt;real value&gt;  
   GRMS &lt;real value&gt;  
   XMAX &lt;real value&gt;  
   XRMS &lt;real value&gt;  
   EPREC &lt;real eprec default 1e-7&gt;  
   TRUST &lt;real trust default 0.3&gt;  
   SADSTP &lt;real sadstp default 0.1&gt;  
   CLEAR  
   REDOAUTOZ  
   INHESS &lt;integer inhess default 0&gt;  
   (MODDIR || VARDIR) &lt;integer dir default 0&gt; 
   (FIRSTNEG || NOFIRSTNEG)  
   MAXITER &lt;integer maxiter default 20&gt;  
   BSCALE &lt;real BSCALE default 1.0&gt;` 
   ASCALE &lt;real ASCALE default 0.25&gt;  
   TSCALE &lt;real TSCALE default 0.1&gt; 
   HSCALE &lt;real HSCALE default 1.0&gt; 
      PRINT ... 
   XYZ &lt;string xyz default *file_prefix*&gt;]  
   NOXYZ  
   SOCKET (UNIX || IPI_CLIENT) &lt;string socketname default (see input description)&gt;  
 END
</code></pre>
<p>On each optimization step a line search is performed. To speed up
calculations (up to two times), it may be beneficial to turn off the
line search using following directive:</p>
<pre><code> set driver:linopt 0
</code></pre>
<h3 id="convergence-criteria">Convergence criteria<a class="headerlink" href="#convergence-criteria" title="Permanent link">&para;</a></h3>
<pre><code>   (LOOSE || DEFAULT || TIGHT)  
   GMAX &lt;real value&gt;  
   GRMS &lt;real value&gt;  
   XMAX &lt;real value&gt;  
   XRMS &lt;real value&gt;
</code></pre>
<p>The defaults may be used, or the directives LOOSE, DEFAULT, or TIGHT
specified to use standard sets of values, or the individual criteria
adjusted. All criteria are in atomic units. GMAX and GRMS control the
maximum and root mean square gradient in the coordinates being used
(Z-matrix, redundant internals, or Cartesian). XMAX and XRMS control the
maximum and root mean square of the Cartesian step.</p>
<table>
<thead>
<tr>
<th></th>
<th>LOOSE</th>
<th>DEFAULT</th>
<th>TIGHT</th>
</tr>
</thead>
<tbody>
<tr>
<td>GMAX</td>
<td>0.00450</td>
<td>0.00045</td>
<td>0.000015</td>
</tr>
<tr>
<td>GRMS</td>
<td>0.00300</td>
<td>0.00030</td>
<td>0.00001</td>
</tr>
<tr>
<td>XMAX</td>
<td>0.01800</td>
<td>0.00180</td>
<td>0.00006</td>
</tr>
<tr>
<td>XRMS</td>
<td>0.01200</td>
<td>0.00120</td>
<td>0.00004</td>
</tr>
</tbody>
</table>
<p>Note that GMAX and GRMS used for convergence of geometry may
significantly vary in different coordinate systems such as Z-matrix,
redundant internals, or Cartesian. The coordinate system is defined in
the input file (default is Z-matrix). Therefore the choice of coordinate
system may slightly affect converged energy. Although in most cases XMAX
and XRMS are last to converge which are always done in Cartesian
coordinates, which insures convergence to the same geometry in different
coordinate systems.</p>
<p>The old criterion may be recovered with the input</p>
<pre><code>  gmax 0.0008; grms 1; xrms 1; xmax 1
</code></pre>
<h3 id="available-precision">Available precision<a class="headerlink" href="#available-precision" title="Permanent link">&para;</a></h3>
<pre><code>   EPREC &lt;real eprec default 1e-7&gt;
</code></pre>
<p>In performing a line search the optimizer must know the precision of the
energy (this has nothing to do with convergence criteria). The default
value of 1e-7 should be adjusted if less, or more, precision is
available. Note that the default EPREC for DFT calculations is 5e-6
instead of 1e-7.</p>
<h3 id="controlling-the-step-length">Controlling the step length<a class="headerlink" href="#controlling-the-step-length" title="Permanent link">&para;</a></h3>
<pre><code>   TRUST &lt;real trust default 0.3&gt;
   SADSTP &lt;real sadstp default 0.1&gt;
</code></pre>
<p>A fixed trust radius (trust) is used to control the step during
minimizations, and is also used for modes being minimized during
saddle-point searches. It defaults to 0.3 for minimizations and 0.1 for
saddle-point searches. The parameter sadstp is the trust radius used for
the mode being maximized during a saddle-point search and defaults to
0.1.</p>
<h3 id="maximum-number-of-steps">Maximum number of steps<a class="headerlink" href="#maximum-number-of-steps" title="Permanent link">&para;</a></h3>
<pre><code>   MAXITER &lt;integer maxiter default 20&gt;
</code></pre>
<p>By default at most 20 geometry optimization steps will be taken, but
this may be modified with this directive.</p>
<h3 id="discard-restart-information">Discard restart information<a class="headerlink" href="#discard-restart-information" title="Permanent link">&para;</a></h3>
<pre><code>   CLEAR
</code></pre>
<p>By default Driver reuses Hessian information from a previous
optimization, and, to facilitate a restart also stores which mode is
being followed for a saddle-point search. This option deletes all
restart data.</p>
<h3 id="regenerate-internal-coordinates">Regenerate internal coordinates<a class="headerlink" href="#regenerate-internal-coordinates" title="Permanent link">&para;</a></h3>
<pre><code>   REDOAUTOZ
</code></pre>
<p>Deletes Hessian data and regenerates internal coordinates at the current
geometry. Useful if there has been a large change in the geometry that
has rendered the current set of coordinates invalid or non-optimal.</p>
<h3 id="initial-hessian">Initial Hessian<a class="headerlink" href="#initial-hessian" title="Permanent link">&para;</a></h3>
<pre><code>   INHESS &lt;integer inhess default 0&gt;
</code></pre>
<ul>
<li>0 = Default &hellip; use restart data if available, otherwise use
    diagonal guess.</li>
<li>1 = Use diagonal initial guess.</li>
<li>2 = Use restart data if available, otherwise transform Cartesian
    Hessian from previous frequency calculation.</li>
</ul>
<p>In addition, the diagonal elements of the initial Hessian for internal
coordinates may be scaled using separate factors for bonds, angles and
torsions with the following</p>
<pre><code>   BSCALE &lt;real bscale default 1.0&gt;  
   ASCALE &lt;real ascale default 0.25&gt;  
   TSCALE &lt;real tscale default 0.1&gt;
</code></pre>
<p>These values typically give a two-fold speedup over unit values, based
on about 100 test cases up to 15 atoms using 3-21g and 6-31g* SCF.
However, if doing many optimizations on physically similar systems it
may be worth fine tuning these parameters.</p>
<p>Finally, the entire Hessian from any source may be scaled by a factor
using the directive</p>
<pre><code>   HSCALE &lt;real hscale default 1.0&gt;
</code></pre>
<p>It might be of utility, for instance, when computing an initial Hessian
using SCF to start a large MP2 optimization. The SCF vibrational modes
are expected to be stiffer than the MP2, so scaling the initial Hessian
by a number less than one might be beneficial.</p>
<h3 id="mode-or-variable-to-follow-to-saddle-point">Mode or variable to follow to saddle point<a class="headerlink" href="#mode-or-variable-to-follow-to-saddle-point" title="Permanent link">&para;</a></h3>
<pre><code>   (MODDIR || VARDIR) &lt;integer dir default 0&gt;  
   (FIRSTNEG || NOFIRSTNEG)
</code></pre>
<p>When searching for a transition state the program, by default, will take
an initial step uphill and then do mode following using a fuzzy maximum
overlap (the lowest eigen-mode with an overlap with the previous search
direction of 0.7 times the maximum overlap is selected). Once a negative
eigen-value is found, that mode is followed regardless of overlap.</p>
<p>The initial uphill step is appropriate if the gradient points roughly in
the direction of the saddle point, such as might be the case if a
constrained optimization was performed at the starting geometry.
Alternatively, the initial search direction may be chosen to be along a
specific internal variable (using the directive <code>VARDIR</code>) or along a
specific eigen-mode (using <code>MODDIR</code>). Following a variable might be
valuable if the initial gradient is either very small or very large.
Note that the eigen-modes in the optimizer have next-to-nothing to do
with the output from a frequency calculation. You can examine the
eigen-modes used by the optimizer with</p>
<pre><code>  driver; print hvecs; end
</code></pre>
<p>The selection of the first negative mode is usually a good choice if the
search is started in the vicinity of the transition state and the
initial search direction is satisfactory. However, sometimes the first
negative mode might not be the one of interest (e.g., transverse to the
reaction direction). If <code>NOFIRSTNEG</code> is specified, the code will not take
the first negative direction and will continue doing mode-following
until that mode goes negative.</p>
<h3 id="optimization-history-as-xyz-files">Optimization history as XYZ files<a class="headerlink" href="#optimization-history-as-xyz-files" title="Permanent link">&para;</a></h3>
<pre><code>   XYZ [&lt;string xyz default $fileprefix&gt;] 
   NOXYZ
</code></pre>
<p>The XYZ directive causes the geometry at each step (but not intermediate
points of a line search) to be output into separate files in the
permanent directory in XYZ format. The optional string will prefix the
filename. The NOXYZ directive turns this off.</p>
<p>For example, the input</p>
<pre><code>   driver; xyz test; end
</code></pre>
<p>will cause files test-000.xyz, test-001.xyz, &hellip; to be created in the
permanent directory.</p>
<p>The script rasmolmovie in the NWChem contrib directory can be used to
turn these into an animated GIF movie.</p>
<h3 id="i-pi-socket-communication">i-PI Socket communication<a class="headerlink" href="#i-pi-socket-communication" title="Permanent link">&para;</a></h3>
<pre><code>   SOCKET (UNIX || IPI_CLIENT) &lt;string socketname default (see input description)&gt;  
</code></pre>
<p>The SOCKET directive enables NWChem to communicate with other software
packages &ndash; such as <a href="http://ipi-code.org/">i-PI</a> or
<a href="https://wiki.fysik.dtu.dk/ase/ase/calculators/socketio/socketio.html">ASE</a> &ndash; via the i-PI socket protocol.</p>
<p>Communication is done either over Unix sockets (<code>SOCKET UNIX</code>) or IP
sockets (<code>SOCKET IPI_CLIENT</code>):</p>
<ul>
<li>Unix sockets - NWChem will create and bind to a UNIX socket
    file located at <code>/tmp/ipi_&lt;socketname&gt;</code>. If not specified,
    <code>&lt;socketname&gt;</code> will default to <code>nwchem</code>.</li>
<li>IP sockets - NWChem will bind to the IP address and port
    specified by <code>&lt;socketname&gt;</code>. If not specified, <code>&lt;socketname&gt;</code>
    will default to <code>127.0.0.1:31415</code>.</li>
</ul>
<p>The <code>SOCKET</code> directive is only useful when used in conjunction with other
software packages that support communication via the i-PI socket
protocol. For more information, see the
<a href="https://ipi-code.org/i-pi/user-guide.html#communication-protocol">i-PI documentation</a>.</p>
<h3 id="print-options">Print options<a class="headerlink" href="#print-options" title="Permanent link">&para;</a></h3>
<p>The UNIX command <code>grep '^@' \&lt; output</code> will extract a pretty table
summarizing the optimization.</p>
<p>If you specify the NWChem input</p>
<pre><code>     scf; print none; end  
     driver; print low; end  
     task scf optimize
</code></pre>
<p>you&rsquo;ll obtain a pleasantly terse output.</p>
<p>For more control, these options for the standard print directive are
recognized</p>
<ul>
<li>debug - prints a large amount of data. Don&rsquo;t use in parallel.</li>
<li>high - print the search direction in internals</li>
<li>default - prints geometry for each major step (not during the line
    search), gradient in internals (before and after application of
    constraints)</li>
<li>low - prints convergence and energy information. At convergence
    prints final geometry, change in internals from initial geometry</li>
</ul>
<p>and these specific print options</p>
<ul>
<li>finish (low) - print geometry data at end of calculation</li>
<li>bonds (default) - print bonds at end of calculation</li>
<li>angles (default) - print angles at end of calculation</li>
<li>hvecs (never) - print eigen-values/vectors of the Hessian</li>
<li>searchdir (high) - print the search direction in internals</li>
<li>&ldquo;internal gradient&rdquo; (default) - print the gradient in internals</li>
<li>sadmode (default) - print the mode being followed to the saddle
    point</li>
</ul>
<h2 id="geometry-optimization-with-stepper">Geometry Optimization with STEPPER<a class="headerlink" href="#geometry-optimization-with-stepper" title="Permanent link">&para;</a></h2>
<p>The STEPPER module performs a search for critical points on the
potential energy surface of the molecule defined by input using the
<a href="Geometry.html">GEOMETRY</a> directive. Since STEPPER is
not the primary geometry optimization module in NWChem the compound
directive is required; the
<a href="#geometry-optimization-with-driver">DRIVER</a> module is the
default. Input for this module is specified within the compound
directive,</p>
<pre><code> STEPPER  
   ...  
 END
</code></pre>
<p>The presence of the <code>STEPPER</code> compound directive automatically turns off
the default geometry optimization tool <code>DRIVER</code>. Input specified for the
<code>STEPPER</code> module must appear in the input file after the <code>GEOMETRY</code>
directive, since it must know the number of atoms that are to be used in
the geometry optimization. In the current version of NWChem, STEPPER can
be used only with geometries that are defined in Cartesian coordinates.
<code>STEPPER</code> removes translational and rotational components before
determining the step direction (5 components for linear systems and 6
for others) using a standard Eckart algorithm. The default initial guess
nuclear Hessian is the identity matrix.</p>
<p>The default in <code>STEPPER</code> is to minimize the energy as a function of the
geometry with a maximum of 20 geometry optimization iterations. When
this is the desired calculation, no input is required other than the
<code>STEPPER</code> compound directive. However, the user also has the option of
defining different tasks for the <code>STEPPER</code> module, and can vary the number
of iterations and the convergence criteria from the default values. The
input for these options is described in the following sections.</p>
<h3 id="min-and-ts-minimum-or-transition-state-search">MIN and TS: Minimum or transition state search<a class="headerlink" href="#min-and-ts-minimum-or-transition-state-search" title="Permanent link">&para;</a></h3>
<p>The default is for STEPPER to minimize the energy with respect to the
geometry of the system. This default behavior may be forced with the
directive</p>
<pre><code> MIN
</code></pre>
<p>STEPPER can also be used to find the transition state by following the
lowest eigenvector of the nuclear Hessian. This is usually invoked by
using the saddle keyword on the <a href="TASK.html">TASK
directive</a>, but it may also be
selected by specifying the directive</p>
<pre><code> TS
</code></pre>
<p>in the STEPPER input.</p>
<h3 id="track-mode-selection">TRACK: Mode selection<a class="headerlink" href="#track-mode-selection" title="Permanent link">&para;</a></h3>
<p><code>STEPPER</code> has the ability to ``track&rsquo;&rsquo; a specific mode during an
optimization for a transition state search, the user can also have the
module track the eigenvector corresponding to a specific mode. This is
done by specifying the directive</p>
<pre><code> TRACK [nmode &lt;integer nmode default 1&gt;]
</code></pre>
<p>The keyword <code>TRACK</code> tells <code>STEPPER</code> to track the eigenvector corresponding
to the integer value of <nmode> during a transition state walk. (Note:
this input is invalid for a minimization walk since following a specific
eigenvector will not necessarily give the desired local minimum.) The
step is constructed to go up in energy along the nmode eigenvector and
down in all other degrees of freedom.</p>
<h3 id="maxiter-maximum-number-of-steps">MAXITER: Maximum number of steps<a class="headerlink" href="#maxiter-maximum-number-of-steps" title="Permanent link">&para;</a></h3>
<p>In most applications, 20 stepper iterations will be sufficient to obtain
the energy minimization. However, the user has the option of specifying
the maximum number of iterations allowed, using the input line,</p>
<pre><code> MAXITER &lt;integer maxiter default 20&gt;
</code></pre>
<p>The value specified for the integer <maxiter> defines the maximum number
of geometry optimization steps. The geometry optimization will restart
automatically.</p>
<h3 id="trust-trust-radius">TRUST: Trust radius<a class="headerlink" href="#trust-trust-radius" title="Permanent link">&para;</a></h3>
<p>The size of steps that can be taken in STEPPER is controlled by the
trust radius which has a default value of 0.1. Steps are constrained to
be no larger than the trust radius. The user has the option of
overriding this default using the keyword TRUST, with the following
input line,</p>
<pre><code> TRUST &lt;real radius default 0.1&gt;
</code></pre>
<p>The larger the value specified for the variable radius, the larger the
steps that can be taken by <code>STEPPER</code>. Experience has shown that for larger
systems (i.e., those with 20 or more atoms), a value of 0.5, or greater,
usually should be entered for <radius>.</p>
<h3 id="convggm-convgg-and-convge-convergence-criteria">CONVGGM, CONVGG and CONVGE: Convergence criteria<a class="headerlink" href="#convggm-convgg-and-convge-convergence-criteria" title="Permanent link">&para;</a></h3>
<p>Three convergence criteria can be specified explicitly for the STEPPER
calculations. The keyword <code>CONVGGM</code> allows the user to specify the
convergence tolerance for the largest component of the gradient. This is
the primary convergence criterion, as per the default settings, although
all three criteria are in effect. this default setting is consistent
with the other optimizer module <code>DRIVER</code>. The input line for <code>CONVGGM</code> has
the following form,</p>
<pre><code>  CONVGGM &lt;real convggm default 8.0d-04&gt;
</code></pre>
<p>The keyword <code>CONVGG</code> allows the user to specify the convergence tolerance
for the gradient norm for all degrees of freedom. The input line is of
the following form,</p>
<pre><code>  CONVGG &lt;real convgg default 1.0d-02&gt;
</code></pre>
<p>The entry for the real variable <code>&lt;convgg&gt;</code> should be approximately equal
to the square root of the energy convergence tolerance.</p>
<p>The energy convergence tolerance is the convergence criterion for the
energy difference in the geometry optimization in <code>STEPPER</code>. It can be
specified by input using a line of the following form,</p>
<pre><code>  CONVGE &lt;real convge default 1.0d-04&gt;
</code></pre>
<h3 id="backstepping-in-stepper">Backstepping in STEPPER<a class="headerlink" href="#backstepping-in-stepper" title="Permanent link">&para;</a></h3>
<p>If a step taken during the optimization is too large (e.g., the step
causes the energy to go up for a minimization or down for a transition
state search), the <code>STEPPER</code> optimizer will automatically &ldquo;backstep&rdquo;
and correct the step based on information prior to the faulty step. If
you have an optimization that &ldquo;backsteps&rdquo; frequently then the initial
trust radius should most likely be decreased.</p>
<h3 id="initial-nuclear-hessian-options">Initial Nuclear Hessian Options<a class="headerlink" href="#initial-nuclear-hessian-options" title="Permanent link">&para;</a></h3>
<p>Stepper uses a modified Fletcher-Powell algorithm to find the transition
state or energy minimum on the potential energy hypersurface.<br />
There are
two files left in the user&rsquo;s permanent directory that are used to
provide an initial hessian to the critical point search algorithm. If
these files do not exist then the default is to use a unit matrix as the
initial hessian.<br />
Once Stepper executes it generates a binary dump file
by the name of <code>name.stpr41</code> which will be used on all subsequent stepper
runs and modified with the current updated hessian. The default file
prefix is the &ldquo;name&rdquo; that is used (see
<a href="Start_Restart.html">START</a>).
It also stores the information for the last valid step in case the
algorithm must take a <a href="#backstepping-in-stepper">&ldquo;backstep&rdquo;</a>.
This file is the working data store for all stepper-based optimizations.
This file is never deleted by default and is the first source of an
initial hessian.<br />
The second source of an initial hessian is an ASCII file
that contains the lower triangular values of the initial hessian. This
is stored in file <code>name.hess</code>, where &ldquo;name&rdquo; is again the default file
prefix. This is the second source of an initial hessian and is the
method used to incorporate an initial hessian from any other source
(e.g., another ab initio code, a molecular mechanics code, etc.,). To
get a decent starting hessian at a given point you can use the task
specification task scf hessian, with a smaller basis set, which will by
default generate the <code>name.hess</code> file. Then you may define your basis set
of choice and proceed with the optimization you desire.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="1D-RISM.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: 1-D RISM">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                1-D RISM
              </div>
            </div>
          </a>
        
        
          
          <a href="Hessians-and-Vibrational-Frequencies.html" class="md-footer__link md-footer__link--next" aria-label="Next: Hessians">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Hessians
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.top", "navigation.instant", "navigation.tracking", "navigation.indexes", "navigation.footer", "search.highlight", "search.share", "content.action.edit", "content.action.view", "content.code.copy"], "search": "assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.081f42fc.min.js"></script>
      
        <script src="js/print-site.js"></script>
      
        <script src="css/mathjax.js"></script>
      
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
    
  </body>
</html>