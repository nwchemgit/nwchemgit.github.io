<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://nwchemgit.github.io/DNTMC.html" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>Dynamical Nucleation Theory Monte Carlo - NWChem</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Dynamical Nucleation Theory Monte Carlo";
        var mkdocs_page_input_path = "DNTMC.md";
        var mkdocs_page_url = "/DNTMC.html";
      </script>
    
    <script src="js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]--> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="." class="icon icon-home"> NWChem
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Home.html">NWChem Manual</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Download.html">How to download and install NWChem</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction </a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Quantum-Mechanical-Methods.html">Quantum Mechanical Methods</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Quantum-Molecular-Dynamics.html">Quantum Molecular Dynamics</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Hybrid-Approaches.html">Hybrid Approaches</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Other-Capabilities.html">Other Capabilities</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Examples.html">NWChem Examples</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Compiling-NWChem.html">How to Compile NWChem</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Benchmarks.html">Benchmarks performed with NWChem</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Known-Bugs.html">Known Bugs</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Tutorials.html">NWChem Tutorials</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Forum.html">Forum</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Archived-Forum.html">Archived Forum</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="EMSL_Arrows.html">EMSL Arrows</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Software-supporting-NWChem.html">Software supporting NWChem</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Supplementary-Information.html">Supplementary Information</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="Containers.html">Containers</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href=".">NWChem</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Dynamical Nucleation Theory Monte Carlo</li>
    <li class="wy-breadcrumbs-aside">
        <a href="https://github.com/nwchemgit/nwchem-wiki/blob/master/DNTMC.md"
          class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="dynamical-nucleation-theory-monte-carlo">Dynamical Nucleation Theory Monte Carlo<a class="headerlink" href="#dynamical-nucleation-theory-monte-carlo" title="Permanent link">&para;</a></h1>
<ol>
<li>Schenter, G. K.; Kathmann, S. M.; Garrett, B. C. J. Chem. Phys.
    (1999), 110, 7951.</li>
<li>Crosby, L. D.; Kathmann, S. M.; Windus, T. L.
    J. Comput. Chem. ( 2008), submitted.</li>
</ol>
<p>The Dynamical Nucleation Theory Monte Carlo (DNTMC) module utilizes
Dynamical Nucleation Theory (DNT) to compute monomer evaporation rate
constants at a given temperature. The reactant is a molecular cluster of
<em>i</em> rigid monomers while the product is a molecular cluster with <em>i-1</em>
monomers plus a free monomer. A Metropolis Monte Carlo (MC) methodology
is utilized to sample the configurational space of these <em>i</em> rigid
monomers. Both homogenous and heterogenous clusters are supported.</p>
<h2 id="subgroups">SubGroups<a class="headerlink" href="#subgroups" title="Permanent link">&para;</a></h2>
<p>The DNTMC module supports the use of subgroups in the MC simulations.
The number of subgroups is defined in the input through a set directive:</p>
<pre><code>    set subgroup_number &lt;integer number&gt;
</code></pre>
<p>where the number of subgroups requested is the argument. The number of
processors that each subgroup has access to is determined by
Total/subgroup_number. A separate MC simulation is performed within
each subgroup. To use this functionality, NWChem must be compiled with
the USE_SUBGROUPS environmental variable set.</p>
<p>Each MC simulation starts at a different starting configuration, which
is equally spaced along the reaction coordinate. The statistical
distributions which these MC simulations produce are averaged to form
the final statistical distribution. Output from these subgroups consists
of various files whose names are of the form (<code>*.#num</code>). These files
include restart files and other data files. The NWChem runtime database
(RTDB) is used as input for these subgroups and must be globally
accessible (set through the Permanent_Dir directive) to all processes.</p>
<h2 id="input-syntax">Input Syntax<a class="headerlink" href="#input-syntax" title="Permanent link">&para;</a></h2>
<p>The input block has the following form:</p>
<pre><code> DNTMC  
    [nspecies &lt;integer number&gt;]  
    [species  &lt;list of strings name[nspecies]]  
    [nmol     &lt;list of integers number[nspecies]&gt;]  

    [temp     &lt;real temperature&gt;]  
    [rmin     &lt;real rmin&gt;]  
    [rmax     &lt;real rmax&gt;]  
    [nob      &lt;integer nob&gt;]  
    [mcsteps  &lt;integer number&gt;]  
    [tdisp    &lt;real disp&gt;]  
    [rdisp    &lt;real rot&gt;]  
    [rsim || rconfig]  
    [mprnt    &lt;integer number&gt;]  
    [convergence &lt;real limit&gt;]  
    [norestart]  
    [dntmc_dir &lt;string directory&gt;]  

    [print &amp;&amp;|| noprint]  

    [procrestart &lt;integer number&gt;]  
 END
</code></pre>
<h2 id="definition-of-monomers">Definition of Monomers<a class="headerlink" href="#definition-of-monomers" title="Permanent link">&para;</a></h2>
<p>Geometry information is required for each unique monomer (species). See
the geometry input section 6 for more information. A unique label must
be given for each monomer geometry. Additionally, the noautosym and
nocenter options are suggested for use with the DNTMC module to prevent
NWChem from changing the input geometries. Symmetry should also not be
used since cluster configurations will seldom exhibit any symmetry;
although monomers themselves may exhibit symmetry.</p>
<pre><code> GEOMETRY [&lt;string name species_1&gt;] noautosym nocenter ...  
     ...  
 symmetry c1  
 END  

 GEOMETRY [&lt;string name species_2&gt;] noautosym nocenter ...  
     ...  
 symmetry c1  
 END  

 ...
</code></pre>
<p>The molecular cluster is defined by the number of unique monomers
(nspecies). The geometry labels for each unique monomer is given in a
space delimited list (species). Also required are the number of each
unique monomer in the molecular cluster given as a space delimited list
(nmol). These keywords are required and thus have no default values.</p>
<pre><code>    [nspecies &lt;integer number&gt;]  
    [species  &lt;list of strings name[nspecies]]  
    [nmol     &lt;list of integers number[nspecies]&gt;]
</code></pre>
<p>An <a href="#example">example</a> is shown for a 10 monomer cluster
consisting of a 50/50 mixture of water and ammonia.</p>
<h2 id="dntmc-runtime-options">DNTMC runtime options<a class="headerlink" href="#dntmc-runtime-options" title="Permanent link">&para;</a></h2>
<p>Several options control the behavior of the DNTMC module. Some required
options such as simulation temperature (temp), cluster radius (rmin and
rmax), and maximum number of MC steps (mcsteps) are used to control the
MC simulation.</p>
<pre><code>    [temp     &lt;real temperature&gt;]
</code></pre>
<p>This required option gives the simulation temperature in which the MC
simulation is run. Temperature is given in kelvin.</p>
<pre><code>    [rmin     &lt;real rmin&gt;]  
    [rmax     &lt;real rmax&gt;]  
    [nob    &lt;integer nob&gt;]
</code></pre>
<p>These required options define the minimum and maximum extent of the
projected reaction coordinate (The radius of a sphere centered at the
center of mass). Rmin should be large enough to contain the entire
molecular cluster of monomers and Rmax should be large enough to include
any relevant configurational space (such as the position of the reaction
bottleneck). These values are given in Angstroms.</p>
<p>The probability distributions obtain along this projected reaction
coordinate has a minimum value of Rmin and a maximum value of Rmax. The
distributions are created by chopping this range into a number of
smaller sized bins. The number of bins (nob) is controlled by the option
of the same name.</p>
<pre><code>    [mcsteps  &lt;integer number&gt;]  
    [tdisp    &lt;real disp default 0.04&gt;]  
    [rdisp    &lt;real rot default 0.06&gt;]  
    [convergence &lt;real limit default 0.00&gt;]
</code></pre>
<p>These options define some characteristics of the MC simulations. The
maximum number of MC steps (mcsteps) to take in the course of the
calculation run is a required option. Once the MC simulation has
performed this number of steps the calculation will end. This is a per
Markov chain quantity. The maximum translational step size (tdisp) and
rotational step size (rdisp) are optional inputs with defaults set at
0.04 Angstroms and 0.06 radians, respectively. The convergence keyword
allows the convergence threshold to be set. The default is 0.00 which
effectively turns off this checking. Once the measure of convergence
goes below this threshold the calculation will end.</p>
<p><code>[rsim || rconfig]</code></p>
<p>These optional keywords allow the selection of two different MC sampling
methods. rsim selects a Metropolis MC methodology which samples
configurations according to a Canonical ensemble. The rconfig keyword
selects a MC methodology which samples configurations according to a
derivative of the Canonical ensemble with respect to the projected
reaction coordinate. These keywords are optional with the default method
being rconfig.</p>
<pre><code>    [mprnt    &lt;integer number default 10&gt;]  
    [dntmc_dir &lt;string directory default ./&gt;]  
    [norestart]
</code></pre>
<p>These three options define some of the output and data analysis
behavior. mprnt is an option which controls how often data analysis
occurs during the simulation. Currently, every <code>mprnt*nob</code> MC steps data
analysis is performed and results are output to files and/or to the log
file. Restart files are also written every mprnt number of MC steps
during the simulation. The default value is 10. The keyword dntmc_dir
allows the definition of an alternate directory to place DNTMC specific
ouputfiles. These files can be very large so be sure enough space is
available. This directory should be accessible by every process
(although not necessarily globally accessible). The default is to place
these files in the directory which NWChem is run (./). The keyword
norestart turns off the production of restart files. By default restart
files are produced every mprnt number of MC steps.</p>
<h2 id="print-control">Print Control<a class="headerlink" href="#print-control" title="Permanent link">&para;</a></h2>
<p>The DNTMC module supports the use of PRINT and NOPRINT Keywords. The
specific labels which DNTMC recognizes are included
below.</p>
<p><center></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Name</strong></td>
<td><strong>Print Level</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr>
<td>&ldquo;debug&rdquo;</td>
<td>debug</td>
<td>Some debug information written in Output file.</td>
</tr>
<tr>
<td>&ldquo;information&rdquo;</td>
<td>none</td>
<td>Some information such as energies and geometries.</td>
</tr>
<tr>
<td>&ldquo;mcdata&rdquo;</td>
<td>low</td>
<td>Production of a set of files (<code>Prefix.MCdata.#num</code>). These files are a concatenated list of structures, Energies, and Dipole Moments for each accepted configuration sampled in the MC run.</td>
</tr>
<tr>
<td>&ldquo;alldata&rdquo;</td>
<td>low</td>
<td>Production of a set of files (<code>Prefix.Alldata.#num</code>). These files include the same information as MCdata files. However, they include ALL configurations (accepted or rejected).</td>
</tr>
<tr>
<td>&ldquo;mcout&rdquo;</td>
<td>debug - low</td>
<td>Production of a set of files (<code>Prefix.MCout.#num</code>). These files contain a set of informative and debug information. Also included is the set of information which mirrors the Alldata files.</td>
</tr>
<tr>
<td>&ldquo;fdist&rdquo;</td>
<td>low</td>
<td>Production of a file (<code>Prefix.fdist</code>) which contains a concatenated list of distributions every <code>mprnt*100</code> MC steps.</td>
</tr>
<tr>
<td>&ldquo;timers&rdquo;</td>
<td>debug</td>
<td>Enables some timers in the code. These timers return performance statistics in the output file every time data analysis is performed. Two timers are used. One for the mcloop itself and one for the communication step.</td>
</tr>
</tbody>
</table>
<p></center></p>
<h2 id="selected-file-formats">Selected File Formats<a class="headerlink" href="#selected-file-formats" title="Permanent link">&para;</a></h2>
<p>Several output files are available in the DNTMC module. This section
defines the format for some of these files.</p>
<ol>
<li>
<p><code>*.fdist</code>  </p>
<p>This file is a concatenated list of radial distribution functions
printed out every mprnt MC steps. Each distribution is normalized
(sum equal to one) with respect to the entire (all species)
distribution. The error is the RMS deviation of the average at each
point. Each entry is as follows:   </p>
</li>
</ol>
<pre><code>    [1] # Total Configurations 
    [2] Species number # 
    [3](R coordinate in Angstroms) (Probability) (Error) 
    [Repeats nob times] 
    [2 and 3 Repeats for each species]
    [4] *** separator.  
 ```     
2.  `*.MCdata.#`  

    This file is a concatenated list of accepted configurations. Each
    file corresponds to a single Markov chain. The dipole is set to zero
    for methods which do not produce a dipole moment with energy
    calculations. Rsim is either the radial extent of the cluster
    (r-config) or the simulation radius (r-simulation). Each entry is as
    follows: 
</code></pre>
<pre><code>[1] (Atomic label) (X Coord.) (Y Coord.) (Z Coord.) 
[1 Repeats for each atom in the cluster configuration, units are in
angstroms] 
[2] Ucalc = # hartree 
[3] Dipole = (X) (Y) (Z) au
[4] Rsim = # Angstrom 
[1 through 4 repeats for each accepted configuration]
</code></pre>
<pre><code>3.  `*.MCout.#`  

    This file has the same format and information content as the MCdata
    file except that additional output is included. This additional
    output includes summary statistics such as acceptance ratios,
    average potential energy, and average radius. The information
    included for accepted configurations does not include dipole moment
    or radius.  

4.  `*.MCall.#`  

    This file has the same format as the MCdata file expect that it
    includes information for all configurations for which an energy is
    determined. All accepted and rejected configurations are included in
    this file.  

5.  `*.restart.#`  

    This file contains the restart information for each subgroup. Its
    format is not very human readable but the basic fields are described
    in short here. 
</code></pre>
<pre><code>Random number seed Potential energy in hartrees
Sum of potential energy
Average potential energy
Sum of the squared potential energy
Squared potential energy Dipole moment in au (x) (Y) (Z)
Rmin and Rmax Rsim (Radius corresponds to r-config or r-sim methods)
Array of nspecies length, value indicates the number of  each type of monomer which lies at radius Rsim from the center of mass [r-simulation sets these to zero]
Sum of Rsim Average of Rsim
Number of accepted translantional moves
Number of accepted rotational moves Number of accepted volume moves
Number of attempted moves (volume) (translational) (rotational)
Number of accepted moves (Zero)
Number of accepted moves (Zero)
Number of MC steps completed
[1] (Atom label) (X Coord.) (Y Coord.) (Z Coord.)
[1 repeats for each atom in cluster configurations, units are in angstroms]
[2] Array of nspecies length, number of configurations in bin
[3] Array of nspecies length, normalized number of configurations in each bin
[4] (Value of bin in Angstroms) (Array of nspecies length, normalized probability of bin)
[2 through 4 repeats nob  times]
</code></pre>
<pre><code>
## DNTMC Restart
</code></pre>
<p>[procrestart <integer number>]</p>
<pre><code>Flag to indicate restart postprocessing. It is suggested that this
postprocessing run is done utilizing only one processor.

In order to restart a DNTMC run, postprocessing is required to put
required information into the runtime database (RTDB). During a run
restart information is written to files (`Prefix.restart.#num`) every
mprnt MC steps. This information must be read and deposited into the
RTDB before a restart run can be done. The number taken as an argument
is the number of files to read and must also equal the number of
subgroups the calculation utilizes. The start directive must also be set
to restart for this to work properly. All input is read as usual.
However, values from the restart files take precedence over input
values. Some keywords such as mcsteps are not defined in the restart
files. Task directives are ignored. You must have a RTDB present in your
permanent directory.

Once postprocessing is done a standard restart can be done from the RTDB
by removing the procrestart keyword and including the restart directive.

## Task Directives

The DNTMC module can be used with any level of theory which can produce
energies. Gradients and Hessians are not required within this
methodology. If dipole moments are available, they are also utilized.
The task directive for the DNTMC module is shown below:
</code></pre>
<p>task <string theory> dntmc</p>
<pre><code>## Example

This example is for a molecular cluster of 10 monomers. A 50/50 mixture
of water and ammonia. The energies are done at the SCF/6-31++G** level
of
theory.
</code></pre>
<p>start<br />
   # start or restart directive if a restart run<br />
   MEMORY 1000 mb  </p>
<p>PERMANENT_DIR /home/bill<br />
   # Globally accessible directory which the<br />
   # rtdb (*.db) file will/does reside.  </p>
<p>basis &ldquo;ao basis&rdquo; spherical noprint<br />
       * library 6-31++G**<br />
   end<br />
   # basis set directive for scf energies  </p>
<p>scf<br />
       singlet<br />
       rhf<br />
       tol2e 1.0e-12<br />
       vectors input atomic<br />
       thresh 1.0e-06<br />
       maxiter 200<br />
       print none<br />
   end<br />
   # scf directive for scf energies  </p>
<p>geometry geom1 units angstroms noautosym nocenter noprint<br />
   O  0.393676503613369      -1.743794626956820      -0.762291912129271<br />
   H -0.427227157125777      -1.279138812526320      -0.924898279781319<br />
   H  1.075463952717060      -1.095883929075060      -0.940073459864222<br />
   symmetry c1<br />
   end<br />
   # geometry of a monomer with title &ldquo;geom1&rdquo;  </p>
<p>geometry geom2 units angstroms noautosym nocenter noprint<br />
   N     6.36299e-08     0.00000     -0.670378<br />
   H     0.916275     0.00000     -0.159874<br />
   H     -0.458137     0.793517     -0.159874<br />
   H     -0.458137     -0.793517     -0.159874<br />
   symmetry c1<br />
   end<br />
   # geometry of another monomer with title &ldquo;geom2&rdquo;<br />
   # other monomers may be included with different titles  </p>
<p>set subgroups_number 8<br />
   # set directive which gives the number of subgroups<br />
   # each group runs a separate MC simulation  </p>
<p>dntmc<br />
   # DNTMC input block<br />
       nspecies 2<br />
       # The number of unique species (number of titled geometries<br />
       # above)<br />
       species geom1 geom2<br />
       # An array of geometry titles (one for each<br />
       # nspecies/geometry)<br />
       nmol    5  5<br />
       # An array stating the number of each<br />
       # monomer/nspecies/geometry in simulation.<br />
       temp  243.0<br />
       mcsteps 1000000<br />
       rmin 3.25<br />
       rmax 12.25<br />
       mprnt 10<br />
       tdisp 0.04<br />
       rdisp 0.06<br />
       print none fdist mcdata<br />
       # this print line first sets the print-level to none<br />
       # then it states that the <em>.fdist and </em>.mcdata.(#num)<br />
       # files are to be written<br />
       rconfig<br />
       dntmc_dir /home/bill/largefile<br />
       # An accessible directory which to place the <em>.fdist,<br />
       # </em>.mcdata.(#num), and *.restart.(#num) files.<br />
       convergence 1.0D+00<br />
   end  </p>
<p>task scf dntmc<br />
   # task directive stating that energies are to be done at the scf<br />
   #level of theory.
```   </p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/nwchemgit/nwchem-wiki" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
    
  </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme_extra.js" defer></script>
    <script src="js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
