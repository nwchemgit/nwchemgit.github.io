
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="NWChem Website">
      
      
      
        <link rel="canonical" href="https://nwchemgit.github.io/QMMM_Appendix.html">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>QMMM Apppendix - NWChem</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Lato";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#qmmm-apppendix" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="NWChem" class="md-header__button md-logo" aria-label="NWChem" data-md-component="logo">
      
  <img src="assets/MS3logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NWChem
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              QMMM Apppendix
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/nwchemgit/nwchem-wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="NWChem" class="md-nav__button md-logo" aria-label="NWChem" data-md-component="logo">
      
  <img src="assets/MS3logo.png" alt="logo">

    </a>
    NWChem
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nwchemgit/nwchem-wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Home.html" class="md-nav__link">
        NWChem Manual
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2">
          How to get NWChem
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="How to get NWChem" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          How to get NWChem
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Download.html" class="md-nav__link">
        How to download and install NWChem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Compiling-NWChem.html" class="md-nav__link">
        Compiling NWChem from source
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Introduction 
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Introduction " data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Introduction 
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Getting-Started.html" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="NWChem-Architecture.html" class="md-nav__link">
        NWChem Architecture
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          Quantum-Mechanical-Methods
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Quantum-Mechanical-Methods" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Quantum-Mechanical-Methods
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Hartree-Fock-Theory-for-Molecules.html" class="md-nav__link">
        Hartree-Fock
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Density-Functional-Theory-for-Molecules.html" class="md-nav__link">
        Density Functional Theory (DFT)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Excited-State-Calculations.html" class="md-nav__link">
        CIS, TDHF, TDDFT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="RT-TDDFT.html" class="md-nav__link">
        Real-time TDDFT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Plane-Wave-Density-Functional-Theory.html" class="md-nav__link">
        Plane-Wave Density Functional Theory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="TCE.html" class="md-nav__link">
        Tensor Contraction Engine Module: CI, MBPT, and CC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="MP2.html" class="md-nav__link">
        MP2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="CCSD.html" class="md-nav__link">
        Coupled Cluster Calculations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Multiconfiguration_SCF.html" class="md-nav__link">
        MCSCF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="GW.html" class="md-nav__link">
        Molecular GW
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5">
          Quantum Molecular Dynamics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Quantum Molecular Dynamics" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Quantum Molecular Dynamics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Plane-Wave-Density-Functional-Theory.html" class="md-nav__link">
        Plane-Wave Density Functional Theory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Gaussian-Basis-AIMD.html" class="md-nav__link">
        Gaussian Basis AIMD
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6">
          Hybrid Approaches
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Hybrid Approaches" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Hybrid Approaches
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="COSMO-Solvation-Model.html" class="md-nav__link">
        COSMO Solvation Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="SMD-Model.html" class="md-nav__link">
        SMD (Solvation Model Based on Density) Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="VEM-Model.html" class="md-nav__link">
        VEM (Vertical Excitation or Emission) Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ONIOM.html" class="md-nav__link">
        Hybrid Calculations with ONIOM
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_5" type="checkbox" id="__nav_6_5" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_5">
          QMMM
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="QMMM" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_5">
          <span class="md-nav__icon md-icon"></span>
          QMMM
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="qmmm_introduction.html" class="md-nav__link">
        QMMM Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM.html" class="md-nav__link">
        QMMM table of contents
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_6_5_3" type="checkbox" id="__nav_6_5_3" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_5_3">
          QMMM Restart and Topology Files
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="QMMM Restart and Topology Files" data-md-level="3">
        <label class="md-nav__title" for="__nav_6_5_3">
          <span class="md-nav__icon md-icon"></span>
          QMMM Restart and Topology Files
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Restart_and_Topology_Files.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Preparation_Prerequisites.html" class="md-nav__link">
        QMMM Preparation Prerequisites
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_preparation_basic.html" class="md-nav__link">
        Qmmm preparation basic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_preparation_solvation.html" class="md-nav__link">
        Qmmm preparation solvation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_preparation_constraints.html" class="md-nav__link">
        Qmmm preparation constraints
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_6_5_4" type="checkbox" id="__nav_6_5_4" checked>
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_5_4">
          QMMM Input File
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="QMMM Input File" data-md-level="3">
        <label class="md-nav__title" for="__nav_6_5_4">
          <span class="md-nav__icon md-icon"></span>
          QMMM Input File
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Input_File.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_QM_Parameters.html" class="md-nav__link">
        QM_Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_MM_Parameters.html" class="md-nav__link">
        QMMM MM Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_QMMM_Parameters.html" class="md-nav__link">
        QM/MM parameters
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_6_5_5" type="checkbox" id="__nav_6_5_5" checked>
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_5_5">
          QMMMM Single Point Calculations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="QMMMM Single Point Calculations" data-md-level="3">
        <label class="md-nav__title" for="__nav_6_5_5">
          <span class="md-nav__icon md-icon"></span>
          QMMMM Single Point Calculations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="qmmm_sp_energy.html" class="md-nav__link">
        QMMM Ground State Energy and Gradient
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Excited_States.html" class="md-nav__link">
        QMMM Excited State Energy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="qmmm_sp_property.html" class="md-nav__link">
        QMMM Properties
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_ESP.html" class="md-nav__link">
        QMMM ESP Charge Analysis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_6_5_6" type="checkbox" id="__nav_6_5_6" checked>
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_5_6">
          QMMM Potential Energy Surface Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="QMMM Potential Energy Surface Analysis" data-md-level="3">
        <label class="md-nav__title" for="__nav_6_5_6">
          <span class="md-nav__icon md-icon"></span>
          QMMM Potential Energy Surface Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_optimization.html" class="md-nav__link">
        QMMM Optimization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Transition_States.html" class="md-nav__link">
        QMMM Transition States
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_freq.html" class="md-nav__link">
        QMMM Hessians and Frequency
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Qmmm_NEB_Calculations.html" class="md-nav__link">
        QMMM Reaction Pathway Calculations with NEB
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Dynamics.html" class="md-nav__link">
        QMMM Dynamics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="QMMM_Free_Energy.html" class="md-nav__link">
        QMMM Free Energy
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          QMMM Apppendix
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="QMMM_Appendix.html" class="md-nav__link md-nav__link--active">
        QMMM Apppendix
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#preparing-qmmm-calculations-from-scratch" class="md-nav__link">
    Preparing QM/MM calculations from scratch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generation-of-the-proper-pdb-file" class="md-nav__link">
    Generation of the proper PDB file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generation-of-new-fragment-files" class="md-nav__link">
    Generation of new fragment files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generation-of-new-parameter-files" class="md-nav__link">
    Generation of new parameter files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#format-of-nwchem-parameter-file" class="md-nav__link">
    Format of NWChem parameter file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conversion-of-standard-amber-program-parameter-files" class="md-nav__link">
    Conversion of standard AMBER program parameter files
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Bq.html" class="md-nav__link">
        Point charges
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="1D-RISM.html" class="md-nav__link">
        1-D RISM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7">
          Potential Energy Surface Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Potential Energy Surface Analysis" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Potential Energy Surface Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Geometry-Optimization.html" class="md-nav__link">
        Geometry Optimization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Hessians-and-Vibrational-Frequencies.html" class="md-nav__link">
        Hessians
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Constraints.html" class="md-nav__link">
        Constraints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Nudged-Elastic-Band-and-Zero-Temperature-String-Methods.html" class="md-nav__link">
        Nudged Elastic Band (NEB) method
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" checked>
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_8">
          Electronic Structure Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Electronic Structure Analysis" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Electronic Structure Analysis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Properties.html" class="md-nav__link">
        Properties
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ESP.html" class="md-nav__link">
        Electrostatic potentials
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="DPLOT.html" class="md-nav__link">
        DPLOT
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_9">
          Other-Capabilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Other-Capabilities" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Other-Capabilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Electron-Transfer.html" class="md-nav__link">
        Electron Transfer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Python.html" class="md-nav__link">
        Controlling NWChem with Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Quantum.html" class="md-nav__link">
        Quantum
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="VSCF.html" class="md-nav__link">
        Vibrational SCF (VSCF)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="CCCA_method.html" class="md-nav__link">
        Correlation consistent Composite Approach (ccCA)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Interface.html" class="md-nav__link">
        Interfaces to Other Programs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" checked>
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_10">
          Molecular Mechanics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Molecular Mechanics" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Molecular Mechanics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Prepare.html" class="md-nav__link">
        Prepare
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="MD.html" class="md-nav__link">
        MD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Analysis.html" class="md-nav__link">
        Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Format_of_MD_Files.html" class="md-nav__link">
        Format of MD files
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" checked>
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_11">
          NWChem Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="NWChem Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          NWChem Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Sample.html" class="md-nav__link">
        Sample input files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Geometry-examples.html" class="md-nav__link">
        Examples of geometries using symmetry
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Benchmarks.html" class="md-nav__link">
        Benchmarks performed with NWChem
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Known-Bugs.html" class="md-nav__link">
        Known Bugs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="FAQ.html" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Tutorials.html" class="md-nav__link">
        NWChem Tutorials
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Forum.html" class="md-nav__link">
        Forum
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Archived-Forum.html" class="md-nav__link">
        Archived Forum
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="EMSL_Arrows.html" class="md-nav__link">
        EMSL Arrows
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_19" type="checkbox" id="__nav_19" checked>
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_19">
          Supplementary Information
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Supplementary Information" data-md-level="1">
        <label class="md-nav__title" for="__nav_19">
          <span class="md-nav__icon md-icon"></span>
          Supplementary Information
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://hpc.pnl.gov/globalarrays/" class="md-nav__link">
        Global Arrays
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ARMCI.html" class="md-nav__link">
        Choosing the ARMCI Library
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Software-supporting-NWChem.html" class="md-nav__link">
        Software supporting NWChem
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Containers.html" class="md-nav__link">
        Containers
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://nwchemgit.github.io/nwchemusermanual.pdf" class="md-nav__link">
        Documentation in PDF format
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#preparing-qmmm-calculations-from-scratch" class="md-nav__link">
    Preparing QM/MM calculations from scratch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generation-of-the-proper-pdb-file" class="md-nav__link">
    Generation of the proper PDB file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generation-of-new-fragment-files" class="md-nav__link">
    Generation of new fragment files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generation-of-new-parameter-files" class="md-nav__link">
    Generation of new parameter files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#format-of-nwchem-parameter-file" class="md-nav__link">
    Format of NWChem parameter file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conversion-of-standard-amber-program-parameter-files" class="md-nav__link">
    Conversion of standard AMBER program parameter files
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/nwchemgit/nwchem-wiki/blob/master/QMMM_Appendix.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 12h8v2H8v-2m2 8H6V4h7v5h5v3.1l2-2V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4v-2m-2-2h4.1l.9-.9V16H8v2m12.2-5c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
  </a>


<h1 id="qmmm-apppendix">QMMM Apppendix<a class="headerlink" href="#qmmm-apppendix" title="Permanent link">&para;</a></h1>
<h2 id="preparing-qmmm-calculations-from-scratch">Preparing QM/MM calculations from scratch<a class="headerlink" href="#preparing-qmmm-calculations-from-scratch" title="Permanent link">&para;</a></h2>
<p>Setting up QM/MM calculations for a new system for which classical force
analog is not readily available would typically involve the following
steps</p>
<ol>
<li><a href="#generation-of-the-proper-pdb-file">Generation of the proper PDB file</a></li>
<li><a href="#generation-of-new-fragment-files">Construction the fragment file(s)</a></li>
<li><a href="#generation-of-new-parameter-files">Creation of parameter file if new atom types were defined</a></li>
</ol>
<h2 id="generation-of-the-proper-pdb-file">Generation of the proper PDB file<a class="headerlink" href="#generation-of-the-proper-pdb-file" title="Permanent link">&para;</a></h2>
<p>It is often the case that the input structure for the system comes in
the form of the xyz file. Let us take a concrete example of N3O3-
molecule, which we would like to embed in classical solvent and perform
QM/MM calculations. Here is the structure of just N3O3- in xyz format
(generated in course of gas phase optimizations)</p>
<pre><code>   6      
  geometry   
  N                     1.31562667     0.93574165    -0.42424728  
  O                     1.56161766     0.18015298    -1.36827899  
  N                     2.36373381     1.02559495     0.48834956  
  O                     3.47240000     0.42852552     0.42137570  
  N                     1.95804013     1.90608355     1.48799418  
  O                     2.81393172     2.06788134     2.36142683
</code></pre>
<p>We cannot use this file as is in the QM/MM simulations, and it has to be
converted into PDB format. This is needed even if we plan to treat this
molecule quantum mechanically. There is more than way to do it. For
example, we could use Babel <a href="http://openbabel.org/wiki/Main_Page">http://openbabel.org/wiki/Main_Page</a>,
which will generate the PDB file as  </p>
<pre><code>COMPND    geometry   
AUTHOR    GENERATED BY OPEN BABEL 2.3.0  
HETATM    1  O   LIG     1       1.562   0.180  -1.368  1.00  0.00           O    
HETATM    2  N   LIG     1       1.316   0.936  -0.424  1.00  0.00           N    
HETATM    3  N   LIG     1       2.364   1.026   0.488  1.00  0.00           N    
HETATM    4  O   LIG     1       3.472   0.429   0.421  1.00  0.00           O    
HETATM    5  N   LIG     1       1.958   1.906   1.488  1.00  0.00           N    
HETATM    6  O   LIG     1       2.814   2.068   2.361  1.00  0.00           O    
CONECT    1    2                                                        
CONECT    2    1    3                                                   
CONECT    3    2    4    5                                              
CONECT    4    3                                                        
CONECT    5    3    6                                                   
CONECT    6    5                                                        
MASTER        0    0    0    0    0    0    0    0    6    0    6    0  
END
</code></pre>
<p>which after stripping nonessential information becomes  </p>
<pre><code> HETATM    1  O   LIG     1       1.562   0.180  -1.368  1.00  0.00           O    
 HETATM    2  N   LIG     1       1.316   0.936  -0.424  1.00  0.00           N    
 HETATM    3  N   LIG     1       2.364   1.026   0.488  1.00  0.00           N    
 HETATM    4  O   LIG     1       3.472   0.429   0.421  1.00  0.00           O    
 HETATM    5  N   LIG     1       1.958   1.906   1.488  1.00  0.00           N    
 HETATM    6  O   LIG     1       2.814   2.068   2.361  1.00  0.00           O    
 END
</code></pre>
<p>This is not yet the format we want. So what we need to do is</p>
<ol>
<li><em>replace HETATM field by ATOM preserving the format (column
locations) of the rest of the file</em>:</li>
</ol>
<p>I would typically use sed for this purpose</p>
<pre><code> sed 's/HETATM/ATOM  /' n3o3-bad.pdb &gt; n3o3-step1.pdb
</code></pre>
<p>where <code>n3o3-bad.pdb</code> is the original pdb file from Babel and
<code>n3o3-step1.pdb</code> is the converted one as shown below</p>
<pre><code>ATOM      1  O   LIG     1       1.562   0.180  -1.368  1.00  0.00           O  
ATOM      2  N   LIG     1       1.316   0.936  -0.424  1.00  0.00           N  
ATOM      3  N   LIG     1       2.364   1.026   0.488  1.00  0.00           N  
ATOM      4  O   LIG     1       3.472   0.429   0.421  1.00  0.00           O  
ATOM      5  N   LIG     1       1.958   1.906   1.488  1.00  0.00           N  
ATOM      6  O   LIG     1       2.814   2.068   2.361  1.00  0.00           O  
END
</code></pre>
<ol>
<li><em>define residues (aka molecules):</em></li>
</ol>
<p>In our case Babel did this for us and the entire system is defined as
one residue with the name LIG (see columns 4 and 5). We can leave it as,
but I will redefine residue name to NN3 (keep it to 3 characters !).
Again running <code>sed 's/LIG/NN3/' n3o3-step1.pdb &gt; n3o3-step2.pdb</code></p>
<pre><code>ATOM      1  O   NN3     1       1.562   0.180  -1.368  1.00  0.00           O  
ATOM      2  N   NN3     1       1.316   0.936  -0.424  1.00  0.00           N  
ATOM      3  N   NN3     1       2.364   1.026   0.488  1.00  0.00           N  
ATOM      4  O   NN3     1       3.472   0.429   0.421  1.00  0.00           O  
ATOM      5  N   NN3     1       1.958   1.906   1.488  1.00  0.00           N  
ATOM      6  O   NN3     1       2.814   2.068   2.361  1.00  0.00           O  
END
</code></pre>
<p>You could have also broken it up into several residues as</p>
<pre><code>ATOM      1  O   NN2     1       1.562   0.180  -1.368  1.00  0.00           O  
ATOM      2  N   NN2     1       1.316   0.936  -0.424  1.00  0.00           N  
ATOM      3  N   NN2     1       2.364   1.026   0.488  1.00  0.00           N  
ATOM      4  O   NN2     1       3.472   0.429   0.421  1.00  0.00           O  
ATOM      5  N   NN1     2       1.958   1.906   1.488  1.00  0.00           N  
ATOM      6  O   NN1     2       2.814   2.068   2.361  1.00  0.00           O  
END
</code></pre>
<p>where I defined two residues NN2 and NN1 (note changes in columns 4 and
5). To keep things simple I will stay with one residue version for now</p>
<ol>
<li><em>make unique atom names</em>:</li>
</ol>
<p>This has to do with the requirement that all atoms names have to be
unique within a given residue. So if we take our one residue version it
could be modified as (notice column 3)</p>
<pre><code>ATOM      1  O1  NN3     1       1.562   0.180  -1.368  1.00  0.00           O  
ATOM      2  N1  NN3     1       1.316   0.936  -0.424  1.00  0.00           N  
ATOM      3  N2  NN3     1       2.364   1.026   0.488  1.00  0.00           N  
ATOM      4  O2  NN3     1       3.472   0.429   0.421  1.00  0.00           O  
ATOM      5  N3  NN3     2       1.958   1.906   1.488  1.00  0.00           N  
ATOM      6  O3  NN3     2       2.814   2.068   2.361  1.00  0.00           O  
END
</code></pre>
<p>Now we have a PDB file for our system in &ldquo;proper&rdquo; PDB format. Before we
move to next step, I should mention that the last 3 columns are not
necessary and could have been removed at any point leading to
<a href="n3o3.pdb">n3o3.pdb</a></p>
<pre><code>ATOM      1  O1  NN3     1       1.562   0.180  -1.368      
ATOM      2  N1  NN3     1       1.316   0.936  -0.424      
ATOM      3  N2  NN3     1       2.364   1.026   0.488      
ATOM      4  O2  NN3     1       3.472   0.429   0.421      
ATOM      5  N3  NN3     2       1.958   1.906   1.488      
ATOM      6  O3  NN3     2       2.814   2.068   2.361      
END
</code></pre>
<h2 id="generation-of-new-fragment-files">Generation of new fragment files<a class="headerlink" href="#generation-of-new-fragment-files" title="Permanent link">&para;</a></h2>
<p>While setting up QM/MM calculations is often necessary to generate new
fragment files for the molecules that are not available as part of
standard set. The IMPORTANT assumption here is that these new
molecules/residues will be part of OQM region, and as a result only
minimum information needs to be provided to include them in QM/MM
calculations.</p>
<p>First we must ensure that we have a proper PDB format for our as
discussed in the <a href="#generation-of-the-proper-pdb-file">Generation of the proper PDB file
</a> section. As a concrete
example we will start with N3O3 example that was discussed there as well</p>
<pre><code>ATOM      1  O1  NN3     1       1.562   0.180  -1.368      
ATOM      2  N1  NN3     1       1.316   0.936  -0.424      
ATOM      3  N2  NN3     1       2.364   1.026   0.488      
ATOM      4  O2  NN3     1       3.472   0.429   0.421      
ATOM      5  N3  NN3     1       1.958   1.906   1.488      
ATOM      6  O3  NN3     1       2.814   2.068   2.361      
END
</code></pre>
<p>We have residue named NN3 and therefore looking to construct fragment
file <code>NN3.frg</code>. The best way to do it is to run a simple prepare job</p>
<pre><code>start n3o3  

prepare  
source n3o3.pdb  
new_top new_seq  
new_rst  
modify segment 1 quantum   
update lists  
ignore  
write n3o3_ref.pdb  
write n3o3_ref.rst  
end  

task prepare
</code></pre>
<p>This prepare job will necessarily fail because NN3.frg is not yet
available:</p>
<pre><code>Created fragment                      ./NN3.frg_TMP  

Unresolved atom types in fragment NN3  


 **********  
 *   0: pre_mkfrg failed 9999  
 **********
</code></pre>
<p>As part of this process skeleton fragment file (<code>NN3.frg_TMP</code>) will be
generated that can be modified into the final correct form. Let us take
a look at <code>NN3.frg_TMP</code></p>
<pre><code># This is an automatically generated fragment file  
# Atom types and connectivity were derived from coordinates  
# Atomic partial charges are crude estimates  
# 00/00/00  00:00:00    
#  
$NN3  
    6    1    1    0  
NN3  
    1 O1             0    0    0    1    1    0.000000    0.000000  
    2 N1             0    0    0    1    1    0.000000    0.000000  
    3 N2             0    0    0    1    1    0.000000    0.000000  
    4 O2             0    0    0    1    1    0.000000    0.000000  
    5 N3             0    0    0    1    1    0.000000    0.000000  
    6 O3             0    0    0    1    1    0.000000    0.000000  
    1    2  
    2    3  
    3    4  
    3    5  
    5    6
</code></pre>
<p>The main problem with this fragment file is that there are no atom types
to be found in column 12. What atom type does is to identify what
classical parameters should be assigned to it. Since, as mentioned in
the beginning, we are planing to treat this residue/molecule as part of
QM region, the only classical information needed is VDW parameters. We
will assume that all nitrogens atoms in our molecule can use the same
set of parameters, and the same for oxygens. Therefore we will define
two atom types NX and OX  </p>
<pre><code>$NN3  
    6    1    1    0  
NN3  
    1 O1   OX        0    0    0    1    1    0.000000    0.000000  
    2 N1   NX        0    0    0    1    1    0.000000    0.000000  
    3 N2   NX        0    0    0    1    1    0.000000    0.000000  
    4 O2   OX        0    0    0    1    1    0.000000    0.000000  
    5 N3   NX        0    0    0    1    1    0.000000    0.000000  
    6 O3   OX        0    0    0    1    1    0.000000    0.000000  
    1    2  
    2    3  
    3    4  
    3    5  
    5    6
</code></pre>
<p>and rename resulting file as <a href="NN3.frg">NN3.frg</a>. Please
note that the overall format of the fragment file was preserved and atom
types were entered starting at column 12. Rerunning the same prepare job
moves as a bit further this time</p>
<pre><code> modify segment     1 set 0 quantum  
 Parameter file                        /Users/marat/opt/codes/nwchem-new/src/data/amber_s/amber.par  
 Parameter file                        /Users/marat/opt/codes/nwchem-new/src/data/amber_q/amber.par  
 Parameter file                        /Users/marat/opt/codes/nwchem-new/src/data/amber_x/amber.par  
 Parameter file                        /Users/marat/opt/codes/nwchem-new/src/data/amber_u/amber.par

 Undetermined force field parameters

 Parameters could not be found for atom type     OX   Q  
 Parameters could not be found for atom type     NX   Q

 **********  
 *   0: pre_check failed 9999  
 **********
</code></pre>
<p>complaining now that atom types OX and NX are not defined. This brings
us to the next step of defining new parameter file for our calculation. </p>
<h2 id="generation-of-new-parameter-files">Generation of new parameter files<a class="headerlink" href="#generation-of-new-parameter-files" title="Permanent link">&para;</a></h2>
<p>Continuing with our fragment construction in <a href="#generation-of-new-fragment-files">Generation of new fragment
files</a> section, we now
need to define VDW parameters for our new atom types NX and OX. The best
way to do it is to create <code>amber.par</code> file in the directory where you plan
to rerun final prepare  </p>
<pre><code>Electrostatic 1-4 scaling factor     0.833333  
Relative dielectric constant     1.000000  
Parameters epsilon R*  
#  
Atoms  
NX     14.01000 7.11280E-01 1.82400E-01                            1 1111111111  
      Q       7 3.55640E-01 1.82400E-01  
OX     16.00000 6.35968E-01 1.76830E-01                            1 1111111111  
      Q       8 3.17984E-01 1.76830E-01  
End
</code></pre>
<p>The format of this file is documented in <a href="#format-of-nwchem-parameter-file">Format of NWChem parameter
file</a>. How to actually
choose the appropriate values for VDW parameters is a whole new subject,
which I do not think anybody yet fully addressed. The practical strategy
is to copy from known atom types, which are chemically similar to the
ones in your system. In the case above I copied parameters from standard
AMBER atom types N and OW.</p>
<h2 id="format-of-nwchem-parameter-file">Format of NWChem parameter file<a class="headerlink" href="#format-of-nwchem-parameter-file" title="Permanent link">&para;</a></h2>
<p>The format of NWChem parameter is illustrated on the figure below and
also available as <a href="Parameter-file.pdf">pdf file</a>.</p>
<p><img alt="Format of NWChem parameter file" src="Nwchem-parameter-file.png" /></p>
<h2 id="conversion-of-standard-amber-program-parameter-files">Conversion of standard AMBER program parameter files<a class="headerlink" href="#conversion-of-standard-amber-program-parameter-files" title="Permanent link">&para;</a></h2>
<p>Fortran code that performs conversion from AMBER program parameter file
format to NWChem can be found <a href="amber-helper.tgz">here</a>.
It works by parsing out free format AMBER style parameter file contained
in <code>amber.in</code></p>
<pre><code>MASS  
C  12.01  
CA    12.01  
BOND  
#this is a comment  
C -CA  469.0    1.409           this is also a comment  
C  -   CB     447.0      1.419    
ANGLE  
C -CA-CA    63.0      120.00 another comment  
C -CB-NB    70.0      130.00  
DIHEDRAL  
X -C -CA-X    4   14.50        180.0             2.         intrpol.bsd.on C6H6  
 X - C -  CB -X    4   12.00        180.0             2.         intrpol.bsd.on C6H6  
IMPROPER  
X -CT-N -CT         1.0          180.          2.           JCC,7,(1986),230  
CT -O  - C -OH         10.5         180.           2.  
NONBOND  
 CA 1.9080  0.0860  
C 1.9080  0.0860
</code></pre>
<p>to <strong>fixed format</strong> NWChem style amber.par file  </p>
<pre><code>#Generated amber.par file  
Electrostatic 1-4 scaling factor     0.833333  
Relative dielectric constant     1.000000  
Parameters epsilon R*  
#  
Atoms  
CA     12.01000 3.59824E-01 1.90800E-01                            1 1111111111  
              6 1.79912E-01 1.90800E-01  
C      12.01000 3.59824E-01 1.90800E-01                            1 1111111111  
              6 1.79912E-01 1.90800E-01  
Bonds  
C    -CA      0.14090 3.92459E+05  
C    -CB      0.14190 3.74050E+05  
Angles  
C    -CA   -CA      2.09440 5.27184E+02  
C    -CB   -NB      2.26893 5.85760E+02  
Proper dihedrals  
     -C    -CA   -        3.14159 1.51670E+01    2  
     -C    -CB   -        3.14159 1.25520E+01    2  
Improper dihedrals  
     -CT   -N    -CT      3.14159 4.18400E+00    2  
CT   -O    -C    -OH      3.14159 4.39320E+01    2  
End
</code></pre>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="QMMM_Free_Energy.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: QMMM Free Energy" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              QMMM Free Energy
            </div>
          </div>
        </a>
      
      
        
        <a href="Bq.html" class="md-footer__link md-footer__link--next" aria-label="Next: Point charges" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Point charges
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.expand", "navigation.top", "navigation.instant", "navigation.tracking", "navigation.indexes", "search.highlight", "search.share"], "search": "assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
        <script src="js/print-site.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
      
    
    
  </body>
</html>