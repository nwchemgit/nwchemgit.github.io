<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://nwchemgit.github.io/ZCOORD----Forcing-internal-coordinates.html">
  <link rel="shortcut icon" href="img/favicon.ico">
  <title>ZCOORD    Forcing internal coordinates - NWChem</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="css/theme.css" />
  <link rel="stylesheet" href="css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "ZCOORD    Forcing internal coordinates";
    var mkdocs_page_input_path = "ZCOORD----Forcing-internal-coordinates.md";
    var mkdocs_page_url = "/ZCOORD----Forcing-internal-coordinates.html";
  </script>
  
  <script src="js/jquery-2.1.1.min.js" defer></script>
  <script src="js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="." class="icon icon-home"> NWChem</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Home.html">Documentation</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Download.html">Download</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Quantum-Mechanical-Methods.html">Quantum Mechanical Methods</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Quantum-Molecular-Dynamics.html">Quantum Molecular Dynamics</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Other-Capabilities.html">Other Capabilities</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Examples.html">Examples</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Supplementary-Information.html">Supplementary Information</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Compiling-NWChem.html">Compiling NWChem from source</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Benchmarks.html">Benchmarks performed with NWChem</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Known-Bugs.html">Known Bugs</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Tutorials.html">Tutorials</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Forum.html">Forum</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Archived-Forum.html">Archived Forum</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href=".">NWChem</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".">Docs</a> &raquo;</li>
    
      
    
    <li>ZCOORD    Forcing internal coordinates</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/nwchemgit/nwchem-wiki/blob/master/ZCOORD----Forcing-internal-coordinates.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="zcoord-forcing-internal-coordinates">ZCOORD &ndash; Forcing internal coordinates<a class="headerlink" href="#zcoord-forcing-internal-coordinates" title="Permanent link">&para;</a></h2>
<p>By default redundant internal coordinates are generated for use in
geometry optimizations. Connectivity is inferred by comparing
inter-atomic distances with the sum of the van der Waals radii of the
two atoms involved in a possible bond, times a scaling factor. The
scaling factor is an input parameter of ZCOORD which maybe changed from
its default value of 1.3. Under some circumstances (unusual bonding,
bond dissociation, &hellip;) it will be necessary to augment the
automatically generated list of internal coordinates to force some
specific internal coordinates to be included in among the internal
coordinates. This is accomplished by including the optional directive
ZCOORD within the geometry directive. The general form of the ZCOORD
directive is as
follows:</p>
<pre><code> ZCOORD  
    CVR_SCALING &lt;real value&gt;  
    BOND    &lt;integer i&gt; &lt;integer j&gt; \  
            [&lt;real value&gt;] [&lt;string name&gt;] [constant]  
    ANGLE   &lt;integer i&gt; &lt;integer j&gt; &lt;integer k&gt; \  
            [&lt;real value&gt;] [&lt;string name&gt;] [constant]` 
    TORSION &lt;integer i&gt; &lt;integer j&gt; &lt;integer k&gt; &lt;integer l&gt; \  
            [&lt;real value&gt;] [&lt;string name&gt;] [constant]  
 END
</code></pre>

<p>The centers i, j, k and l must be specified using the numbers of the
centers, as supplied in the input for the Cartesian coordinates. The
ZCOORD input parameters are defined as follows:</p>
<ul>
<li>cvr_scaling &ndash; scaling factor applied to van der Waals radii.</li>
<li>bond &ndash; a bond between the two centers.</li>
<li>angle &ndash; an angle among the three atoms i, j and k.</li>
<li>torsion &ndash; a torsion (or dihedral) angle. The angle between the
    planes i-j-k and j-k-l.</li>
</ul>
<p>A value may be specified for a user-defined internal coordinate, in
which case it is forced upon the input Cartesian coordinates while
attempting to make only small changes in the other internal coordinates.
If no value is provided the value implicit in the input coordinates is
kept. If the keyword constant is specified, then that internal variable
is not modified during a geometry optimization with
<a href="Geometry-Optimization.html#geometry-optimization-with-driver">DRIVER</a>.
Each internal coordinate may also be named either for easy
identification in the output, or for the application of constraints
(<a href="ZCOORD----Forcing-internal-coordinates.html#applying-constraints-in-geometry-optimizations">Applying constraints in geometry
optimizations</a>).</p>
<p>If the keyword adjust is specified on the main GEOMETRY directive, only
ZCOORD data may be specified and it can be used to change the
user-defined internal coordinates, including adding/removing constraints
and changing their values.</p>
<h2 id="applying-constraints-in-geometry-optimizations">Applying constraints in geometry optimizations<a class="headerlink" href="#applying-constraints-in-geometry-optimizations" title="Permanent link">&para;</a></h2>
<p>Internal coordinates specified as constant in a ZCOORD directive or in
the constants section of a ZMATRIX directive, will be frozen at their
initial values if a geometry optimization is performed with DRIVER
(Section 20).</p>
<p>If internal coordinates have the same name (give or take an optional
sign for torsions) then they are forced to have the same value. This may
be used to force bonds or angles to be equal even if they are not
related by symmetry.</p>
<p>When atoms have been specified by their Cartesian coordinates, and
internal coordinates are not being used, it is possible to freeze the
cartesian position of selected atoms. This is useful for such purposes
as optimizing a molecule absorbed on the surface of a cluster with fixed
geometry. Only the gradients associated with the active atoms are
computed. This can result in a big computational saving, since gradients
associated with frozen atoms are forced to zero (Note, however, that
this destroys the translational and rotational invariance of the
gradient. This is not yet fully accommodated by the
<a href="Geometry-Optimization.html#geometry-optimization-with-stepper">STEPPER</a>
geometry optimization software, and can sometimes result in slower
convergence of the optimization. The DRIVER optimization package does
not suffer from this problem).</p>
<p>The <a href="Top-level.html#SET">SET</a> directive is used to freeze atoms,
by specifying a directive of the form:</p>
<pre><code> set geometry:actlist &lt;integer list_of_center_numbers&gt;
</code></pre>

<p>This defines only the centers in the list as active. All other centers
will have zero force assigned to them, and will remain frozen at their
starting coordinates during a geometry optimization.</p>
<p>For example, the following directive specifies that atoms numbered 1, 5,
6, 7, 8, and 15 are active and all other atoms are frozen:</p>
<pre><code> set geometry:actlist 1 5:8 15
</code></pre>

<p>or equivalently,</p>
<pre><code> set geometry:actlist 1 5 6 7 8 15
</code></pre>

<p>If this option is not specified by entering a <a href="SET.html">SET</a>
directive, the default behavior in the code is to treat all atoms as
active. To revert to this default behavior after the option to define
frozen atoms has been invoked, the <a href="UNSET.html">UNSET</a> directive
must be used. The form of the UNSET directive is as follows:</p>
<pre><code> unset geometry:actlist
</code></pre>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/nwchemgit/nwchem-wiki/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
      
    </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
