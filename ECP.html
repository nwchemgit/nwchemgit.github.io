<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://nwchemgit.github.io/ECP.html">
  <link rel="shortcut icon" href="img/favicon.ico">
  <title>Effective Core Potentials - NWChem</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="css/theme.css" />
  <link rel="stylesheet" href="css/theme_extra.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Effective Core Potentials";
    var mkdocs_page_input_path = "ECP.md";
    var mkdocs_page_url = "/ECP.html";
  </script>
  
  <script src="js/jquery-2.1.1.min.js" defer></script>
  <script src="js/modernizr-2.8.3.min.js" defer></script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="." class="icon icon-home"> NWChem</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Home.html">NWChem Manual</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Download.html">How to download and install NWChem</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Quantum-Mechanical-Methods.html">Quantum Mechanical Methods</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Quantum-Molecular-Dynamics.html">Quantum Molecular Dynamics</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Hybrid-Approaches.html">Hybrid Approaches</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Other-Capabilities.html">Other Capabilities</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Examples.html">NWChem Examples</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Compiling-NWChem.html">How to Compile NWChem</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Benchmarks.html">Benchmarks performed with NWChem</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Known-Bugs.html">Known Bugs</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Tutorials.html">NWChem Tutorials</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Forum.html">Forum</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Archived-Forum.html">Archived Forum</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="EMSL_Arrows.html">EMSL Arrows</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Software-supporting-NWChem.html">Software supporting NWChem</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Supplementary-Information.html">Supplementary Information</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="Containers.html">Containers</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href=".">NWChem</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".">Docs</a> &raquo;</li>
    
      
    
    <li>Effective Core Potentials</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/nwchemgit/nwchem-wiki/blob/master/ECP.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="effective-core-potentials">Effective Core Potentials<a class="headerlink" href="#effective-core-potentials" title="Permanent link">&para;</a></h1>
<p>Effective core potentials (ECPs) are a useful means of replacing the
core electrons in a calculation with an effective potential, thereby
eliminating the need for the core basis functions, which usually require
a large set of Gaussians to describe them. In addition to replacing the
core, they may be used to represent relativistic effects, which are
largely confined to the core. In this context, both the scalar
(spin-free) relativistic effects and spin-orbit (spin-dependent)
relativistic effects may be included in effective potentials. NWChem has
the facility to use both, and these are described in the next two
sections.</p>
<p>A brief recapitulation of the development of RECPs is given here,
following L.F. Pacios and P.A. Christiansen, J. Chem. Phys. 82, 2664 (1985). The process can be viewed as starting
from an atomic Dirac-Hartree-Fock calculation, done in jj coupling, and
producing relativistic effective potentials (REPs) for each <script type="math/tex">l</script> and <script type="math/tex">j</script>
value, <script type="math/tex">U^{\rm REP}_{lj}</script>
which for example contains the Coulomb potential of the core electrons
balanced by the part of the nuclear attraction which cancels the core
electron charge. The residue is expressed in a semi-local form,
<script type="math/tex">U^{REP} = U^{REP}_{LJ}(r) + \sum_{l=0}^{L-1}  \sum_{j=|l-1/2|}^{l+1/2} \left[ U^{REP}_{lj}(r) - U^{REP}_{LJ}(r)] \right] \sum_{m=-j}^j \vert lj m \rangle \langle lj m \vert</script>
</p>
<p>where <script type="math/tex">L</script> is one larger than the maximum angular momentum in the atom.
The scalar potential is obtained by averaging the REPs for each <script type="math/tex">j</script> for
a given <script type="math/tex">l</script> to give an averaged relativistic effective potential, or
AREP,
<script type="math/tex">U^{AREP}_l(r) = \frac{1}{2l+1} \left[ lU^{REP}_{l-1/2}(r) + (l+1) U^{\rm REP}_{l+1/2}(r) \right].</script>
</p>
<p>These are summed into the full potential<br />
<script type="math/tex">U^{AREP}(r) = U^{AREP}_L(r) + \sum_{l=0}^L \sum_{m=-l}^l \left[ U^{AREP}_{l}(r) - U^{AREP}_{L}(r) \right] \vert l m \rangle \langle l m \vert</script>
</p>
<p>The spin-orbit potential is obtained from the difference between the
REPs for the two <script type="math/tex">j</script> values for a given <script type="math/tex">l</script>, and may be represented in
terms of an effective spin-orbit operator,
<script type="math/tex">H^{SO} = \mathbf{\hat{s}} \cdot \sum_{l=1}^{L-1} \frac{2}{2l+1} \Delta U^{REP}_l \sum_{mm'}\vert {lm} \rangle \langle{lm} \vert \mathbf{\hat{l}} \vert {lm'} \rangle \langle{lm'} \vert.</script>
</p>
<p>where</p>
<p>
<script type="math/tex">\Delta U^{REP}_{l} = U^{REP}_{l+1/2}(r) - U^{REP}_{l-1/2}(r).</script>
</p>
<p>The relavistic potential <script type="math/tex">U^{REP}</script> is the sum of <script type="math/tex">H^{SO}</script> and <script type="math/tex">U^{AREP}</script>.  </p>
<p>The spin-orbit integrals generated by NWChem are the integrals over the
sum, including the factor of <script type="math/tex">2/(2l+1)</script>
as an effective spin-orbit operator without further factors introduced.</p>
<p>The effective potentials, both scalar and spin-orbit, are fitted to
Gaussians with the form</p>
<p>
<script type="math/tex">U_{l}(r) =  r^{-2} \sum_{k} A_{lk} r^{n_{lk}} e^{-B_{lk}r^{2}}</script>
</p>
<p>where <script type="math/tex">A_{lk}</script> is the contraction coefficient, <script type="math/tex">n_{lk}</script> is the
exponent of the <script type="math/tex">r</script> term (r-exponent), and <script type="math/tex">B_{lk}</script> is the Gaussian
exponent. The <script type="math/tex">n_{lk}</script> exponent is shifted by 2, in accordance with most of the
ECP literature and implementations, i.e., <script type="math/tex">n_{lk}</script> implies
<script type="math/tex">r^2</script>. The current implementation allows <script type="math/tex">n_{lk}</script>  values of only
0, 1, or 2.</p>
<h2 id="scalar-ecps">Scalar ECPs<a class="headerlink" href="#scalar-ecps" title="Permanent link">&para;</a></h2>
<p>The optional directive <code>ECP</code> allows the user to describe an effective core
potential (ECP) in terms of contracted Gaussian functions as given
above. Potentials using these functions must be specified explicitly by
user input in the <code>ECP</code> directive. This directive has essentially the same
form and properties as the standard <code>BASIS</code> directive, except for
essential differences required for ECPs. Because of this, the ECP is
treated internally as a basis set. The form of the input for the <code>ECP</code>
directive is as
follows:</p>
<pre><code> ECP [&lt;string name default &quot;ecp basis&quot;&gt;] \  
       [print || noprint default print]  
    &lt;string tag&gt; library [&lt;string tag_in_lib&gt;] \  
                 &lt;string standard_set&gt; [file &lt;filename&gt;] \  
                 [except&lt;string tag list&gt;]  
    &lt;string tag&gt; [nelec] &lt;integer number_of_electrons_replaced&gt;  
       ...  
    &lt;string tag&gt; &lt;string shell_type&gt;  
    &lt;real r-exponent&gt; &lt;real Gaussian-exponent&gt; &lt;real list_of_coefficients&gt;  
       ...  
 END
</code></pre>
<p>ECPs are automatically segmented, even if general contractions are
input. The projection operators defined in an ECP are spherical by
default, so there is no need to include the <code>CARTESIAN</code> or <code>SPHERICAL</code>
keyword as there is for a standard basis set. ECPs are associated with
centers in geometries through tags or names of centers. These tags must
match in the same manner as for basis sets the tags in a GEOMETRY and
ECP directives, and are limited to sixteen (16) characters. Each center
with the same tag will have the same ECP. By default, the input module
prints each ECP that it encounters. The <code>NOPRINT</code> option can be used to
disable printing. There can be only one active ECP, even though several
may exist in the input deck. The ECP modules load <code>ecp basis</code> inputs
along with any <code>ao basis</code> inputs present. ECPs may be used in both
energy and gradient calculations.</p>
<p>ECPs are named in the same fashion as geometries or regular basis sets,
with the default name being &ldquo;ecp basis&rdquo;. It should be clear from the
above discussion on geometries and database entries how indirection is
supported. All directives that are in common with the standard Gaussian
basis set input have the same function and syntax.</p>
<p>As for regular basis sets, ECPs may be obtained from the standard
library. For a complete list of basis sets and associated ECPs in the
NWChem library see the <a href="AvailableBasisSets.html">available basis
sets</a> or the <a href="https://www.basissetexchange.org/">Basis Set
Exchange</a> for naming conventions and
their specifications.</p>
<p>The keyword <code>nelec</code> allows the user to specify the number of core
electrons replaced by the ECP. Additional input lines define the
specific coefficients and exponents. The variable <code>&lt;shell_type&gt;</code> is used
to specify the components of the ECP. The keyword <code>ul</code> entered for
<code>&lt;shell_type&gt;</code> denotes the local part of the ECP. This is equivalent to
the highest angular momentum functions specified in the literature for
most ECPs. The standard entries (<em>s</em>, <em>p</em>, <em>d</em>, etc.) for <code>shell_type</code> specify
the angular momentum projector onto the local function. The shell type
label of <em>s</em> indicates the <em>ul-s</em> projector input, <em>p</em> indicates the <em>ul-p</em>,
etc.</p>
<p>For example, the Christiansen, Ross and Ermler ARECPs are available in
the standard basis set library named <code>crenbl_ecp</code>. To perform a
calculation on uranyl UO<sub>2</sub><sup>2+</sup> with all-electron oxygen
(aug-cc-pvdz basis), and uranium with an ARECP and using the
corresponding basis the following input can be used</p>
<pre><code> geometry
   U 0 0  0
   O 0 0  1.65
   O 0 0 -1.65
 end
 basis 
   U library crenbl_ecp
   O library aug-cc-pvdz
 end
 ecp
   U library crenbl_ecp
 end
</code></pre>
<p>The following is an example of explicit input of an ECP for H<sub>2</sub>CO.<br />
It defines an ECP for the carbon and oxygen atoms in the molecule.</p>
<pre><code> ecp
   C nelec 2 # ecp replaces 2 electrons on C
   C ul      # d
           1       80.0000000       -1.60000000
           1       30.0000000       -0.40000000
           2        0.5498205       -0.03990210
  C s        # s - d 
           0        0.7374760        0.63810832
           0      135.2354832       11.00916230
           2        8.5605569       20.13797020
   C p       # p - d
           2       10.6863587       -3.24684280
           2       23.4979897        0.78505765
   O nelec 2 # ecp replaces 2 electrons on O
   O ul      # d 
           1       80.0000000       -1.60000000
           1       30.0000000       -0.40000000
           2        1.0953760       -0.06623814
   O s       # s - d
           0        0.9212952        0.39552179
           0       28.6481971        2.51654843
           2        9.3033500       17.04478500
   O p       # p - s 
           2       52.3427019       27.97790770
           2       30.7220233      -16.49630500
 end
</code></pre>
<p>Various ECPs without a local function are available, including those of
the Stuttgart group. For those, no <code>ul</code> part needs to be defined. To
define the absence of the local potential, simply specify one
contraction with a zero coefficient:</p>
<pre><code>    &lt;string tag&gt; ul
    2     1.00000     0.00000
</code></pre>
<h2 id="spin-orbit-ecps">Spin-orbit ECPs<a class="headerlink" href="#spin-orbit-ecps" title="Permanent link">&para;</a></h2>
<p>The Spin-orbit ECPs can be used with the Density Functional Approach,
but one has to run the calculations without symmetry. Note: when a
Hartree-Fock method is specified the spin-orbit input will be ignored.</p>
<p>Spin-orbit ECPs are fitted in precisely the same functional form as the
scalar RECPs and have the same properties, with the exception that there
is no local potential <em>u<sub>l</sub></em>, no <em>s</em> potential and no effective charge has
to be defined. Spin-orbit potentials are specified in the same way as
ECPs except that the directive SO is used instead of ECP. Note that
there currently are no spin-orbit ECPs defined in the standard NWChem
library. The SO directive is as
follows:</p>
<pre><code> SO [&lt;string name default &quot;so basis&quot;&gt;] \  
       [print || noprint default print]  
    &lt;string tag&gt; library [&lt;string tag_in_lib&gt;] \
                 &lt;string standard_set&gt; [file &lt;filename&gt;]  
                 [except `&lt;string tag list&gt;]  
       ... 
    &lt;string tag&gt; &lt;string shell_type&gt;  
    &lt;real r-exponent&gt; &lt;real Gaussian-exponent&gt; &lt;real list_of_coefficients&gt;  
       ...  
 END
</code></pre>
<p>Note: in the literature the coefficients of the spin-orbit potentials
are NOT always defined in the same manner. The NWChem code assumes that
the spin-orbit potential defined in the input is of the form:
<script type="math/tex">\Delta U^{NWChem}_{l} = \,\! \frac{2}{2l+1} \Delta U_{l}</script>
</p>
<p>For example, in the literature (most of) the Stuttgart potentials are
defined as <script type="math/tex">\Delta U_{l}</script>  and, hence, have to be multiplied by <script type="math/tex">2/(2l+1)</script>
 (Note: On the Stuttgart/Köln web pages<br />
<a href="http://www.tc.uni-koeln.de/PP/clickpse.en.html">http://www.tc.uni-koeln.de/PP/clickpse.en.html</a>,<br />
 spin-orbit potentials have already been corrected by the appropriate scaling factor and can be used as is). On the other hand, the CRENBL
potentials in the published papers are defined as 
<script type="math/tex">\,\!\frac{l}{2l+1} \Delta U_{l}</script>
have been corrected with the <script type="math/tex">2/l</script> factor, so make sure the
appropriate scaling is applied).</p>
<p>For example, to use the Stuttgart/Köln ECP and SO-ECP for Hg  (ECP60MDF) in NWChem.<br />
The following URL will display bot the the ECP and SO parts.<br />
<a href="http://www.tc.uni-koeln.de/cgi-bin/pp.pl?language=en,format=molpro,element=Hg,job=getecp,ecp=ECP60MDF">http://www.tc.uni-koeln.de/cgi-bin/pp.pl?language=en,format=molpro,element=Hg,job=getecp,ecp=ECP60MDF</a><br />
The highlighted section (last four lines) below is the SO part.<br />
The un-highlighted part (first five lines) is the ECP.    </p>
<pre><code>!  Q=20., MEFIT, MCDHF+Breit, Ref 37.  
ECP,Hg,60,5,4;  
1; 2,1.000000,0.000000;   
2; 2,12.413071,275.774797; 2,6.897913,49.267898;   
4; 2,11.310320,80.506984; 2,10.210773,161.034824; 2,5.939804,9.083416; 2,5.019755,18.367773;   
4; 2,8.407895,51.137256; 2,8.214086,76.707459; 2,4.012612,6.561821; 2,3.795398,9.818070;  
2; 2,3.273106,9.429001; 2,3.208321,12.494856;   
2; 2,4.485296,-6.338414; 2,4.513200,-8.099863;   
**4;2,11.310320,-161.013967;2,10.210773,161.034824;2,5.939804,-18.166832;2,5.019755,18.367773;**    
**4; 2,8.407895,-51.137256; 2,8.214086,51.138306; 2,4.012612,-6.561821; 2,3.795398,6.545380;**      
**2; 2,3.273106,-6.286001; 2,3.208321,6.247428;**      
**2; 2,4.485296,3.169207; 2,4.513200,-3.239945;**  
! References:  
! [37] D. Figgen, G. Rauhut, M. Dolg, H. Stoll, Chem. Phys. 311, 227 (2005).  
</code></pre>
<p>The corresponding NWChem input is </p>
<pre><code>ecp  
Hg nelec 60
Hg ul
2      1.0000000              0.0000000
Hg S
2     12.4130710            275.7747970
2      6.8979130             49.2678980
Hg P
2     11.3103200             80.5069840
2     10.2107730            161.0348240
2      5.9398040              9.0834160
2      5.0197550             18.3677730
Hg D
2      8.4078950             51.1372560
2      8.2140860             76.7074590
2      4.0126120              6.5618210
2      3.7953980              9.8180700
Hg F
2      3.2731060              9.4290010
2      3.2083210             12.4948560
Hg G
2      4.4852960             -6.3384140
2      4.5132000             -8.0998630
end

so
Hg P
2  11.310320  161.013967
2  10.210773  161.034824
2   5.939804  -18.166832
2   5.019755   18.367773
Hg D     
2   8.407895  -51.137256
2   8.214086   51.138306
2   4.012612   -6.561821
2   3.795398    6.545380
Hg F      
2   3.273106   -6.286001
2   3.208321    6.247428
Hg G       
2   4.485296    3.169207
2   4.513200   -3.239945
end
</code></pre>
<h3 id="websites-with-spin-orbits-ecps">Websites with Spin-Orbits ECPs<a class="headerlink" href="#websites-with-spin-orbits-ecps" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="http://www.tc.uni-koeln.de/PP/clickpse.en.html">http://www.tc.uni-koeln.de/PP/clickpse.en.html</a></li>
<li><a href="http://people.clarkson.edu/~pchristi/reps.html">http://people.clarkson.edu/~pchristi/reps.html</a></li>
</ul>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/nwchemgit/nwchem-wiki/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
    
  </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme_extra.js" defer></script>
    <script src="js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
